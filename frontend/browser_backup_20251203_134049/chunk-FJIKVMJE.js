import{a as Q}from"./chunk-YYODLXEO.js";import{a as H}from"./chunk-DFMNWGTU.js";import{a as me}from"./chunk-TC5US2P6.js";import{a as U}from"./chunk-ZXWR2MAY.js";import{a as de,b as ce,c as pe}from"./chunk-FWRBVAV4.js";import{d as se}from"./chunk-TQCCWZBZ.js";import{c as le}from"./chunk-756DJ4VK.js";import{a as z}from"./chunk-JYYDN77K.js";import{b as O,c as G,e as w,f as L}from"./chunk-BQ4MMRNN.js";import{e as re}from"./chunk-THB5JDTQ.js";import{a as j,b as P}from"./chunk-4E37NPLR.js";import{ta as V,va as k}from"./chunk-56QOWAU7.js";import{a as $}from"./chunk-C3OPHOKD.js";import{B as ae,D as oe,E as ne,c as J,e as K,h as W,i as X,o as Z,r as ee,u as te,z as ie}from"./chunk-KYSGX4IW.js";import{k as R}from"./chunk-BFSIXXTJ.js";import{$ as f,Ab as B,Ca as v,Da as y,Db as m,Ea as b,Eb as s,F as E,Ga as F,Ha as T,Ia as g,Ja as a,Ka as o,La as S,Pc as Y,Rc as q,Ua as _,W as n,Wa as C,ga as M,i as h,jb as r,ka as I,kb as u,lb as c,ma as A,pc as D,vb as N}from"./chunk-KZMFGXDY.js";import{a as x}from"./chunk-H5HZ6YB3.js";var fe=i=>({"margin-left.px":i});function Ce(i,p){if(i&1&&(a(0,"div",20)(1,"mat-icon",21),r(2,"folder"),o(),a(3,"b"),r(4),o()()),i&2){let e=C().$implicit;n(4),u(e.name)}}function ue(i,p){if(i&1&&(a(0,"div",20)(1,"mat-icon",21),r(2,"folder"),o(),r(3),o()),i&2){let e=C().$implicit;n(3),c(" ",e.name," ")}}function ve(i,p){if(i&1&&(a(0,"mat-option",22)(1,"div",23),v(2,Ce,5,1,"div",20)(3,ue,4,1,"div",20),o()()),i&2){let e=p.$implicit;g("value",e.id),n(),g("ngStyle",B(3,fe,(e.deafLevel??0)*20)),n(),y(e.deafLevel==0?2:3)}}function ye(i,p){if(i&1&&(a(0,"div",8)(1,"label",18),r(2),m(3,"translate"),o(),a(4,"mat-select",19),m(5,"translate"),a(6,"mat-select-trigger")(7,"div",20)(8,"mat-icon",21),r(9,"folder"),o(),a(10,"span"),r(11),m(12,"translate"),o()()(),a(13,"mat-option",22),r(14),m(15,"translate"),o(),F(16,ve,4,5,"mat-option",22,b),o()()),i&2){let e,t=C();n(2),u(s(3,5,"PARENT_CATEGORY")),n(2),g("placeholder",N(s(5,7,"SELECT_CATEGORY"))),n(7),c(" ",t.getCategoryNameById((e=t.categoryForm.get("parentId"))==null?null:e.value)||s(12,9,"NONE")," "),n(3),c("-- ",s(15,11,"NONE")," --"),n(2),T(t.allCategories)}}function _e(i,p){i&1&&(a(0,"div",11),r(1),m(2,"translate"),o()),i&2&&(n(),c("",s(2,1,"CATEGORY_NAME_IS_REQUIRED")," "))}function Se(i,p){if(i&1&&(a(0,"button",24)(1,"mat-icon",17),r(2,"save"),o(),r(3),m(4,"translate"),m(5,"translate"),o()),i&2){let e=C();n(3),c(" ",e.isEdit?s(4,1,"UPDATE"):s(5,3,"SAVE")," ")}}var ge=class i extends U{constructor(e,t,l,d,xe){super();this.dialogRef=e;this.data=t;this.categoryService=l;this.clonerService=d;this.fb=xe}isEdit=!1;categories=[];allCategories=[];categoryForm;foldersViewStore=h(Q);ngOnInit(){this.createForm(),this.getCategories()}getCategories(){this.categoryService.getAllAssignToMeCategoriesForDropDown().subscribe(e=>{this.categories=e,this.categories.forEach((t,l)=>{t.deafLevel=0,t.index=l*Math.pow(.1,t.deafLevel),t.displayName=t.name,this.allCategories.push(t),this.setDeafLevel(t)}),this.allCategories=this.clonerService.deepClone(this.allCategories)})}getCategoryNameById(e){return this.allCategories?.find(l=>l.id===e)?.name||""}createForm(){this.categoryForm=this.fb.group({id:[],name:["",[K.required]],description:[""],parentId:[this.data?.id?this.data?.id:""]})}ngOnChanges(e){e.data&&this.data.id&&(this.isEdit=!0)}setDeafLevel(e){return e?.children&&e.children.length>0&&e.children.map((t,l)=>{t.displayName=e.displayName+" > "+t.name,t.deafLevel=e?(e.deafLevel??0)+1:0,t.index=e?(e.index??0)+l*Math.pow(.1,t.deafLevel):0,this.allCategories.push(t),this.setDeafLevel(t)}),e}onCancel(){this.dialogRef.close()}saveCategory(){if(this.categoryForm.valid){let e=x({},this.categoryForm.value);e.id?this.categoryService.updateAssign(e).subscribe({next:t=>{e.parentId==this.foldersViewStore.selectedCategoryId()&&this.foldersViewStore.loadCategoriesBySelectedCategoryId(),this.dialogRef.close(t)},error:t=>{console.log(t)}}):this.categoryService.addAssign(e).subscribe({next:t=>{e.parentId==this.foldersViewStore.selectedCategoryId()&&this.foldersViewStore.loadCategoriesBySelectedCategoryId(),this.dialogRef.close(t)},error:t=>{console.log(t)}})}else this.categoryForm.markAllAsTouched()}static \u0275fac=function(t){return new(t||i)(f(O),f(G),f(H),f($),f(ae))};static \u0275cmp=M({type:i,selectors:[["app-manage-category"]],features:[I,E],decls:32,vars:17,consts:[[1,"d-flex"],[1,"me-auto","p-2"],[1,"mb-3","page-title"],[3,"code"],[1,"d-flex","justify-content-end","mb-2"],[1,"close-icon","text-danger","cursor-pointer",3,"click"],["name","form","novalidate","",3,"ngSubmit","formGroup"],[1,"row","gy-3"],[1,"col-sm-12"],["for","categoryName",1,"form-label"],["required","","formControlName","name","type","text","name","name","id","categoryName",1,"form-control"],[1,"text-danger"],["for","description",1,"form-label"],["formControlName","description","name","description","type","text",1,"form-control"],[1,"col-md-12","mt-3"],["type","submit","class","success me-2","matButton","filled","cdkFocusInitial","",4,"hasClaim"],["type","button","matButton","filled",1,"error",3,"click"],[1,"medium-icon"],["for","category",1,"form-label"],["panelClass","mat-select-control","formControlName","parentId",1,"form-control",3,"placeholder"],[1,"d-flex","align-items-center"],[1,"text-warning","me-1"],[3,"value"],[1,"country-item",3,"ngStyle"],["type","submit","matButton","filled","cdkFocusInitial","",1,"success","me-2"]],template:function(t,l){if(t&1&&(a(0,"mat-dialog-content")(1,"div",0)(2,"div",1)(3,"span",2),r(4),m(5,"translate"),S(6,"app-page-help-text",3),o()(),a(7,"div",4)(8,"mat-icon",5),_("click",function(){return l.onCancel()}),r(9,"cancel"),o()()(),a(10,"form",6),_("ngSubmit",function(){return l.saveCategory()}),a(11,"div",7),v(12,ye,18,13,"div",8),a(13,"div",8)(14,"label",9),r(15),m(16,"translate"),o(),S(17,"input",10),v(18,_e,3,3,"div",11),o(),a(19,"div",8)(20,"label",12),r(21),m(22,"translate"),o(),a(23,"textarea",13),r(24,"        "),o()(),a(25,"div",14),A(26,Se,6,5,"button",15),a(27,"button",16),_("click",function(){return l.onCancel()}),a(28,"mat-icon",17),r(29,"cancel"),o(),r(30),m(31,"translate"),o()()()()()),t&2){let d;n(4),c(" ",s(5,9,"MANAGE_CATEGORY")," "),n(2),g("code","DOCUMENT_CATEGORIES"),n(4),g("formGroup",l.categoryForm),n(2),y(l.data.id?12:-1),n(3),u(s(16,11,"NAME")),n(3),y((d=l.categoryForm.get("name"))!=null&&d.touched&&((d=l.categoryForm.get("name"))!=null&&d.errors)&&((d=l.categoryForm.get("name"))!=null&&d.hasError("required"))?18:-1),n(3),u(s(22,13,"DESCRIPTION")),n(5),g("hasClaim","CREATE_CATEGORY"),n(4),c(" ",s(31,15,"CANCEL")," ")}},dependencies:[oe,Z,J,W,X,ie,q,R,k,V,ne,ee,te,P,j,pe,de,ce,se,me,L,w,le,z,D,re,Y],encapsulation:2})};export{ge as a};
