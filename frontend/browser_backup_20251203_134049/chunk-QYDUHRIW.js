import{a as A,b as ke}from"./chunk-SV6MZ6P6.js";import{a as Se,b as Ie,c as be,d as Me}from"./chunk-KBYUC6BL.js";import{a as Fe,b as ge}from"./chunk-6QK67EK5.js";import{a as ye,b as Te,c as qe}from"./chunk-NAYIGTW2.js";import{a as Ee}from"./chunk-TKVPHECB.js";import{a as N}from"./chunk-6B3EO7HE.js";import{a as te}from"./chunk-ZXWR2MAY.js";import{a as Re,c as Ce}from"./chunk-FWRBVAV4.js";import{d as xe}from"./chunk-TQCCWZBZ.js";import{c as ve}from"./chunk-756DJ4VK.js";import{b as ie}from"./chunk-JSAPTJHL.js";import{a as ce,b as fe,e as _e}from"./chunk-THB5JDTQ.js";import{a as H,b as J}from"./chunk-4E37NPLR.js";import{ta as W,va as Z}from"./chunk-56QOWAU7.js";import{B as de,E as ue,c as ne,e as I,h as le,i as ae,o as oe,p as re,r as se,u as me,y as pe}from"./chunk-KYSGX4IW.js";import{e as X,g as G,h as Y,k as $}from"./chunk-BFSIXXTJ.js";import{$ as y,Ca as d,Da as u,Db as s,Eb as m,Fa as h,Ga as D,Ha as w,Ia as E,Ja as a,Ka as l,La as x,Pc as K,Rc as ee,Sa as L,Ua as q,W as n,Wa as R,eb as S,ga as j,jb as r,ka as z,kb as F,lb as c,p as M,q as k,vb as T,zb as Q}from"./chunk-KZMFGXDY.js";var De=()=>["/file-request"];function we(t,p){t&1&&(a(0,"div",27),r(1),s(2,"translate"),l()),t&2&&(n(),c(" ",m(2,1,"SUBJECT_IS_REQUIRED")," "))}function Le(t,p){if(t&1&&(a(0,"div"),d(1,we,3,3,"div",27),l()),t&2){let e,i=R();n(),u(!((e=i.fileRequestForm.get("subject"))==null||e.errors==null)&&e.errors.required?1:-1)}}function Ne(t,p){t&1&&(a(0,"div",27),r(1),s(2,"translate"),l()),t&2&&(n(),c(" ",m(2,1,"INVALID_EMAIL")," "))}function Ae(t,p){if(t&1&&(a(0,"div"),d(1,Ne,3,3,"div",27),l()),t&2){let e,i=R();n(),u(!((e=i.fileRequestForm.get("email"))==null||e.errors==null)&&e.errors.email?1:-1)}}function Be(t,p){if(t&1&&(a(0,"mat-option",19),r(1),s(2,"translate"),l()),t&2){let e=p.$implicit;E("value",e.value),n(),c(" ",m(2,2,e.key)," ")}}function Ue(t,p){t&1&&(a(0,"div",27),r(1),s(2,"translate"),l()),t&2&&(n(),c(" ",m(2,1,"ALLOW_FILE_EXTENSION_IS_REQUIRED")," "))}function Pe(t,p){if(t&1&&(a(0,"div"),d(1,Ue,3,3,"div",27),l()),t&2){let e,i=R();n(),u(!((e=i.fileRequestForm.get("fileType"))==null||e.errors==null)&&e.errors.required?1:-1)}}function Oe(t,p){t&1&&(a(0,"div",27),r(1),s(2,"translate"),l()),t&2&&(n(),c(" ",m(2,1,"MAXIMUM_DOCUMENT_UPLOAD_IS_REQUIRED")," "))}function Ve(t,p){t&1&&(a(0,"div",27),r(1),s(2,"translate"),l()),t&2&&(n(),c(" ",m(2,1,"MAXIMUM_DOCUMENT_UPLOAD_MIN_VALUE")," "))}function je(t,p){if(t&1&&(a(0,"div"),d(1,Oe,3,3,"div",27),d(2,Ve,3,3,"div",27),l()),t&2){let e,i,o=R();n(),u(!((e=o.fileRequestForm.get("maxDocument"))==null||e.errors==null)&&e.errors.required?1:-1),n(),u(!((i=o.fileRequestForm.get("maxDocument"))==null||i.errors==null)&&i.errors.min?2:-1)}}function ze(t,p){if(t&1&&(a(0,"mat-option",19),x(1,"span",33),l()),t&2){let e=p.$implicit;E("value",e.value),n(),E("appFileSizeLabel",e.value)}}function Qe(t,p){t&1&&(a(0,"div",27),r(1),s(2,"translate"),l()),t&2&&(n(),c(" ",m(2,1,"FILE_SIZE_IS_REQUIRED")," "))}function Xe(t,p){if(t&1&&(a(0,"div"),d(1,Qe,3,3,"div",27),l()),t&2){let e,i=R();n(),u(!((e=i.fileRequestForm.get("sizeInMb"))==null||e.errors==null)&&e.errors.required?1:-1)}}function Ge(t,p){if(t&1&&(x(0,"input",24),s(1,"translate")),t&2){let e=R();E("placeholder",T(m(1,3,"ENTER_PASSWORD")))("type",e.passwordFieldType)}}function Ye(t,p){if(t&1){let e=L();a(0,"button",34),q("click",function(){M(e);let o=R();return k(o.togglePasswordVisibility())}),a(1,"mat-icon",35),r(2),l()()}if(t&2){let e=R();n(2),F(e.passwordFieldType==="password"?"visibility":"visibility_off")}}function $e(t,p){t&1&&(a(0,"div",27),r(1),s(2,"translate"),l()),t&2&&(n(),c(" ",m(2,1,"PASSWORD_IS_REQUIRED")," "))}function We(t,p){if(t&1){let e=L();a(0,"div")(1,"div",36)(2,"div",37)(3,"div",23),x(4,"input",38),s(5,"translate"),a(6,"div",25)(7,"button",34),q("click",function(){M(e);let o=S(11);return k(o.open())}),a(8,"mat-icon",35),r(9,"calendar_today"),l()()(),x(10,"mat-datepicker",null,0),l()(),a(12,"div",39)(13,"div",23),x(14,"input",40),s(15,"translate"),a(16,"div",25)(17,"button",41),q("click",function(){M(e);let o=S(21);return k(o.open())}),a(18,"mat-icon",35),r(19,"access_time"),l()()(),x(20,"ngx-material-timepicker",null,1),l()()()()}if(t&2){let e=S(11),i=S(21),o=R();n(4),E("placeholder",T(m(5,9,"MM_DD_YYYY")))("matDatepicker",e)("min",o.minDate),n(10),E("placeholder",T(m(15,11,"EXPIRY_TIME")))("format",24)("ngxTimepicker",i)("disableClick",!0)}}function Ze(t,p){t&1&&(a(0,"div",27),r(1),s(2,"translate"),l()),t&2&&(n(),c(" ",m(2,1,"EXPIRY_DATE_AND_TIME_ARE_REQUIRED")," "))}function He(t,p){t&1&&(a(0,"div",27),r(1),s(2,"translate"),l()),t&2&&(n(),c(" ",m(2,1,"EXPIRY_TIME_ARE_REQUIRED")," "))}function Je(t,p){if(t&1&&(a(0,"div"),d(1,He,3,3,"div",27),l()),t&2){let e,i=R();n(),u(!((e=i.fileRequestForm.get("linkExpiryTime"))==null||e.errors==null)&&e.errors.required?1:-1)}}var he=class t extends te{constructor(e,i,o,v,_){super();this.router=e;this.fb=i;this.activeRoute=o;this.fileRequestService=v;this.toastrService=_}baseUrl=`${window.location.protocol}//${window.location.host}/file-requests/preview/`;isEditMode=!1;minDate=new Date;fileRequestForm;fileTypes=[];get extensions(){return this.fileRequestForm.get("extensions")}passwordFieldType="password";togglePasswordVisibility(){this.passwordFieldType=this.passwordFieldType==="password"?"text":"password"}createFileRequestForm(){var e=new Date;this.fileRequestForm=this.fb.group({id:[""],isLinkExpiryTime:[!1],linkExpiryDate:[e],linkExpiryTime:["12:00"],hasPassword:[!1],password:[""],subject:["",I.required],email:["",I.email],maxDocument:[1,I.required],sizeInMb:[5],fileType:[[],I.required],baseUrl:[this.baseUrl]},{validators:[this.checkData,this.timeValidator]})}checkData(e){let i=e.get("isLinkExpiryTime")?.value,o=e.get("linkExpiryDate")?.value,v=e.get("hasPassword")?.value,_=e.get("password")?.value,f={};return i&&!o&&(f.linkExpiryDateValidator=!0),v&&!_&&(f.passwordValidator=!0),f}timeValidator(e){let i=e.get("linkExpiryTime")?.value;return e.get("linkExpiryDate")?.value&&!i?e.get("linkExpiryTime")?.setErrors({required:!0}):e.get("linkExpiryDate")?.setErrors(null),null}ngOnInit(){this.fileTypes=this.getEnumValues(N),this.createFileRequestForm(),this.sub$.sink=this.activeRoute.data.subscribe(e=>{let i=e.fileRequest;if(i){this.isEditMode=!0;let v=i.allowExtension?i.allowExtension.split(",").map(f=>N[f.trim()]):[],_=i.linkExpiryTime?new Date(i.linkExpiryTime):new Date;var o="12:00";if(i.linkExpiryTime){let f=_.getHours().toString().padStart(2,"0"),C=_.getMinutes().toString().padStart(2,"0");o=`${f}:${C}`}this.fileRequestForm.patchValue({id:i.id,subject:i.subject,email:i.email,maxDocument:i.maxDocument,sizeInMb:i.sizeInMb,isLinkExpiryTime:!!i.linkExpiryTime,linkExpiryDate:_,linkExpiryTime:o,hasPassword:i.hasPassword,password:i.password,fileType:v,baseUrl:this.baseUrl})}})}fileSizeOptions=Object.keys(A).filter(e=>isNaN(Number(e))).map(e=>({label:"",value:A[e]}));getEnumValues(e){return Object.keys(e).filter(i=>isNaN(Number(i))).map(i=>({key:i,value:e[i]}))}saveFileRequest(){if(this.fileRequestForm.valid){let e=this.createBuildObject();this.isEditMode?this.sub$.sink=this.fileRequestService.updateFileRequest(e).subscribe(()=>{this.toastrService.success(this.translationService.getValue("FILE_REQUEST_UPDATED_SUCCESSFULLY")),this.router.navigate(["/file-request"])}):this.sub$.sink=this.fileRequestService.addFileRequest(e).subscribe(()=>{this.toastrService.success(this.translationService.getValue("FILE_REQUEST_CREATED_SUCCESSFULLY")),this.router.navigate(["/file-request"])})}else this.fileRequestForm.markAllAsTouched()}createBuildObject(){let e=this.fileRequestForm.get("id")?.value,i;if(this.fileRequestForm.get("isLinkExpiryTime")?.value){let _=new Date(this.fileRequestForm.get("linkExpiryDate")?.value),f=this.fileRequestForm.get("isLinkExpiryTime")?.value?this.fileRequestForm.get("linkExpiryTime")?.value:"";if(f&&typeof f=="string"){let[C,g]=f.split(":").map(Number);i=new Date(_.getFullYear(),_.getMonth(),_.getDate(),C,g)}}let o=this.fileRequestForm.get("fileType")?.value;return{id:e,subject:this.fileRequestForm.get("subject")?.value,email:this.fileRequestForm.get("email")?.value,maxDocument:this.fileRequestForm.get("maxDocument")?.value,sizeInMb:this.fileRequestForm.get("sizeInMb")?.value,isLinkExpired:!1,hasPassword:!1,password:this.fileRequestForm.get("hasPassword")?.value?this.fileRequestForm.get("password")?.value:"",linkExpiryTime:i,fileExtension:o,baseUrl:this.baseUrl}}static \u0275fac=function(i){return new(i||t)(y(G),y(de),y(X),y(Ee),y(ie))};static \u0275cmp=j({type:t,selectors:[["app-manage-file-request"]],features:[z],decls:94,vars:58,consts:[["linkExpiryDatePicker",""],["timePicker",""],[1,"content"],[1,"container-fluid"],[1,"d-flex","mb-2"],[1,"me-auto"],[1,"mb-0","page-title"],["code","MANAGE_FILE_REQUEST"],[3,"formGroup"],["appearance","outlined"],[1,"row"],[1,"col-md-12","mb-2"],[1,"form-group"],[1,"form-label","text-danger"],["formControlName","subject","type","text",1,"form-control"],[1,"col-md-3"],[1,"form-label"],["formControlName","email","type","email",1,"form-control"],["panelClass","mat-select-control","formControlName","fileType","multiple","",1,"form-control",3,"placeholder"],[3,"value"],["formControlName","maxDocument","type","number","min","1",1,"form-control"],["panelClass","mat-select-control","formControlName","sizeInMb",1,"form-control",3,"placeholder"],["color","primary","formControlName","hasPassword"],[1,"input-group"],["autocomplete","new-password","formControlName","password",1,"form-control",3,"type","placeholder"],[1,"input-group-append"],["type","button",1,"btn","btn-primary","calendar-button"],[1,"text-danger"],["color","primary","formControlName","isLinkExpiryTime"],[1,"col-md-12","mt-2"],["matButton","filled","cdkFocusInitial","",1,"success","me-2",3,"click"],[1,"medium-icon"],["type","button","matButton","filled",1,"error",3,"routerLink"],[3,"appFileSizeLabel"],["type","button",1,"btn","btn-primary","calendar-button",3,"click"],[1,"medium-icon","fs-5","align-middle"],[1,"d-flex"],[1,"flex-fill","me-2"],["matInput","","formControlName","linkExpiryDate",1,"form-control",3,"placeholder","matDatepicker","min"],[1,"flex-fill"],["formControlName","linkExpiryTime","readonly","",1,"form-control","timepicker-input",3,"format","placeholder","ngxTimepicker","disableClick"],["ngxMaterialTimepickerToggleIcon","","type","button",1,"btn","btn-primary","calendar-button",3,"click"]],template:function(i,o){if(i&1&&(a(0,"section",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"span",6),r(5),s(6,"translate"),x(7,"app-page-help-text",7),l()()(),a(8,"form",8)(9,"mat-card",9)(10,"mat-card-content")(11,"div",10)(12,"div",11)(13,"div",12)(14,"label",13),r(15),s(16,"translate"),a(17,"sup"),r(18,"*"),l()(),x(19,"input",14),d(20,Le,2,1,"div"),l()(),a(21,"div",15)(22,"div",12)(23,"label",16),r(24),s(25,"translate"),l(),x(26,"input",17),d(27,Ae,2,1,"div"),l()(),a(28,"div",15)(29,"div",12)(30,"label",13),r(31),s(32,"translate"),a(33,"sup"),r(34,"*"),l()(),a(35,"mat-select",18),s(36,"translate"),D(37,Be,3,4,"mat-option",19,h),l(),d(39,Pe,2,1,"div"),l()(),a(40,"div",15)(41,"div",12)(42,"label",16),r(43),s(44,"translate"),l(),x(45,"input",20),d(46,je,3,2,"div"),l()(),a(47,"div",15)(48,"div",12)(49,"label",16),r(50),s(51,"translate"),l(),a(52,"mat-select",21),s(53,"translate"),D(54,ze,2,2,"mat-option",19,h),l(),d(56,Xe,2,1,"div"),l()(),a(57,"div",15)(58,"div",12)(59,"label",16),r(60),s(61,"translate"),l(),a(62,"p")(63,"mat-checkbox",22),r(64),s(65,"translate"),l()(),a(66,"div",23),d(67,Ge,2,5,"input",24),a(68,"div",25),d(69,Ye,3,1,"button",26),l()(),d(70,$e,3,3,"div",27),l()(),a(71,"div",15)(72,"div",12)(73,"label",16),r(74),s(75,"translate"),l(),a(76,"p")(77,"mat-checkbox",28),r(78),s(79,"translate"),l()(),d(80,We,22,13,"div"),d(81,Ze,3,3,"div",27),d(82,Je,2,1,"div"),l()()(),a(83,"div",29)(84,"button",30),q("click",function(){return o.saveFileRequest()}),a(85,"mat-icon",31),r(86,"save"),l(),r(87),s(88,"translate"),l(),a(89,"button",32)(90,"mat-icon",31),r(91,"cancel"),l(),r(92),s(93,"translate"),l()()()()()()()),i&2){let v,_,f,C,g,B,U,P,O,V,b;n(5),c(" ",m(6,29,"MANAGE_FILE_REQUEST")," "),n(3),E("formGroup",o.fileRequestForm),n(7),c(" ",m(16,31,"SUBJECT")," "),n(5),u((v=o.fileRequestForm.get("subject"))!=null&&v.touched&&((v=o.fileRequestForm.get("subject"))!=null&&v.errors)?20:-1),n(4),F(m(25,33,"EMAIL")),n(3),u((_=o.fileRequestForm.get("email"))!=null&&_.touched&&((_=o.fileRequestForm.get("email"))!=null&&_.errors)?27:-1),n(4),c("",m(32,35,"ALLOW_FILE_EXTENSION")," "),n(4),E("placeholder",T(m(36,37,"SELECT_FILE_EXTENSION"))),n(2),w(o.fileTypes),n(2),u((f=o.fileRequestForm.get("fileType"))!=null&&f.touched&&((f=o.fileRequestForm.get("fileType"))!=null&&f.errors)?39:-1),n(4),F(m(44,39,"MAXIMUM_DOCUMENT_UPLOAD")),n(3),u((C=o.fileRequestForm.get("maxDocument"))!=null&&C.touched&&((C=o.fileRequestForm.get("maxDocument"))!=null&&C.errors)?46:-1),n(4),F(m(51,41,"MAXIMUM_FILE_SIZE_UPLOAD")),n(2),E("placeholder",T(m(53,43,"SELECT_MAX_FILE_SIZE"))),n(2),w(o.fileSizeOptions),n(2),u((g=o.fileRequestForm.get("sizeInMb"))!=null&&g.touched&&((g=o.fileRequestForm.get("sizeInMb"))!=null&&g.errors)?56:-1),n(4),F(m(61,45,"PASSWORD_PROTECTION")),n(4),c(" ",m(65,47,"IS_PASSWORD_REQUIRED")," "),n(3),u((B=o.fileRequestForm.get("hasPassword"))!=null&&B.value?67:-1),n(2),u((U=o.fileRequestForm.get("hasPassword"))!=null&&U.value?69:-1),n(),u((P=o.fileRequestForm.get("hasPassword"))!=null&&P.touched&&o.fileRequestForm.hasError("passwordValidator")?70:-1),n(4),F(m(75,49,"LINK_EXPIRATION")),n(4),c(" ",m(79,51,"IS_LINK_VALID_UNTIL")," "),n(2),u((O=o.fileRequestForm.get("isLinkExpiryTime"))!=null&&O.value?80:-1),n(),u((V=o.fileRequestForm.get("isLinkExpiryTime"))!=null&&V.touched&&o.fileRequestForm.hasError("linkExpiryDateValidator")?81:-1),n(),u((b=o.fileRequestForm.get("linkExpiryTime"))!=null&&b.hasError("required")&&((b=o.fileRequestForm.get("linkExpiryDate"))!=null&&b.touched)?82:-1),n(5),c(" ",m(88,53,"SAVE")," "),n(2),E("routerLink",Q(57,De)),n(3),c(" ",m(93,55,"CANCEL")," ")}},dependencies:[ve,ee,$,Y,ue,oe,ne,re,le,ae,pe,se,me,Ce,Re,xe,qe,ye,Te,Me,Se,be,Ie,ge,Fe,ke,_e,ce,fe,J,H,Z,W,K],encapsulation:2})};export{he as a};
