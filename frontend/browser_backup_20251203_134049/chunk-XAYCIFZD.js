import{a as y,c as l,d as u}from"./chunk-C2FLN6YV.js";import{d as c}from"./chunk-KZMFGXDY.js";import{h as g,p as n}from"./chunk-H5HZ6YB3.js";var d=g(y());var m=class o{constructor(){}loadPdfWorker(){return n(this,null,function*(){l.workerSrc||(l.workerSrc="/js/pdf.worker.min.mjs")})}getPDFMetadata(e){return n(this,null,function*(){yield this.loadPdfWorker();let t=yield e.arrayBuffer(),a=(yield(yield u({data:new Uint8Array(t)}).promise).getMetadata())?.info;return{title:"",author:a?.Author??"",created:this.parsePdfDate(a?.CreationDate)??null,modified:this.parsePdfDate(a?.ModDate)??null}})}parsePdfDate(e){if(!e)return null;e?.startsWith("D:")&&(e=e.substring(2));let t=e.substring(0,14),r=t.substring(0,4),s=t.substring(4,6)-1,a=t.substring(6,8),i=t.substring(8,10),f=t.substring(10,12),p=t.substring(12,14);return new Date(r,s,a,i,f,p)}extractMetadata(e){return n(this,null,function*(){try{let s=yield(yield new d.default().loadAsync(yield e.arrayBuffer())).file("docProps/core.xml")?.async("text");if(!s)return null;let i=new DOMParser().parseFromString(s,"text/xml");return{title:this.getXmlValue(i,"dc:title")??"",author:this.getXmlValue(i,"dc:creator")??"",created:this.getXmlValue(i,"dcterms:created")??null,modified:this.getXmlValue(i,"dcterms:modified")??null}}catch{return null}})}getXmlValue(e,t){let r=e.getElementsByTagName(t)[0];return r&&r.textContent||"N/A"}static \u0275fac=function(t){return new(t||o)};static \u0275prov=c({token:o,factory:o.\u0275fac})};export{m as a};
