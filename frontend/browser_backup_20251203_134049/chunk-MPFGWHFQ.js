import{a as q,b as V}from"./chunk-GE3TJVIQ.js";import{a as T}from"./chunk-ZXWR2MAY.js";import"./chunk-G4LST2RF.js";import{b as D}from"./chunk-JSAPTJHL.js";import{b as j}from"./chunk-UFOTACYY.js";import{a as U,b as O}from"./chunk-4E37NPLR.js";import{ta as N,va as P}from"./chunk-56QOWAU7.js";import{a as k}from"./chunk-77WXBMFN.js";import"./chunk-XFBX5CPU.js";import"./chunk-C3OPHOKD.js";import{C as J,E as K,c as z,e as C,h as W,i as Q,o as $,r as Y,u as H}from"./chunk-KYSGX4IW.js";import"./chunk-LCPYESOB.js";import{g as w,k as R}from"./chunk-BFSIXXTJ.js";import"./chunk-DGFNMOMG.js";import{$ as m,Ca as c,Da as g,Db as s,Eb as d,Ia as _,Ja as a,Ka as r,La as v,Pc as B,R as E,Rc as A,Ua as M,W as n,Wa as G,_ as I,ga as F,jb as l,ka as L,kb as b,lb as h}from"./chunk-KZMFGXDY.js";import"./chunk-W3TJXGK4.js";import{a as y,b as x}from"./chunk-H5HZ6YB3.js";function X(i,f){i&1&&(a(0,"div",25),l(1),s(2,"translate"),r()),i&2&&(n(),h(" ",d(2,1,"EMAIL_IS_REQUIRED")," "))}function Z(i,f){i&1&&(a(0,"div",25),l(1),s(2,"translate"),r()),i&2&&(n(),h(" ",d(2,1,"PLEASE_ENTER_VALID_EMAIL")," "))}function ee(i,f){if(i&1&&(a(0,"div",16),c(1,X,3,3,"div",25),c(2,Z,3,3,"div",25),r()),i&2){let e,t,o=G();n(),g(!((e=o.loginFormGroup.get("userName"))==null||e.errors==null)&&e.errors.required?1:-1),n(),g(!((t=o.loginFormGroup.get("userName"))==null||t.errors==null)&&t.errors.email?2:-1)}}function ie(i,f){i&1&&(a(0,"div",16)(1,"div",25),l(2),s(3,"translate"),r()()),i&2&&(n(2),h(" ",d(3,1,"PASSWORD_IS_REQUIRED")," "))}function te(i,f){i&1&&(a(0,"div",24),v(1,"mat-progress-spinner",26),r())}var S=class i extends T{constructor(e,t,o,p,u,oe){super();this.fb=e;this.router=t;this.securityService=o;this.toastr=p;this.renderer=u;this.commonService=oe}logoUrl;loginFormGroup;isLoading=!1;lat;lng;ngOnInit(){this.createFormGroup(),this.getCompanyProfile(),navigator.geolocation.getCurrentPosition(e=>{this.lat=e.coords.latitude,this.lng=e.coords.longitude})}onLoginSubmit(){if(this.loginFormGroup.valid){this.isLoading=!0;let e=x(y({},this.loginFormGroup.value),{latitude:this.lat,longitude:this.lng});this.sub$.sink=this.securityService.login(e).subscribe({next:t=>{this.isLoading=!1,this.getAllAllowFileExtension(),this.toastr.success(this.translationService.getValue("USER_LOGIN_SUCCESSFULLY")),this.securityService.hasClaim("view_dashboard")?this.router.navigate(["/dashboard"]):this.securityService.hasClaim("view_documents")?this.router.navigate(["/documents/list-view"]):this.router.navigate(["/assign/list-view"])},error:t=>{this.isLoading=!1,t.error.messages.forEach(o=>{this.toastr.error(o)})}})}}createFormGroup(){this.loginFormGroup=this.fb.group({userName:["",[C.required,C.email]],password:["",[C.required]]})}onRegistrationClick(){this.router.navigate(["/registration"])}setBackgroundImage(e){let t=document.querySelector(".auth-bg");t&&this.renderer.setStyle(t,"background-image",`url(${e})`)}getCompanyProfile(){this.securityService.companyProfile.subscribe(e=>{e&&(this.logoUrl=e.logoUrl,this.setBackgroundImage(e?.bannerUrl??""))})}getAllAllowFileExtension(){this.commonService.getAllowFileExtensions().subscribe()}static \u0275fac=function(t){return new(t||i)(m(J),m(w),m(k),m(D),m(I),m(j))};static \u0275cmp=F({type:i,selectors:[["app-login"]],features:[L],decls:38,vars:15,consts:[[1,"container-fluid","p-0"],[1,"row","g-0"],[1,"col-lg-4"],[1,"auth-content","p-4","d-flex","align-items-center","min-vh-100"],[1,"w-100"],[1,"row","justify-content-center"],[1,"col-lg-9"],[1,"text-center"],[1,"text-center","logo-img","mb-3"],["alt","Logo",3,"src"],[1,"p-2","mt-5"],[3,"submit","formGroup"],[1,"row"],[1,"col-md-12","col-sm-12","col-12"],[1,"form-group"],["formControlName","userName","type","text",1,"form-control"],[1,"k-tooltip-validation"],["type","password","formControlName","password","autocomplete","off",1,"form-control"],[1,"col-md-12","col-sm-6","col-12"],["type","submit","matButton","filled",1,"primary","mt-3",2,"width","100%",3,"disabled"],[1,"me-2","medium-icon","fs-5","align-middle"],[1,"col-lg-8"],[1,"auth-bg"],[1,"bg-overlay"],[1,"spinner-container"],[1,"text-danger"],["mode","indeterminate","diameter","60","strokeWidth","5"]],template:function(t,o){if(t&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div")(8,"div",7)(9,"div",8),v(10,"img",9),r()(),a(11,"div",10)(12,"form",11),M("submit",function(){return o.onLoginSubmit()}),a(13,"div",12)(14,"div",13)(15,"div",14)(16,"label"),l(17),s(18,"translate"),r(),v(19,"input",15),c(20,ee,3,2,"div",16),r()(),a(21,"div",13)(22,"div",14)(23,"label"),l(24),s(25,"translate"),r(),v(26,"input",17),c(27,ie,4,3,"div",16),r()(),a(28,"div",18)(29,"button",19)(30,"mat-icon",20),l(31,"login"),r(),l(32),s(33,"translate"),r()()()()()()()()()()(),a(34,"div",21)(35,"div",22),v(36,"div",23),r()()()(),c(37,te,2,0,"div",24)),t&2){let p,u;n(10),_("src",o.logoUrl,E),n(2),_("formGroup",o.loginFormGroup),n(5),b(d(18,9,"EMAIL")),n(3),g((p=o.loginFormGroup.get("userName"))!=null&&p.touched&&((p=o.loginFormGroup.get("userName"))!=null&&p.errors)?20:-1),n(4),b(d(25,11,"PASSWORD")),n(3),g((u=o.loginFormGroup.get("password"))!=null&&u.touched&&(!((u=o.loginFormGroup.get("password"))==null||u.errors==null)&&u.errors.required)?27:-1),n(2),_("disabled",!o.loginFormGroup.valid),n(3),h(" ",d(33,13,"LOGIN")," "),n(5),g(o.isLoading?37:-1)}},dependencies:[K,$,z,W,Q,Y,H,R,A,P,N,O,U,V,q,B],styles:[".auth-bg[_ngcontent-%COMP%]{height:100vh;background-size:cover;background-position:center}.auth-bg[_ngcontent-%COMP%]   .bg-overlay[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%;inset:0;opacity:.5;z-index:-1;background-color:#292626}@media (max-width: 991px){.auth-bg[_ngcontent-%COMP%]{display:none}}.auth-content[_ngcontent-%COMP%]{height:100vh;display:flex;background-color:#fff}.auth-form-group[_ngcontent-%COMP%]{position:relative}.auth-form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{height:60px;padding-left:60px;border-radius:5px}"]})};var Me=[{path:"",component:S}];export{Me as LOGIN_ROUTES};
