import{d as Le,e as Te,f as Re}from"./chunk-2JITEWKE.js";import{a as De}from"./chunk-Q64ABPSN.js";import{a as se}from"./chunk-ZEPKQIVA.js";import{a as me,b as le,c as ce,d as pe,e as de,f as Ce,g as _e,h as ge,i as ue,j as fe,k as ye,l as Pe,m as Se,n as ve,o as he,p as xe,q as w}from"./chunk-32HAOKOZ.js";import{a as Ee}from"./chunk-DP5AXSVW.js";import{a as oe}from"./chunk-NHBDANCD.js";import{a as Z}from"./chunk-6GBRFDEJ.js";import{a as ee}from"./chunk-ZXWR2MAY.js";import{c as re}from"./chunk-PJSVLHWR.js";import{a as ne}from"./chunk-546GNQSA.js";import{b as V,c as H,d as j,e as Y,f as G}from"./chunk-2DXU6Z77.js";import{b as te}from"./chunk-WC3ZMFX5.js";import{b as ie}from"./chunk-UFOTACYY.js";import{e as ae}from"./chunk-F3ENXN4Q.js";import{e as N}from"./chunk-BFSIXXTJ.js";import{a as q,b as J}from"./chunk-P6E4AR6Q.js";import{ta as Q,ua as W,va as z}from"./chunk-GDJX5AXE.js";import{$ as f,$a as k,Ca as g,Da as u,Db as l,Eb as d,Fb as R,Ia as S,Ja as o,Ka as a,La as D,Pa as y,Pc as K,Qa as P,Rc as X,Sa as T,Ua as x,W as n,Wa as C,_a as O,ab as U,ga as I,i as M,jb as r,ka as A,kb as E,lb as p,ma as _,mb as B,p as v,q as h,vb as F,zb as $}from"./chunk-KZMFGXDY.js";var Me=["categoryPermissionsPaginator"],Ie=()=>[10,20,50,100];function Ae(e,i){if(e&1&&(o(0,"div",8)(1,"div",34)(2,"p")(3,"b"),r(4),l(5,"translate"),a(),r(6),a()()()),e&2){let t=C();n(4),p("",d(5,2,"FOLDER_OR_CATEGORY"),":"),n(2),p(" ",t.category.name," ")}}function Oe(e,i){e&1&&(o(0,"th",35),r(1),l(2,"translate"),a()),e&2&&(n(),p(" ",d(2,1,"ACTION")," "))}function ke(e,i){if(e&1){let t=T();o(0,"button",39),x("click",function(){v(t);let c=C(2).$implicit,m=C();return h(m.deleteCategoryUserPermission(c))}),o(1,"mat-icon"),r(2,"delete"),a()()}}function Ue(e,i){if(e&1){let t=T();o(0,"button",39),x("click",function(){v(t);let c=C(2).$implicit,m=C();return h(m.deleteCategoryRolePermission(c))}),o(1,"mat-icon"),r(2,"delete"),a()()}}function Be(e,i){if(e&1&&(y(0),g(1,ke,3,0,"button",38),g(2,Ue,3,0,"button",38),P()),e&2){let t=C().$implicit;n(),u(t.type=="User"?1:-1),n(),u(t.type=="Role"?2:-1)}}function Fe(e,i){e&1&&(o(0,"td",36),_(1,Be,3,2,"ng-container",37),a()),e&2&&(n(),S("hasClaim","ALL_REMOVE_SHARE_FOLDER"))}function $e(e,i){e&1&&(o(0,"th",40),r(1),l(2,"translate"),a()),e&2&&(n(),p(" ",d(2,1,"ALLOW_DOWNLOAD")," "))}function Ne(e,i){e&1&&(r(0),l(1,"translate")),e&2&&p(" ",d(1,1,"YES")," ")}function Ve(e,i){e&1&&(r(0),l(1,"translate")),e&2&&p(" ",d(1,1,"NO")," ")}function He(e,i){if(e&1&&(o(0,"td",41),g(1,Ne,2,3)(2,Ve,2,3),a()),e&2){let t=i.$implicit;n(),u(t.isAllowDownload?1:2)}}function je(e,i){e&1&&(o(0,"th",40),r(1),l(2,"translate"),a()),e&2&&(n(),E(d(2,1,"TYPE")))}function Ye(e,i){if(e&1&&(o(0,"td",41),r(1),a()),e&2){let t=i.$implicit;n(),p(" ",t.type," ")}}function Ge(e,i){e&1&&(o(0,"th",40),r(1),l(2,"translate"),a()),e&2&&(n(),p(" ",d(2,1,"USER_ROLE_NAME")," "))}function Qe(e,i){if(e&1&&(o(0,"span"),r(1),a()),e&2){let t=C().$implicit;n(),B(" ",t.user.firstName," ",t.user.lastName," ")}}function We(e,i){if(e&1&&(o(0,"span"),r(1),a()),e&2){let t=C().$implicit;n(),p(" ",t.role.name," ")}}function ze(e,i){if(e&1&&(o(0,"td",41),g(1,Qe,2,2,"span"),g(2,We,2,1,"span"),a()),e&2){let t=i.$implicit;n(),u(t.type=="User"?1:-1),n(),u(t.type=="Role"?2:-1)}}function qe(e,i){e&1&&(o(0,"th",40),r(1),l(2,"translate"),a()),e&2&&(n(),E(d(2,1,"EMAIL")))}function Je(e,i){if(e&1&&(o(0,"span"),r(1),a()),e&2){let t=C().$implicit;n(),p(" ",t.user.email," ")}}function Ke(e,i){e&1&&(o(0,"span"),r(1," -- "),a())}function Xe(e,i){if(e&1&&(o(0,"td",41),g(1,Je,2,1,"span"),g(2,Ke,2,0,"span"),a()),e&2){let t=i.$implicit;n(),u(t.type=="User"?1:-1),n(),u(t.type=="Role"?2:-1)}}function Ze(e,i){e&1&&(o(0,"th",40),r(1),l(2,"translate"),a()),e&2&&(n(),p(" ",d(2,1,"START_DATE")," "))}function et(e,i){if(e&1&&(r(0),l(1,"utcToLocalTime")),e&2){let t=C().$implicit;p(" ",R(1,1,t.startDate,"shortDate")," ")}}function tt(e,i){e&1&&(o(0,"span"),r(1," -- "),a())}function it(e,i){if(e&1&&(o(0,"td",41),g(1,et,2,4)(2,tt,2,0,"span"),a()),e&2){let t=i.$implicit;n(),u(t.isTimeBound?1:2)}}function ot(e,i){e&1&&(o(0,"th",40),r(1),l(2,"translate"),a()),e&2&&(n(),E(d(2,1,"END_DATE")))}function nt(e,i){if(e&1&&(r(0),l(1,"utcToLocalTime")),e&2){let t=C().$implicit;p(" ",R(1,1,t.endDate,"shortDate")," ")}}function at(e,i){e&1&&(o(0,"span"),r(1," -- "),a())}function rt(e,i){if(e&1&&(o(0,"td",41),g(1,nt,2,4)(2,at,2,0,"span"),a()),e&2){let t=i.$implicit;n(),u(t.isTimeBound?1:2)}}function st(e,i){e&1&&(o(0,"td",42),D(1,"mat-paginator",43,1),a()),e&2&&(n(),S("pageSizeOptions",$(1,Ie)))}function mt(e,i){e&1&&(o(0,"tr")(1,"td",44)(2,"div",45)(3,"b"),r(4),l(5,"translate"),a()()()()),e&2&&(n(4),p(" ",d(5,1,"NO_DATA_FOUND")))}function lt(e,i){e&1&&D(0,"tr",46)}function ct(e,i){e&1&&D(0,"tr",47)}function pt(e,i){e&1&&D(0,"tr",48)}var we=class e extends ee{constructor(t,s,c,m,L,b,dt,be,Ct){super();this.categoryService=t;this.categoryPermissionService=s;this.route=c;this.commonDialogService=m;this.toastrService=L;this.dialog=b;this.commonService=dt;this.data=be;this.dialogRef=Ct;this.category=be}categoryPermissions=[];category;categoryPermissionsChanges=!1;footerToDisplayed=["footer"];userStore=M(De);roles=[];categoryPermissionsColumns=["action","type","isAllowDownload","name","email","startDate","endDate"];permissionsDataSource;categoryPermissionsPaginator;ngOnInit(){this.sub$.sink=this.route.params.subscribe(t=>{this.getCategoryPrmission(),this.getCategories(),this.getRoles()})}getCategories(){this.categoryService.getAllCategories(!0)}getCategoryPrmission(){this.sub$.sink=this.categoryPermissionService.getCategoryPermission(this.category.id??"").subscribe(t=>{this.categoryPermissions=t,this.permissionsDataSource=new w(this.categoryPermissions),this.permissionsDataSource.paginator=this.categoryPermissionsPaginator})}getRoles(){this.sub$.sink=this.commonService.getRoles().subscribe(t=>this.roles=t)}deleteCategoryUserPermission(t){this.sub$.sink=this.commonDialogService.deleteConfirmtionDialog(`${this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")}?`).subscribe(s=>{s&&(this.sub$.sink=this.categoryPermissionService.deleteCategoryUserPermission(t.id??"").subscribe(()=>{this.toastrService.success(this.translationService.getValue("PERMISSION_DELETED_SUCCESSFULLY")),this.getCategoryPrmission(),this.categoryPermissionsChanges=!0}))})}deleteCategoryRolePermission(t){this.sub$.sink=this.commonDialogService.deleteConfirmtionDialog(`${this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")}?`).subscribe(s=>{s&&(this.sub$.sink=this.categoryPermissionService.deleteCategoryRolePermission(t.id??"").subscribe(()=>{this.toastrService.success(this.translationService.getValue("PERMISSION_DELETED_SUCCESSFULLY")),this.getCategoryPrmission(),this.categoryPermissionsChanges=!0}))})}addCategoryUserPermission(){let t=this.dialog.open(Te,{width:"600px",data:Object.assign({users:[...this.userStore?.users()],categoryId:this.category.id})});this.sub$.sink=t.afterClosed().subscribe(s=>{s&&(this.getCategoryPrmission(),this.getCategories(),this.categoryPermissionsChanges=!0)})}addCategoryRolePermission(){let t=this.dialog.open(Re,{width:"600px",data:Object.assign({roles:this.roles,categoryId:this.category.id})});this.sub$.sink=t.afterClosed().subscribe(s=>{s&&(this.getCategoryPrmission(),this.getCategories(),this.categoryPermissionsChanges=!0)})}applyPermissionFilter(t){let s=t.target?.value.trim().toLocaleLowerCase();var c=this.categoryPermissions.filter(m=>m.type=="User"&&(m.user?.firstName?.toLocaleLowerCase().includes(s)||m?.user?.lastName?.toLocaleLowerCase().includes(s)||m?.user?.email.toLocaleLowerCase().includes(s))||m.type=="Role"&&m.role?.name?.toLocaleLowerCase().includes(s));this.permissionsDataSource=new w(c),this.permissionsDataSource.paginator=this.categoryPermissionsPaginator}closeDialog(){this.dialogRef.close(this.categoryPermissionsChanges)}static \u0275fac=function(s){return new(s||e)(f(oe),f(Le),f(N),f(Ee),f(te),f(j),f(ie),f(H),f(V))};static \u0275cmp=I({type:e,selectors:[["app-category-permission-list"]],viewQuery:function(s,c){if(s&1&&O(Me,5),s&2){let m;k(m=U())&&(c.categoryPermissionsPaginator=m.first)}},features:[A],decls:58,vars:23,consts:[["input1",""],["userPermissionsPaginator",""],[1,"d-flex"],[1,"me-auto","p-2"],[1,"mb-3","page-title"],["code","SHARE_FOLDER"],[1,"d-flex","justify-content-end","mb-2"],[1,"close-icon","text-danger","cursor-pointer",3,"click"],[1,"col-md-12","row","pl-0"],[1,"d-flex","flex-wrap","gap-2","mb-3"],["matButton","filled","type","button",1,"me-2","success",3,"click"],[1,"medium-icon","fs-5","align-middle"],["matButton","filled","type","button",1,"error",3,"click"],[1,"col-md-12","form-group","mt-2","mb-2"],[1,"form-control",3,"keyup","placeholder"],[1,"table-responsive"],["mat-table","",3,"dataSource"],["matColumnDef","action"],["style","width: 20%","mat-header-cell","",4,"matHeaderCellDef"],["style","width: 20%","mat-cell","",4,"matCellDef"],["matColumnDef","isAllowDownload"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","name"],["matColumnDef","email"],["matColumnDef","startDate"],["matColumnDef","endDate"],["matColumnDef","footer"],["mat-footer-cell","","colspan","7",4,"matFooterCellDef"],[4,"matNoDataRow"],["class","grid-header-color","mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef","matFooterRowDefSticky"],[1,"col-md-4"],["mat-header-cell","",2,"width","20%"],["mat-cell","",2,"width","20%"],[4,"hasClaim"],["matMiniFab","",1,"error"],["matMiniFab","",1,"error",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-footer-cell","","colspan","7"],[3,"pageSizeOptions"],["colspan","5"],[1,"m-2"],["mat-header-row","",1,"grid-header-color"],["mat-row",""],["mat-footer-row",""]],template:function(s,c){if(s&1){let m=T();o(0,"mat-dialog-content")(1,"div",2)(2,"div",3)(3,"span",4),r(4),l(5,"translate"),D(6,"app-page-help-text",5),a()(),o(7,"div",6)(8,"mat-icon",7),x("click",function(){return v(m),h(c.closeDialog())}),r(9,"cancel"),a()()(),g(10,Ae,7,4,"div",8),o(11,"div",9)(12,"button",10),x("click",function(){return v(m),h(c.addCategoryUserPermission())}),o(13,"mat-icon",11),r(14,"add"),a(),r(15),l(16,"translate"),a(),o(17,"button",12),x("click",function(){return v(m),h(c.addCategoryRolePermission())}),o(18,"mat-icon",11),r(19,"add"),a(),r(20),l(21,"translate"),a()(),o(22,"div",13)(23,"label"),r(24),l(25,"translate"),a(),o(26,"input",14,0),l(28,"translate"),x("keyup",function(b){return v(m),h(c.applyPermissionFilter(b))}),a()(),o(29,"div",15)(30,"table",16),y(31,17),_(32,Oe,3,3,"th",18)(33,Fe,2,1,"td",19),P(),y(34,20),_(35,$e,3,3,"th",21)(36,He,3,1,"td",22),P(),y(37,23),_(38,je,3,3,"th",21)(39,Ye,2,1,"td",22),P(),y(40,24),_(41,Ge,3,3,"th",21)(42,ze,3,2,"td",22),P(),y(43,25),_(44,qe,3,3,"th",21)(45,Xe,3,2,"td",22),P(),y(46,26),_(47,Ze,3,3,"th",21)(48,it,3,1,"td",22),P(),y(49,27),_(50,ot,3,3,"th",21)(51,rt,3,1,"td",22),P(),y(52,28),_(53,st,3,2,"td",29),P(),_(54,mt,6,3,"tr",30)(55,lt,1,0,"tr",31)(56,ct,1,0,"tr",32)(57,pt,1,0,"tr",33),a()()()}s&2&&(n(4),p(" ",d(5,13,"SHARE_FOLDER")," "),n(6),u(c.category?10:-1),n(5),p(" ",d(16,15,"ASSIGN_USERS")," "),n(5),p(" ",d(21,17,"ASSIGN_ROLES")," "),n(4),E(d(25,19,"FILTER")),n(2),S("placeholder",F(d(28,21,"SEARCH_BY_USER_ROLE_NAME_AND_EMAIL"))),n(4),S("dataSource",c.permissionsDataSource),n(25),S("matHeaderRowDef",c.categoryPermissionsColumns)("matHeaderRowDefSticky",!0),n(),S("matRowDefColumns",c.categoryPermissionsColumns),n(),S("matFooterRowDef",c.footerToDisplayed)("matFooterRowDefSticky",!0))},dependencies:[G,Y,xe,me,ce,ue,de,le,ye,pe,fe,Ce,ge,_e,Pe,ve,Se,he,J,q,z,Q,W,re,ne,se,X,ae,K,Z],encapsulation:2})};export{we as a};
