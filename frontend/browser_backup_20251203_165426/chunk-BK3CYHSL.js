import{a as de}from"./chunk-3NQBK7XS.js";import{a as Y,b as $}from"./chunk-YCBFVA3Y.js";import{a as Z}from"./chunk-ZXWR2MAY.js";import"./chunk-G4LST2RF.js";import{c as pe}from"./chunk-PJSVLHWR.js";import"./chunk-546GNQSA.js";import"./chunk-2DXU6Z77.js";import{b as J}from"./chunk-WC3ZMFX5.js";import{b as K}from"./chunk-UFOTACYY.js";import"./chunk-RKRBEXQJ.js";import"./chunk-C3OPHOKD.js";import{a as le,b as ce,e as me}from"./chunk-F3ENXN4Q.js";import{B as ae,D as se,c as ee,h as te,i as ie,k as re,n as oe,o as ne}from"./chunk-KYSGX4IW.js";import"./chunk-LCPYESOB.js";import"./chunk-BFSIXXTJ.js";import{a as j,b as Q}from"./chunk-P6E4AR6Q.js";import{ta as k,va as G,wa as q}from"./chunk-GDJX5AXE.js";import{$a as y,Ca as x,Da as g,Db as p,Eb as d,G as w,Gc as U,Ia as F,Ja as a,Ka as n,La as h,Pc as W,Rc as z,Sa as D,Ua as _,W as s,Wa as A,_a as V,ab as b,d as M,eb as L,ga as N,h as E,i as m,jb as l,ka as R,kb as v,lb as S,p as f,pb as B,q as u,qb as X,rb as P,vb as H}from"./chunk-KZMFGXDY.js";import{Da as O}from"./chunk-W3TJXGK4.js";import{p as I}from"./chunk-H5HZ6YB3.js";var C=class r{constructor(e,i){this.httpClient=e;this.commonHttpErrorService=i}getDocumentContentByOcr(e,i){let t="documents/ocr_content_extractor",o=new FormData;return o.append("file",e),o.append("extension",i),this.httpClient.post(t,o).pipe(O(this.commonHttpErrorService.handleError))}static \u0275fac=function(i){return new(i||r)(E(U),E(q))};static \u0275prov=M({token:r,factory:r.\u0275fac,providedIn:"root"})};var Ce=["file"];function Ee(r,e){if(r&1&&(a(0,"span",12),l(1),n()),r&2){let i=A();s(),v(i.errorMessage)}}function xe(r,e){r&1&&(a(0,"div",19),h(1,"mat-progress-spinner",20),n())}var fe=class r extends Z{documentForm;allowFileExtension=[];extension;fb=m(ae);ocrContentExtractorService=m(C);commonService=m(K);toastrService=m(J);fileData=null;extractedText="";isLoading=!1;errorMessage="";fileInput;mode="indeterminate";ngOnInit(){this.getAllAllowFileExtension()}fileExtesionValidation(e){return!!this.allowFileExtension.find(t=>t.extensions?.find(o=>o.toLowerCase()===e.toLowerCase()))}getAllAllowFileExtension(){this.commonService.getAllowFileExtensions().subscribe(),this.sub$.sink=this.commonService.allowFileExtension$.subscribe(e=>{e&&(this.allowFileExtension=e)})}upload(e){return I(this,null,function*(){if(!(!e||e.length===0)){if(!(yield de(e[0]))){this.toastrService.error(this.translationService.getValue("INVALID_EXTENSION_OR_CORRUPT_INVALID_SIGNATURE")),this.errorMessage=this.translationService.getValue("INVALID_EXTENSION_OR_CORRUPT_INVALID_SIGNATURE");return}if(this.extension=e[0].name.split(".").pop()??"",!this.fileExtesionValidation(this.extension)){this.errorMessage=this.translationService.getValue("INVALID_EXTENSION_OR_CORRUPT_INVALID_SIGNATURE");return}this.fileData=e[0],this.errorMessage=""}})}extract(){if(this.fileData)if(this.fileData.size<=10485760){this.isLoading=!0;let i="."+this.extension;this.ocrContentExtractorService.getDocumentContentByOcr(this.fileData,i).subscribe({next:t=>{this.isLoading=!1,this.fileInput.nativeElement.value=null,this.fileData=null,this.errorMessage="",t?(this.extractedText=t,this.toastrService.success(this.translationService.getValue("OCR_CONTENT_EXTRACTOR_SUCCESS"))):(this.extractedText="",this.toastrService.error(this.translationService.getValue("OCR_CONTENT_EXTRACTOR_FAILED")))},error:t=>{this.errorMessage="",this.isLoading=!1}})}else this.isLoading=!1,this.toastrService.error(this.translationService.getValue("FILE_SIZE_EXCEEDS_LIMIT")),this.errorMessage=this.translationService.getValue("FILE_SIZE_EXCEEDS_LIMIT")}static \u0275fac=(()=>{let e;return function(t){return(e||(e=w(r)))(t||r)}})();static \u0275cmp=N({type:r,selectors:[["app-ocr-content-extractor"]],viewQuery:function(i,t){if(i&1&&V(Ce,5),i&2){let o;y(o=b())&&(t.fileInput=o.first)}},features:[R],decls:35,vars:16,consts:[["file",""],[1,"content"],[1,"container-fluid"],[1,"d-flex","mb-2"],[1,"me-auto"],[1,"mb-0","page-title"],["code","OCR_CONTENT_EXTRACTOR"],["appearance","outlined"],[1,"row"],[1,"col-md-3"],[1,"form-group"],["type","file",1,"form-control","w-100",3,"change"],[1,"text-danger"],[1,"row","my-3"],[1,"m-top-10","col-md-12"],["matButton","filled","cdkFocusInitial","",1,"success","me-2",3,"click"],[1,"medium-icon","fs-5","align-middle"],[1,"col"],["name","extractedText","rows","20",1,"form-control",3,"ngModelChange","ngModel","placeholder"],[1,"spinner-container"],["mode","indeterminate","diameter","60","strokeWidth","5"]],template:function(i,t){if(i&1){let o=D();a(0,"section",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"span",5),l(5),p(6,"translate"),h(7,"app-page-help-text",6),n()()(),a(8,"mat-card",7)(9,"mat-card-content")(10,"form")(11,"div",8)(12,"div",9)(13,"div",10)(14,"label"),l(15),p(16,"translate"),n(),a(17,"input",11,0),_("change",function(){f(o);let c=L(18);return u(t.upload(c.files))}),n()()()(),a(19,"div",8)(20,"div",9),x(21,Ee,2,1,"span",12),n()(),a(22,"div",13)(23,"div",14)(24,"button",15),_("click",function(){return f(o),u(t.extract())}),a(25,"mat-icon",16),l(26,"download"),n(),l(27),p(28,"translate"),n()()(),a(29,"div",8)(30,"div",17)(31,"textarea",18),p(32,"translate"),P("ngModelChange",function(c){return f(o),X(t.extractedText,c)||(t.extractedText=c),u(c)}),l(33,"              "),n()()()()()()(),x(34,xe,2,0,"div",19),n()}i&2&&(s(5),S("",d(6,8,"OCR_CONTENT_EXTRACTOR")," "),s(10),v(d(16,10,"DOCUMENT_UPLOAD")),s(6),g(t.errorMessage?21:-1),s(6),S(" ",d(28,12,"EXTRACT")," "),s(4),F("placeholder",H(d(32,14,"EXTRACTED_TEXT"))),B("ngModel",t.extractedText),s(3),g(t.isLoading?34:-1))},dependencies:[se,ne,ee,te,ie,oe,re,z,$,Y,pe,Q,j,me,le,ce,G,k,W],encapsulation:2})};export{fe as OcrContentExtractorComponent};
