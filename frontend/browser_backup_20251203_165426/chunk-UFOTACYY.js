import{a as k}from"./chunk-C3OPHOKD.js";import{Dc as h,Gc as g,d as b,h as d}from"./chunk-KZMFGXDY.js";import{Gb as u,J as a,Nb as m,_b as c,ja as l,o as i}from"./chunk-W3TJXGK4.js";var f=[{id:0,name:"Daily"},{id:1,name:"Weekly"},{id:2,name:"Monthly"},{id:3,name:"Quarterly"},{id:4,name:"HalfYearly"},{id:5,name:"Yearly"}];var C=class s{constructor(e,t){this.httpClient=e;this.clonerService=t}maxRetries=2;_IsSmtpConfigured$=new i(!1);_allowFileExtension$=new i([]);get IsSmtpConfigured(){return this._IsSmtpConfigured$.asObservable()}get allowFileExtension$(){return this._allowFileExtension$.asObservable()}_sideMenuStatus$=new i(!1);get sideMenuStatus$(){return this._sideMenuStatus$.asObservable()}setSideMenuStatus(e){this._sideMenuStatus$.next(e)}setIsSmtpConfigured(e){this._IsSmtpConfigured$.next(e)}setAllowFileExtension(e){if(e)this._allowFileExtension$.next(this.clonerService.deepClone(e));else{let t=sessionStorage.getItem("allowFileExtension");t&&this._allowFileExtension$.next(JSON.parse(t))}}getUsersForDropdown(){return this.httpClient.get("user/dropdown")}getRoles(){return this.httpClient.get("role")}getReminder(e){let t=`reminder/${e}`;return this.httpClient.get(t)}addDocumentAuditTrail(e){return this.httpClient.post("documentAuditTrail",e)}getDocumentChunks(e,t){let n="";switch(t?.moduleNo){case 2:n=`CourseSessionMedia/${t.id}/chunks`;break;case 3:n=`NonConformanceResponseDocument/${e}/chunks`;break;default:n=`document/${e}/chunks`;break}return this.httpClient.get(n)}getDocumentSummary(e){let t=`document/${e}/summary`;return this.httpClient.get(t)}downloadDocumentChunk(e,t,n){let r="";switch(n?.moduleNo){case 1:r=`AuditResponseAttachment/${e}/chunk/${t}/download`;break;case 2:r=`CourseSessionMedia/${n.id}/chunk/${t}/download`;break;case 3:r=`NonConformanceResponse/${e}/chunk/${t}/download`;break;case 4:r=`CapaAttachment/${e}/chunk/${t}/download`;break;case 5:r=`RiskAttachment/${e}/chunk/${t}/download`;break;case 6:r=`ComplaintAttachment/${e}/chunk/${t}/download`;break;case 8:r=`SupplierCertification/${e}/chunk/${t}/download`;break;default:r=`document/${e}/chunk/${t}/download`;break}return this.httpClient.get(r).pipe(u({count:this.maxRetries,delay:(p,o)=>(console.warn(`Retrying chunk... Attempt ${o}`),l(Math.pow(2,o)*1e3))}))}checkDocumentStoreAsChunk(e){let t="";switch(e.moduleNo){case 2:t=`CourseSessionMedia/${e.id}/isChunked`;break;default:t=`document/${e.documentId}/isChunked`;break}return this.httpClient.get(t)}downloadDocument(e){let t="";if(e.isFromPublicPreview){let n=e.linkPassword?encodeURIComponent(e.linkPassword):"";t=`DocumentShareableLink/${e.documentId}/download?password=${n}`}else e.isFileRequestDocument?t=`FileRequestDocument/${e.documentId}/download`:e.moduleNo==2?t=`CourseSessionMedia/${e?.id}/download`:e.moduleNo==8?t=`SupplierCertification/${e.documentId}/download`:e.documentVersionId?t=`document/${e.documentVersionId}/download?isVersion=${e.isVersion}`:t=`document/${e.documentId}/download?isVersion=${e.isVersion}`;return this.httpClient.get(t,{reportProgress:!0,observe:"events",responseType:"blob"}).pipe(u({count:this.maxRetries,delay:(n,r)=>(console.warn(`Retrying chunk... Attempt ${r}`),l(Math.pow(2,r)*1e3))}))}isDownloadFlag(e){let t=`document/${e}/isDownloadFlag`;return this.httpClient.get(t)}checkDocumentPermission(e){let t=`document/${e}/permission`;return this.httpClient.get(t)}getDocumentToken(e){let t="";switch(e.moduleNo){case 1:t=`AuditAttachment/${e.documentId}/token`;break;case 3:t=`NonConformanceResponseDocument/${e.documentId}/token`;break;case 4:t=`CapaAttachment/${e.documentId}/token`;break;case 5:t=`RiskAttachment/${e.documentId}/token`;break;case 6:t=`ComplaintAttachment/${e.documentId}/token`;break;default:e.isFromPublicPreview?t=`DocumentShareableLink/${e.documentId}/token`:e.isFileRequestDocument?t=`FileRequestDocument/${e.documentId}/token`:e.documentVersionId?t=`documentToken/${e.documentVersionId}/token`:t=`documentToken/${e.documentId}/token`;break}return this.httpClient.get(t)}deleteDocumentToken(e){let t=`documentToken/${e}`;return this.httpClient.delete(t)}readDocument(e){let t="";switch(e?.moduleNo){case 1:t=`AuditAttachment/${e?.documentId}/readText`;break;case 2:t=`CourseSessionMedia/${e?.id}/readText`;break;case 3:t=`NonConformanceResponseDocument/${e?.documentId}/readText`;break;case 4:t=`CapaAttachment/${e.documentId}/readText`;break;case 5:t=`RiskAttachment/${e.documentId}/readText`;break;case 6:t=`ComplaintAttachment/${e.documentId}/readText`;break;default:if(e.isFromPublicPreview){let n=e.linkPassword?encodeURIComponent(e.linkPassword):"";t=`DocumentShareableLink/${e.documentId}/readtext?password=${n}`}else e.isFileRequestDocument?t=`FileRequestDocument/${e.documentId}/readText`:e.documentVersionId?t=`document/${e.documentVersionId}/readText?isVersion=${e.isVersion}`:t=`document/${e.documentId}/readText?isVersion=${e.isVersion}`;break}return this.httpClient.get(t)}getReminderFrequency(){return a(f)}addDocumentWithAssign(e){let t="document/assign",n=new FormData;return n.append("files",e.file??""),n.append("name",e.name??""),n.append("categoryId",e.categoryId??""),n.append("documentStatusId",e.documentStatusId??""),n.append("clientId",e.clientId??""),n.append("storageSettingId",e.storageSettingId??""),n.append("description",e.description??""),n.append("extension",e.extension??""),n.append("retentionPeriodInDays",e.retentionPeriodInDays?e.retentionPeriodInDays?.toString():"0"),n.append("onExpiryAction",e.onExpiryAction?e.onExpiryAction?.toString():"0"),n.append("documentMetaDataString",JSON.stringify(e.documentMetaDatas)),this.httpClient.post(t,n)}markChunkAsUploaded(e,t){return this.httpClient.post("document/chunk/uploadStatus",{documentId:e,status:t})}getAllRemindersForCurrentUser(e){let t="reminder/all/currentuser",n=new h().set("Fields",e.fields?e.fields:"").set("OrderBy",e.orderBy?e.orderBy:"").set("PageSize",e.pageSize.toString()).set("Skip",e.skip.toString()).set("SearchQuery",e.searchQuery?e.searchQuery:"").set("subject",e.subject?e.subject:"").set("message",e.message?e.message:"").set("frequency",e.frequency?e.frequency:"");return this.httpClient.get(t,{params:n,observe:"response"})}deleteReminderCurrentUser(e){let t=`reminder/${e}/currentuser`;return this.httpClient.delete(t)}checkEmailSMTPSetting(){return this.httpClient.get("EmailSMTPSetting/check").pipe(m(1),c(t=>{this._IsSmtpConfigured$.next(t.data)}))}getPageHelperText(e){let t=`pagehelper/code/${e}`;return this.httpClient.get(t)}checkDocumentIsSignedByUser(e){let t=`document/${e}/userSignBy`;return this.httpClient.get(t)}getAllowFileExtensions(){let e=sessionStorage.getItem("allowFileExtension");return e?(this._allowFileExtension$.next(JSON.parse(e)),a(JSON.parse(e))):this.httpClient.get("AllowFileExtension").pipe(c(n=>{this.setAllowFileExtension(n),n&&n.length>0&&sessionStorage.setItem("allowFileExtension",JSON.stringify(n))}))}getOptimizedConfig(e){return e<1?{chunkSize1:512*1024,parallelCalls:3}:e<5?{chunkSize1:1*1024*1024,parallelCalls:4}:e<20?{chunkSize1:2*1024*1024,parallelCalls:6}:{chunkSize1:5*1024*1024,parallelCalls:8}}getNetworkSpeed(){let e=this.getInternetSpeed();return console.warn("Speed: ",e),e>0?this.getOptimizedConfig(e):{chunkSize1:2*1024*1024,parallelCalls:3}}getInternetSpeed(){let e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return e&&e.downlink?e.downlink:0}calculateDuration(e,t){let n=new Date(e),p=new Date(t).getTime()-n.getTime(),o=Math.round(p/1e3),S=Math.round(o/3600),$=Math.round(o%3600/60),v=o%60;return`${S}h ${$}m ${v}s`}getarchiveRetentionPeriod(){return this.httpClient.get("document/ArchiveRetentionPeriod")}archiveRetentionPeriod(e){return this.httpClient.post("document/ArchiveRetentionPeriod",e)}static \u0275fac=function(t){return new(t||s)(d(g),d(k))};static \u0275prov=b({token:s,factory:s.\u0275fac,providedIn:"root"})};export{f as a,C as b};
