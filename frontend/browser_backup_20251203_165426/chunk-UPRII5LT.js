import{a as J}from"./chunk-YZ5VWOBY.js";import{a as z}from"./chunk-KCPEL47F.js";import"./chunk-NJY6F3LT.js";import{a as Y,c as $}from"./chunk-GYIDN45C.js";import"./chunk-G5E2PA5H.js";import"./chunk-DXL7FQB3.js";import"./chunk-F2N2VWHU.js";import{d as H}from"./chunk-AHHITDV2.js";import"./chunk-QPRQJRAS.js";import{c as q}from"./chunk-PJSVLHWR.js";import"./chunk-546GNQSA.js";import{b as F,c as M,e as E,f as h}from"./chunk-2DXU6Z77.js";import{b as A}from"./chunk-WC3ZMFX5.js";import"./chunk-UFOTACYY.js";import"./chunk-RKRBEXQJ.js";import"./chunk-C3OPHOKD.js";import{e as P}from"./chunk-F3ENXN4Q.js";import{C as U,E as V,e as L,h as B,i as N,o as j,r as G,u as K}from"./chunk-KYSGX4IW.js";import{a as R}from"./chunk-LCPYESOB.js";import"./chunk-BFSIXXTJ.js";import{a as O,b}from"./chunk-P6E4AR6Q.js";import{ta as T,va as x}from"./chunk-GDJX5AXE.js";import{$ as m,Ca as u,Da as v,Db as p,Eb as d,Fa as I,Ga as g,Ha as S,Ia as f,Ja as i,Ka as n,La as _,Pc as y,Rc as D,Ua as w,W as o,Wa as W,ga as k,jb as a,lb as s,vb as C}from"./chunk-KZMFGXDY.js";import"./chunk-W3TJXGK4.js";import"./chunk-H5HZ6YB3.js";function X(r,l){if(r&1&&(i(0,"mat-option",12),a(1),n()),r&2){let e=l.$implicit;f("value",e.id),o(),s(" ",e.name," ")}}function Z(r,l){r&1&&(i(0,"div",17),a(1),p(2,"translate"),n()),r&2&&(o(),s(" ",d(2,1,"SELECT_WORKFLOW")," "))}function ee(r,l){if(r&1&&(i(0,"div"),u(1,Z,3,3,"div",17),n()),r&2){let e,t=W();o(),v(!((e=t.workflowInstanceForm.get("workflowId"))==null||e.errors==null)&&e.errors.required?1:-1)}}var Q=class r{constructor(l,e,t,c,te,oe,ie){this.fb=l;this.toastrService=e;this.translationService=t;this.dialogRef=c;this.data=te;this.workflowService=oe;this.workflowInstanceService=ie}workflowInstanceForm;workflows=[];ngOnInit(){this.createForm(),this.getWorkflows()}createForm(){this.workflowInstanceForm=this.fb.group({workflowId:["",[L.required]],documentId:[this.data.document.id]})}getWorkflows(){this.workflowService.getWorkflowsNotStarted(this.data.document.id??"").subscribe({next:l=>{Array.isArray(l)&&(this.workflows=[...l])},error:()=>{this.toastrService.error(this.translationService.getValue("WORKFLOW_FETCH_FAILED"))}})}saveWorkflowInstance(){if(this.workflowInstanceForm.invalid){this.workflowInstanceForm.markAllAsTouched();return}let e={workflowId:this.workflowInstanceForm.get("workflowId")?.value,documentId:this.data.document.id??""};this.workflowInstanceService.addWorkflowInstance(e).subscribe({next:t=>{t&&(this.toastrService.success(this.translationService.getValue("WORKFLOW_CREATED_SUCCESSFULLY")),this.dialogRef.close(t))},error:t=>{this.toastrService.error(this.translationService.getValue("WORKFLOW_CREATION_FAILED"))}})}closeDialog(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||r)(m(U),m(A),m(R),m(F),m(M),m(J),m(z))};static \u0275cmp=k({type:r,selectors:[["app-manage-workflow-instance"]],decls:35,vars:19,consts:[[1,"d-flex"],[1,"me-auto","p-2"],[1,"mb-3","page-title"],[3,"code"],[1,"d-flex","justify-content-end","mb-2"],[1,"close-icon","text-danger","cursor-pointer",3,"click"],[3,"formGroup"],[1,"row"],[1,"col-md-12"],[1,"form-group"],[1,"form-label","text-danger"],["panelClass","mat-select-control","formControlName","workflowId",1,"form-control",3,"placeholder"],[3,"value"],[1,"mt-2","col-md-12"],["matButton","filled","type","button","cdkFocusInitial","",1,"success","me-2",3,"click"],[1,"medium-icon"],["matButton","filled","type","button",1,"error",3,"click"],[1,"text-danger"]],template:function(e,t){if(e&1&&(i(0,"mat-dialog-content")(1,"div",0)(2,"div",1)(3,"span",2),a(4),p(5,"translate"),_(6,"app-page-help-text",3),n()(),i(7,"div",4)(8,"mat-icon",5),w("click",function(){return t.closeDialog()}),a(9,"cancel"),n()()(),i(10,"form",6)(11,"div",7)(12,"div",8)(13,"div",9)(14,"label",10),a(15),p(16,"translate"),i(17,"sup"),a(18,"*"),n()(),i(19,"mat-select",11),p(20,"translate"),g(21,X,2,2,"mat-option",12,I),n(),u(23,ee,2,1,"div"),n()(),i(24,"div",13)(25,"button",14),w("click",function(){return t.saveWorkflowInstance()}),i(26,"mat-icon",15),a(27,"save"),n(),a(28),p(29,"translate"),n(),i(30,"button",16),w("click",function(){return t.closeDialog()}),i(31,"mat-icon",15),a(32,"cancel"),n(),a(33),p(34,"translate"),n()()()()()),e&2){let c;o(4),s(" ",d(5,9,"START_WORKFLOW")," "),o(2),f("code","MANAGE_WORKFLOW"),o(4),f("formGroup",t.workflowInstanceForm),o(5),s("",d(16,11,"WORKFLOW")," "),o(4),f("placeholder",C(d(20,13,"SELECT_WORKFLOW"))),o(2),S(t.workflows),o(2),v((c=t.workflowInstanceForm.get("workflowId"))!=null&&c.touched&&((c=t.workflowInstanceForm.get("workflowId"))!=null&&c.errors)?23:-1),o(5),s(" ",d(29,15,"SAVE")," "),o(5),s(" ",d(34,17,"CANCEL")," ")}},dependencies:[h,E,V,j,B,N,G,K,$,Y,H,q,D,P,b,O,x,T,y],encapsulation:2})};export{Q as ManageWorkflowInstanceComponent};
