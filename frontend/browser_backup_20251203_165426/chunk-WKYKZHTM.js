import{a as $t}from"./chunk-C62NKWNL.js";import{b as Vt,d as Ht}from"./chunk-L5P2ZGP4.js";import{a as Lt}from"./chunk-Q64ABPSN.js";import{a as w}from"./chunk-D6ZLTYCQ.js";import"./chunk-GVGC473E.js";import{a as De,b as xt,c as Et}from"./chunk-PJWKAJON.js";import{a as Pe,b as ht}from"./chunk-ZEPKQIVA.js";import{a as bt,b as Rt,c as It,d as Ut,e as Mt,f as Tt,g as wt,h as Pt,i as Dt,j as Ft,k as At,l as yt,m as Nt,n as kt,o as Bt,p as Ot}from"./chunk-32HAOKOZ.js";import{a as jt}from"./chunk-DP5AXSVW.js";import{a as te}from"./chunk-Y2ERMW5J.js";import{a as st,b as lt,c as mt,d as pt}from"./chunk-AO6AHHEQ.js";import"./chunk-NUIAS2S4.js";import"./chunk-I43MH25B.js";import"./chunk-OHUA35YV.js";import{a as he,b as xe}from"./chunk-55DV7QCW.js";import"./chunk-4U6IWAJM.js";import"./chunk-BEIMTKK4.js";import{a as dt,b as ut}from"./chunk-YCBFVA3Y.js";import{a as j}from"./chunk-ZXWR2MAY.js";import"./chunk-G4LST2RF.js";import"./chunk-NJY6F3LT.js";import{a as Ct,b as St,c as gt}from"./chunk-GYIDN45C.js";import"./chunk-G5E2PA5H.js";import"./chunk-DXL7FQB3.js";import{a as _t}from"./chunk-F2N2VWHU.js";import{d as vt}from"./chunk-AHHITDV2.js";import"./chunk-QPRQJRAS.js";import{c as Y}from"./chunk-PJSVLHWR.js";import{a as q}from"./chunk-546GNQSA.js";import{b as tt,c as it,d as nt,e as rt,f as ot}from"./chunk-2DXU6Z77.js";import{b as V}from"./chunk-WC3ZMFX5.js";import{b as ce}from"./chunk-UFOTACYY.js";import{a as ct}from"./chunk-RKRBEXQJ.js";import"./chunk-C3OPHOKD.js";import{a as Q,b as z,c as ft,e as H}from"./chunk-F3ENXN4Q.js";import{B as Se,E as ge,c as de,e as b,h as ue,i as fe,o as _e,r as ve,u as Ce}from"./chunk-KYSGX4IW.js";import"./chunk-LCPYESOB.js";import{e as pe,g as $,h as G,k as W}from"./chunk-BFSIXXTJ.js";import{a as k,b as B}from"./chunk-P6E4AR6Q.js";import{ta as y,ua as at,va as N}from"./chunk-GDJX5AXE.js";import{$ as C,$a as se,Ca as u,Da as f,Db as p,Ea as K,Eb as c,Ga as Z,Ha as ee,Ia as _,Ja as o,Ka as a,La as g,Ob as Ze,Pa as D,Pc as O,Qa as F,Rc as L,Sa as M,Ua as x,W as i,Wa as v,_a as ae,ab as le,d as Ge,eb as ze,ga as T,h as We,i as X,jb as l,ka as P,kb as R,lb as d,ma as h,mb as me,oa as qe,p as I,pb as Ye,q as U,qb as Je,rb as Xe,rc as et,vb as Ke,za as Qe,zb as A}from"./chunk-KZMFGXDY.js";import{Pa as Ve,Ya as He,_b as we,fa as Le,gb as $e,la as je,o as oe}from"./chunk-W3TJXGK4.js";import{a as Be,b as Oe}from"./chunk-H5HZ6YB3.js";var zt=()=>["/users"];function Yt(e,s){e&1&&(o(0,"span",4),l(1),p(2,"translate"),a()),e&2&&(i(),R(c(2,1,"EDIT_USER")))}function Jt(e,s){e&1&&(o(0,"span",4),l(1),p(2,"translate"),a()),e&2&&(i(),R(c(2,1,"ADD_USER")))}function Xt(e,s){e&1&&(o(0,"div",13),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"FIRST_NAME_IS_REQUIRED")," "))}function Kt(e,s){e&1&&(o(0,"div",13),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"LAST_NAME_IS_REQUIRED")," "))}function Zt(e,s){e&1&&(o(0,"div",13),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"MOBILE_IS_REQUIRED")," "))}function ei(e,s){e&1&&(o(0,"div",13),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"EMAIL_IS_REQUIRED")," "))}function ti(e,s){e&1&&(o(0,"div",13),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"PLEASE_ENTER_VALID_EMAIL")," "))}function ii(e,s){if(e&1&&(u(0,ei,3,3,"div",13),u(1,ti,3,3,"div",13)),e&2){let t,r,n=v();f(!((t=n.userForm.get("email"))==null||t.errors==null)&&t.errors.required?0:-1),i(),f(!((r=n.userForm.get("email"))==null||r.errors==null)&&r.errors.email?1:-1)}}function ni(e,s){e&1&&(l(0),p(1,"translate")),e&2&&d(" ",c(1,1,"PASSWORD_IS_REQUIRED")," ")}function ri(e,s){e&1&&(o(0,"div"),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"YOU_HAVE_TO_ENTER_AT_LEAST_DIGIT")," "))}function oi(e,s){if(e&1&&(o(0,"div",13),u(1,ni,2,3),u(2,ri,3,3,"div"),a()),e&2){let t,r,n=v(2);i(),f(!((t=n.userForm.get("password"))==null||t.errors==null)&&t.errors.required?1:-1),i(),f(!((r=n.userForm.get("password"))==null||r.errors==null)&&r.errors.minlength?2:-1)}}function ai(e,s){e&1&&(o(0,"div",13),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"CONFIRM_PASSWORD_IS_REQUIRED")," "))}function si(e,s){e&1&&(o(0,"div",13),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"PASSWORDS_DO_NOT_MATCH")," "))}function li(e,s){if(e&1&&(o(0,"div",9)(1,"div",10)(2,"label",11),l(3),p(4,"translate"),o(5,"sup"),l(6,"*"),a()(),g(7,"input",26),u(8,oi,3,2,"div",13),a()(),o(9,"div",9)(10,"div",10)(11,"label",11),l(12),p(13,"translate"),o(14,"sup"),l(15,"*"),a()(),g(16,"input",27),u(17,ai,3,3,"div",13),u(18,si,3,3,"div",13),a()()),e&2){let t,r,n,m=v();i(3),d("",c(4,5,"PASSWORD")," "),i(5),f((t=m.userForm.get("password"))!=null&&t.touched&&((t=m.userForm.get("password"))!=null&&t.errors)?8:-1),i(4),d("",c(13,7,"CONFIRM_PASSWORD")," "),i(5),f((r=m.userForm.get("confirmPassword"))!=null&&r.touched&&((r=m.userForm.get("confirmPassword"))!=null&&r.errors)&&(!((r=m.userForm.get("confirmPassword"))==null||r.errors==null)&&r.errors.required)?17:-1),i(),f((n=m.userForm.get("confirmPassword"))!=null&&n.touched&&m.userForm.hasError("notSame")?18:-1)}}function mi(e,s){if(e&1&&(o(0,"span"),l(1),a()),e&2){let t=v();i(),d(" ",t.selectedRoles[0].name," ")}}function pi(e,s){if(e&1&&(o(0,"span",19),l(1),a()),e&2){let t=v();i(),me(" (+",t.selectedRoles.length-1," ",t.selectedRoles.length===2?"other":"others",") ")}}function ci(e,s){if(e&1&&(o(0,"mat-option",20),l(1),a()),e&2){let t=s.$implicit;_("value",t),i(),R(t.name)}}function di(e,s){e&1&&(o(0,"div",31)(1,"span",32),l(2,"info"),a(),o(3,"span",33),l(4),p(5,"translate"),a()()),e&2&&(i(4),d(" ",c(5,1,"Grants full access to all system features and settings.")," "))}function ui(e,s){if(e&1&&(o(0,"div",21)(1,"div",28)(2,"mat-checkbox",29),l(3),p(4,"translate"),a()(),o(5,"div",30),u(6,di,6,3,"div",31),a()()),e&2){let t,r=v();i(3),d(" ",c(4,2,"IS_SUPERADMIN")," "),i(3),f((t=r.userForm.get("isSuperAdmin"))!=null&&t.value?6:-1)}}function fi(e,s){if(e&1){let t=M();o(0,"button",34),x("click",function(){I(t);let n=v();return U(n.saveUser())}),o(1,"mat-icon",25),l(2,"save"),a(),l(3),p(4,"translate"),p(5,"translate"),a()}if(e&2){let t=v();i(3),d(" ",t.isEditMode?c(4,1,"UPDATE"):c(5,3,"SAVE")," ")}}var ie=class e extends j{constructor(t,r,n,m,S,E,J){super();this.fb=t;this.router=r;this.activeRoute=n;this.userService=m;this.toastrService=S;this.commonService=E;this.securityService=J}user;userForm;roleList;isEditMode=!1;selectedRoles=[];securityObject;UserStore=X(Lt);ngOnInit(){this.getAuthObj(),this.createUserForm(),this.sub$.sink=this.activeRoute.data.subscribe(t=>{if(t&&t.user){this.isEditMode=!0,this.userForm.patchValue(t.user),this.user=t.user;let r=this.userForm.get("email");r&&r.disable()}else{let r=this.userForm.get("password");r&&r.setValidators([b.required,b.minLength(6)]);let n=this.userForm.get("confirmPassword");n&&n.setValidators([b.required]);let m=this.userForm.get("email");m&&m.enable()}}),this.getRoles()}getAuthObj(){this.sub$.sink=this.securityService.SecurityObject.subscribe(t=>{t&&(this.securityObject=t)})}createUserForm(){this.userForm=this.fb.group({id:[""],firstName:["",[b.required]],lastName:["",[b.required]],email:["",[b.required,b.email]],phoneNumber:["",[b.required]],isSuperAdmin:[!1],password:[""],confirmPassword:[""]},{validators:this.checkPasswords})}checkPasswords(t){let r=t.get("password")?.value,n=t.get("confirmPassword")?.value;return r===n?null:{notSame:!0}}markFormGroupTouched(t){Object.values(t.controls).forEach(r=>{r.markAsTouched(),r.controls&&this.markFormGroupTouched(r)})}saveUser(){if(this.userForm.valid){let t=this.createBuildObject();this.isEditMode?this.sub$.sink=this.userService.updateUser(t).subscribe(()=>{this.toastrService.success(this.translationService.getValue("USER_UPDATED_SUCCESSFULLY")),this.router.navigate(["/users"])}):this.sub$.sink=this.userService.addUser(t).subscribe(()=>{this.toastrService.success(this.translationService.getValue("USER_CREATED_SUCCESSFULLY")),this.router.navigate(["/users"])}),this.UserStore.getUsers()}else this.markFormGroupTouched(this.userForm)}createBuildObject(){return{id:this.userForm.get("id")?.value,firstName:this.userForm.get("firstName")?.value,lastName:this.userForm.get("lastName")?.value,email:this.userForm.get("email")?.value,phoneNumber:this.userForm.get("phoneNumber")?.value,password:this.userForm.get("password")?.value,isSuperAdmin:this.userForm.get("isSuperAdmin")?.value,userName:this.userForm.get("email")?.value,userRoles:this.getSelectedRoles()}}getSelectedRoles(){return this.selectedRoles.filter(t=>!!t.id).map(t=>({userId:this.userForm.get("id")?.value,roleId:t.id}))}getRoles(){this.sub$.sink=this.commonService.getRoles().subscribe(t=>{if(this.roleList=t,this.isEditMode){let r=this.user.userRoles?.map(n=>n.roleId)??[];this.selectedRoles=this.roleList?.filter(n=>r?.indexOf(n.id??"")>-1)}})}static \u0275fac=function(r){return new(r||e)(C(Se),C($),C(pe),C(w),C(V),C(ce),C(ct))};static \u0275cmp=T({type:e,selectors:[["app-manage-user"]],features:[P],decls:66,vars:33,consts:[[1,"content"],[1,"container-fluid"],[1,"d-flex","mb-2"],[1,"me-auto"],[1,"mb-0","page-title"],[3,"code"],[3,"formGroup"],["appearance","outlined"],[1,"row"],[1,"col-md-6"],[1,"form-group"],[1,"form-label","text-danger"],["formControlName","firstName","type","text",1,"form-control"],[1,"text-danger"],["formControlName","lastName","type","text",1,"form-control"],["formControlName","phoneNumber","type","text",1,"form-control"],["formControlName","email","type","email","autocomplete","off",1,"form-control"],[1,"form-group","col-md-6"],["panelClass","mat-select-control","multiple","",1,"form-control",3,"valueChange","value"],[1,"example-additional-selection"],[3,"value"],[1,"form-group","col-md-6","d-md-flex","mt-3"],[1,"col-md-12","mt-4"],["class","success me-2","matButton","filled","cdkFocusInitial","",3,"click",4,"hasClaim"],["type","button","matButton","filled",1,"error",3,"routerLink"],[1,"medium-icon","align-middle"],["autocomplete","new-password","formControlName","password","type","password",1,"form-control"],["autocomplete","new-password","formControlName","confirmPassword","type","password",1,"form-control"],[1,"col-md-3","col-12","col-sm-12"],["color","primary","formControlName","isSuperAdmin",1,"example-margin"],[1,"col-md-8","col-sm-12","col-12"],[1,"d-flex","align-items-center","rounded-1","p-2",2,"background-color","#1976d2"],[1,"material-icons","me-2","text-light"],[1,"text-light"],["matButton","filled","cdkFocusInitial","",1,"success","me-2",3,"click"]],template:function(r,n){if(r&1&&(o(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3),u(4,Yt,3,3,"span",4)(5,Jt,3,3,"span",4),g(6,"app-page-help-text",5),a()(),o(7,"form",6)(8,"mat-card",7)(9,"mat-card-content")(10,"div",8)(11,"div",9)(12,"div",10)(13,"label",11),l(14),p(15,"translate"),o(16,"sup"),l(17,"*"),a()(),g(18,"input",12),u(19,Xt,3,3,"div",13),a()(),o(20,"div",9)(21,"div",10)(22,"label",11),l(23),p(24,"translate"),o(25,"sup"),l(26,"*"),a()(),g(27,"input",14),u(28,Kt,3,3,"div",13),a()(),o(29,"div",9)(30,"div",10)(31,"label",11),l(32),p(33,"translate"),o(34,"sup"),l(35,"*"),a()(),g(36,"input",15),u(37,Zt,3,3,"div",13),a()(),o(38,"div",9)(39,"div",10)(40,"label",11),l(41),p(42,"translate"),o(43,"sup"),l(44,"*"),a()(),g(45,"input",16),u(46,ii,2,2),a()(),u(47,li,19,9),o(48,"div",17)(49,"mat-label"),l(50),p(51,"translate"),a(),o(52,"mat-select",18),Xe("valueChange",function(S){return Je(n.selectedRoles,S)||(n.selectedRoles=S),S}),o(53,"mat-select-trigger"),u(54,mi,2,1,"span"),u(55,pi,2,2,"span",19),a(),Z(56,ci,2,2,"mat-option",20,K),a()(),u(58,ui,7,4,"div",21),o(59,"div",22),h(60,fi,6,5,"button",23),o(61,"button",24)(62,"mat-icon",25),l(63,"cancel"),a(),l(64),p(65,"translate"),a()()()()()()()()),r&2){let m,S,E,J;i(4),f(n.isEditMode?4:5),i(2),_("code","MANAGE_USER"),i(),_("formGroup",n.userForm),i(7),d("",c(15,20,"FIRST_NAME")," "),i(5),f((m=n.userForm.get("firstName"))!=null&&m.touched&&((m=n.userForm.get("firstName"))!=null&&m.errors)&&(!((m=n.userForm.get("firstName"))==null||m.errors==null)&&m.errors.required)?19:-1),i(4),d("",c(24,22,"LAST_NAME")," "),i(5),f((S=n.userForm.get("lastName"))!=null&&S.touched&&((S=n.userForm.get("lastName"))!=null&&S.errors)&&(!((S=n.userForm.get("lastName"))==null||S.errors==null)&&S.errors.required)?28:-1),i(4),d("",c(33,24,"MOBILE_NUMBER")," "),i(5),f((E=n.userForm.get("phoneNumber"))!=null&&E.touched&&((E=n.userForm.get("phoneNumber"))!=null&&E.errors)&&(!((E=n.userForm.get("phoneNumber"))==null||E.errors==null)&&E.errors.required)?37:-1),i(4),d("",c(42,26,"EMAIL")," "),i(5),f((J=n.userForm.get("email"))!=null&&J.touched&&((J=n.userForm.get("email"))!=null&&J.errors)?46:-1),i(),f(n.isEditMode?-1:47),i(3),R(c(51,28,"ROLES")),i(2),Ye("value",n.selectedRoles),i(2),f(n.selectedRoles.length>0?54:-1),i(),f(n.selectedRoles.length>1?55:-1),i(),ee(n.roleList),i(2),f(n.securityObject.isSuperAdmin?58:-1),i(2),_("hasClaim","EDIT_USER"),i(),_("routerLink",A(32,zt)),i(3),d(" ",c(65,30,"CANCEL")," ")}},dependencies:[ge,_e,de,ue,fe,ve,Ce,B,k,Y,gt,_t,Ct,St,vt,xe,he,q,W,G,L,N,y,H,Q,z,O],styles:[".example-additional-selection[_ngcontent-%COMP%]{opacity:.75;font-size:.75em}"]})};var re=class e{constructor(s){this.userService=s}resolve(s,t){let r=s.paramMap.get("id");return this.userService.getUser(r??"")}static \u0275fac=function(t){return new(t||e)(We(w))};static \u0275prov=Ge({token:e,factory:e.\u0275fac,providedIn:"root"})};function vi(e,s){e&1&&(o(0,"div",13),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"PASSWORD_IS_REQUIRED")," "))}function Ci(e,s){e&1&&(o(0,"div",13),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"YOU_HAVE_TO_ENTER_AT_LEAST_DIGIT")," "))}function Si(e,s){if(e&1&&(u(0,vi,3,3,"div",13),u(1,Ci,3,3,"div",13)),e&2){let t,r,n=v();f(!((t=n.resetPasswordForm.get("password"))==null||t.errors==null)&&t.errors.required?0:-1),i(),f(!((r=n.resetPasswordForm.get("password"))==null||r.errors==null)&&r.errors.minlength?1:-1)}}function gi(e,s){e&1&&(o(0,"div",13),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"CONFIRM_PASSWORD_IS_REQUIRED")," "))}function hi(e,s){if(e&1&&u(0,gi,3,3,"div",13),e&2){let t,r=v();f(!((t=r.resetPasswordForm.get("confirmPassword"))==null||t.errors==null)&&t.errors.required?0:-1)}}function xi(e,s){e&1&&(o(0,"div",13),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"PASSWORDS_DO_NOT_MATCH")," "))}var Re=class e extends j{constructor(t,r,n,m,S){super();this.userService=t;this.fb=r;this.dialogRef=n;this.data=m;this.toastrService=S}resetPasswordForm;ngOnInit(){this.createResetPasswordForm(),this.resetPasswordForm.get("email")?.setValue(this.data.userName)}createResetPasswordForm(){this.resetPasswordForm=this.fb.group({email:[""],password:["",[b.required,b.minLength(6)]],confirmPassword:["",[b.required]]},{validator:this.checkPasswords})}checkPasswords(t){let r=t.get("password")?.value,n=t.get("confirmPassword")?.value;return r===n?null:{notSame:!0}}resetPassword(){this.resetPasswordForm.valid&&(this.sub$.sink=this.userService.resetPassword(this.createBuildObject()).subscribe(t=>{this.toastrService.success(this.translationService.getValue("SUCCESSFULLY_RESET_PASSWORD")),this.dialogRef.close()}))}createBuildObject(){return{email:"",password:this.resetPasswordForm.get("password")?.value,userName:this.resetPasswordForm.get("email")?.value}}onNoClick(){this.dialogRef.close()}static \u0275fac=function(r){return new(r||e)(C(w),C(Se),C(tt),C(it),C(V))};static \u0275cmp=T({type:e,selectors:[["app-reset-password"]],features:[P],decls:46,vars:22,consts:[[1,"d-flex"],[1,"me-auto","p-2"],[1,"mb-3","page-title"],[1,"d-flex","justify-content-end","mb-2"],[1,"close-icon","text-danger","cursor-pointer",3,"click"],[3,"formGroup"],[1,"col-md-12"],[1,"form-group"],["formControlName","email","type","email",1,"form-control","pe-none"],[1,"col-md-12","mt-2"],[1,"form-label","text-danger"],["autocomplete","new-password","formControlName","password","type","password",1,"form-control"],["autocomplete","new-password","formControlName","confirmPassword","type","password",1,"form-control"],[1,"text-danger"],[1,"col-md-12","mt-3"],["matButton","filled","cdkFocusInitial","",1,"success","me-2",3,"click"],[1,"medium-icon","align-middle"],["matButton","filled",1,"error",3,"click"]],template:function(r,n){if(r&1&&(o(0,"mat-dialog-content")(1,"div",0)(2,"div",1)(3,"span",2),l(4),p(5,"translate"),a()(),o(6,"div",3)(7,"mat-icon",4),x("click",function(){return n.onNoClick()}),l(8,"cancel"),a()()(),o(9,"form",5)(10,"div",6)(11,"div",7)(12,"label"),l(13),p(14,"translate"),a(),g(15,"input",8),a()(),o(16,"div",9)(17,"div",7)(18,"label",10),l(19),p(20,"translate"),o(21,"sup"),l(22,"*"),a()(),g(23,"input",11),u(24,Si,2,2),a()(),o(25,"div",9)(26,"div",7)(27,"label",10),l(28),p(29,"translate"),o(30,"sup"),l(31,"*"),a()(),g(32,"input",12),u(33,hi,1,1),u(34,xi,3,3,"div",13),a()(),o(35,"div",14)(36,"button",15),x("click",function(){return n.resetPassword()}),o(37,"mat-icon",16),l(38,"save"),a(),l(39),p(40,"translate"),a(),o(41,"button",17),x("click",function(){return n.onNoClick()}),o(42,"mat-icon",16),l(43,"cancel"),a(),l(44),p(45,"translate"),a()()()()),r&2){let m,S,E;i(4),d(" ",c(5,10,"RESET_PASSWORD")," "),i(5),_("formGroup",n.resetPasswordForm),i(4),R(c(14,12,"EMAIL")),i(6),d("",c(20,14,"PASSWORD")," "),i(5),f((m=n.resetPasswordForm.get("password"))!=null&&m.touched&&((m=n.resetPasswordForm.get("password"))!=null&&m.errors)?24:-1),i(4),d("",c(29,16,"CONFIRM_PASSWORD")," "),i(5),f((S=n.resetPasswordForm.get("confirmPassword"))!=null&&S.touched&&((S=n.resetPasswordForm.get("confirmPassword"))!=null&&S.errors)?33:-1),i(),f((E=n.resetPasswordForm.get("confirmPassword"))!=null&&E.touched&&n.resetPasswordForm.hasError("notSame")?34:-1),i(5),d(" ",c(40,18,"SAVE")," "),i(5),d(" ",c(45,20,"CANCEL")," ")}},dependencies:[ge,_e,de,ue,fe,ve,Ce,ot,rt,L,H,B,k,N,y,O],encapsulation:2})};var Ie=class{constructor(s){this.userService=s}userSubject=new oe([]);responseHeaderSubject=new oe({pageSize:0,pageNumber:0,totalCount:0,totalPages:0,skip:0});loadingSubject=new oe(!1);loading$=this.loadingSubject.asObservable();_count=0;get count(){return this._count}responseHeaderSubject$=this.responseHeaderSubject.asObservable();connect(){return this.userSubject.asObservable()}disconnect(){this.userSubject.complete(),this.loadingSubject.complete()}loadUsers(s){this.loadingSubject.next(!0),this.userService.getUsers(s).pipe($e(()=>this.loadingSubject.next(!1))).subscribe(t=>{let r=JSON.parse(t?.headers?.get("X-Pagination")??"{}");this.responseHeaderSubject.next(r);let n=[...t?.body??[]];this._count=n.length,this.userSubject.next(n)})}};var Ei=["input"],bi=()=>["/users/manage"],Ri=()=>["DELETE_USER","EDIT_USER"],Ii=()=>[10,20,30];function Ui(e,s){e&1&&(o(0,"button",32)(1,"mat-icon",33),l(2,"add"),a(),o(3,"span",34),l(4),p(5,"translate"),a()()),e&2&&(_("routerLink",A(4,bi)),i(4),R(c(5,2,"ADD_USER")))}function Mi(e,s){e&1&&(o(0,"th",35)(1,"span"),l(2),p(3,"translate"),a()()),e&2&&(i(2),d(" ",c(3,1,"ACTION")," "))}function Ti(e,s){if(e&1){let t=M();o(0,"button",41),x("click",function(){I(t);let n=v(2).$implicit,m=v();return U(m.editUser(n.id))}),o(1,"mat-icon"),l(2,"edit"),a(),l(3),p(4,"translate"),a()}e&2&&(i(3),d(" ",c(4,1,"EDIT")," "))}function wi(e,s){e&1&&h(0,Ti,5,3,"button",40),e&2&&_("hasClaim","EDIT_USER")}function Pi(e,s){if(e&1){let t=M();o(0,"button",41),x("click",function(){I(t);let n=v().$implicit,m=v();return U(m.deleteUser(n))}),o(1,"mat-icon"),l(2,"delete"),a(),l(3),p(4,"translate"),a()}e&2&&(i(3),d(" ",c(4,1,"DELETE")," "))}function Di(e,s){if(e&1){let t=M();o(0,"button",41),x("click",function(){I(t);let n=v(2).$implicit,m=v();return U(m.userPermission(n.id))}),o(1,"mat-icon"),l(2,"people"),a(),l(3),p(4,"translate"),a()}e&2&&(i(3),d(" ",c(4,1,"PERMISSION")," "))}function Fi(e,s){e&1&&h(0,Di,5,3,"button",39),e&2&&_("hasClaim","ASSIGN_PERMISSION")}function Ai(e,s){if(e&1){let t=M();o(0,"button",41),x("click",function(){I(t);let n=v(2).$implicit,m=v();return U(m.resetPassword(n))}),o(1,"mat-icon"),l(2,"key"),a(),l(3),p(4,"translate"),a()}e&2&&(i(3),d(" ",c(4,1,"RESET_PASSWORD")," "))}function yi(e,s){e&1&&h(0,Ai,5,3,"button",39),e&2&&_("hasClaim","RESET_PASSWORD")}function Ni(e,s){if(e&1&&(o(0,"td",36)(1,"button",37)(2,"mat-icon"),l(3,"more_vert"),a()(),o(4,"mat-menu",null,1),u(6,wi,1,1,"button",38),h(7,Pi,5,3,"button",39),u(8,Fi,1,1,"button",38),u(9,yi,1,1,"button",38),a()()),e&2){let t=s.$implicit,r=ze(5);i(),_("matMenuTriggerFor",r),Qe("aria-label","Action"),i(5),f(t.isDeleted?-1:6),i(),_("hasClaim",A(6,Ri)),i(),f(t.isDeleted?-1:8),i(),f(t.isDeleted?-1:9)}}function ki(e,s){e&1&&(o(0,"th",42),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"EMAIL")," "))}function Bi(e,s){if(e&1&&(o(0,"td",36),l(1),a()),e&2){let t=s.$implicit;i(),d(" ",t.email," ")}}function Oi(e,s){e&1&&(o(0,"th",42),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"FIRST_NAME")," "))}function Li(e,s){if(e&1&&(o(0,"td",36),l(1),a()),e&2){let t=s.$implicit;i(),d(" ",t.firstName," ")}}function ji(e,s){e&1&&(o(0,"th",42),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"LAST_NAME")," "))}function Vi(e,s){if(e&1&&(o(0,"td",36),l(1),a()),e&2){let t=s.$implicit;i(),d(" ",t.lastName," ")}}function Hi(e,s){e&1&&(o(0,"th",42),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"MOBILE_NUMBER")," "))}function $i(e,s){if(e&1&&(o(0,"td",36),l(1),a()),e&2){let t=s.$implicit;i(),d(" ",t.phoneNumber," ")}}function Gi(e,s){e&1&&(o(0,"th",42),l(1),p(2,"translate"),a()),e&2&&(i(),d(" ",c(2,1,"STATUS")," "))}function Wi(e,s){e&1&&g(0,"span",43)}function qi(e,s){e&1&&(o(0,"span",44),l(1),p(2,"translate"),a()),e&2&&(i(),R(c(2,1,"IN_ACTIVE")))}function Qi(e,s){if(e&1&&(o(0,"td",36),u(1,Wi,1,0,"span",43),u(2,qi,3,3,"span",44),a()),e&2){let t=s.$implicit;i(),f(t.isDeleted?-1:1),i(),f(t.isDeleted?2:-1)}}function zi(e,s){if(e&1&&(o(0,"td",45),g(1,"mat-paginator",46),a()),e&2){let t=v();i(),_("length",t.userResource.totalCount)("pageSize",t.userResource.pageSize)("pageSizeOptions",A(3,Ii))}}function Yi(e,s){e&1&&g(0,"tr",47)}function Ji(e,s){e&1&&g(0,"tr",48)}function Xi(e,s){e&1&&g(0,"tr",49)}function Ki(e,s){e&1&&(o(0,"tr")(1,"td")(2,"div",50)(3,"b"),l(4),p(5,"translate"),a()()()()),e&2&&(i(4),d(" ",c(5,1,"NO_DATA_FOUND")))}function Zi(e,s){e&1&&(o(0,"div",31),g(1,"mat-progress-spinner",51),a())}var Ue=class e extends j{constructor(t,r,n,m,S,E){super();this.userService=t;this.toastrService=r;this.commonService=n;this.commonDialogService=m;this.dialog=S;this.router=E;this.userResource=new $t,this.userResource.pageSize=10,this.userResource.orderBy="email asc"}dataSource;displayedColumns=["action","email","firstName","lastName","phoneNumber","isDeleted"];isLoadingResults=!0;userResource;loading$;paginator;sort;input;footerToDisplayed=["footer"];ngOnInit(){this.dataSource=new Ie(this.userService),this.dataSource.loadUsers(this.userResource),this.getResourceParameter()}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),this.sub$.sink=je(this.sort.sortChange,this.paginator.page).pipe(we(t=>{this.userResource.skip=this.paginator.pageIndex*this.paginator.pageSize,this.userResource.pageSize=this.paginator.pageSize,this.userResource.orderBy=this.sort.active+" "+this.sort.direction,this.dataSource.loadUsers(this.userResource)})).subscribe(),this.sub$.sink=Le(this.input.nativeElement,"keyup").pipe(Ve(1e3),He(),we(()=>{this.paginator.pageIndex=0,this.userResource.skip=0,this.userResource.searchQuery=this.input.nativeElement.value,this.dataSource.loadUsers(this.userResource)})).subscribe()}getResourceParameter(){this.sub$.sink=this.dataSource.responseHeaderSubject$.subscribe(t=>{t&&(this.userResource.pageSize=t.pageSize,this.userResource.skip=t.skip,this.userResource.totalCount=t.totalCount)})}deleteUser(t){this.sub$.sink=this.commonDialogService.deleteConfirmtionDialog(`${this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")} ${t.userName}`).subscribe(r=>{r&&(this.sub$.sink=this.userService.deleteUser(t.id??"").subscribe(()=>{this.toastrService.success(this.translationService.getValue("USER_DELETE_SUCCESSFULLY")),this.dataSource.loadUsers(this.userResource)}))})}resetPassword(t){this.dialog.open(Re,{width:"100%",maxWidth:"500px",data:Object.assign({},t)})}editUser(t){this.router.navigate(["/users/manage",t])}userPermission(t){this.router.navigate(["/users/permission",t])}static \u0275fac=function(r){return new(r||e)(C(w),C(V),C(ce),C(jt),C(nt),C($))};static \u0275cmp=T({type:e,selectors:[["app-user-list"]],viewQuery:function(r,n){if(r&1&&(ae(Pe,5),ae(De,5),ae(Ei,5)),r&2){let m;se(m=le())&&(n.paginator=m.first),se(m=le())&&(n.sort=m.first),se(m=le())&&(n.input=m.first)}},features:[P],decls:46,vars:18,consts:[["input",""],["menu","matMenu"],[1,"content"],[1,"container-fluid"],[1,"d-flex","mb-2"],[1,"me-auto"],[1,"mb-0","page-title"],[3,"code"],[1,"d-flex","justify-content-end"],["class","primary","matButton","filled",3,"routerLink",4,"hasClaim"],["appearance","outlined"],[1,"col-sm-5"],[1,"form-control",3,"placeholder"],[1,"table-responsive","mt-3"],[1,"grid-height-medium"],["mat-table","","matSort","","matSortActive","email","matSortDirection","asc",3,"dataSource"],["matColumnDef","action"],["class","table-column-fix-30","mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","email"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","firstName"],["matColumnDef","lastName"],["matColumnDef","phoneNumber"],["matColumnDef","isDeleted"],["matColumnDef","footer"],["mat-footer-cell","","colspan","6",4,"matFooterCellDef"],["class","grid-header-color","mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef","matFooterRowDefSticky"],[4,"matNoDataRow"],[1,"spinner-container"],["matButton","filled",1,"primary",3,"routerLink"],[1,"medium-icon","fs-5","align-middle"],[1,"d-none","d-lg-inline","ms-1"],["mat-header-cell","",1,"table-column-fix-30"],["mat-cell",""],["matMiniFab","",1,"primary",3,"matMenuTriggerFor"],["mat-menu-item","",1,"btn","btn-light","btn-sm"],["class","btn btn-light btn-sm","mat-menu-item","",3,"click",4,"hasClaim"],["mat-menu-item","","class","btn btn-light btn-sm",3,"click",4,"hasClaim"],["mat-menu-item","",1,"btn","btn-light","btn-sm",3,"click"],["mat-header-cell","","mat-sort-header",""],[1,"badge","bg-success"],[1,"badge","bg-danger"],["mat-footer-cell","","colspan","6"],[3,"length","pageSize","pageSizeOptions"],["mat-header-row","",1,"grid-header-color"],["mat-row",""],["mat-footer-row",""],[1,"m-2"],["mode","indeterminate","diameter","60","strokeWidth","5"]],template:function(r,n){r&1&&(o(0,"section",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"span",6),l(5),p(6,"translate"),g(7,"app-page-help-text",7),a()(),o(8,"div",8),h(9,Ui,6,5,"button",9),a()(),o(10,"mat-card",10)(11,"mat-card-header")(12,"div",11),g(13,"input",12,0),p(15,"translate"),a()(),o(16,"mat-card-content")(17,"div",13)(18,"div",14)(19,"table",15),D(20,16),h(21,Mi,4,3,"th",17)(22,Ni,10,7,"td",18),F(),D(23,19),h(24,ki,3,3,"th",20)(25,Bi,2,1,"td",18),F(),D(26,21),h(27,Oi,3,3,"th",20)(28,Li,2,1,"td",18),F(),D(29,22),h(30,ji,3,3,"th",20)(31,Vi,2,1,"td",18),F(),D(32,23),h(33,Hi,3,3,"th",20)(34,$i,2,1,"td",18),F(),D(35,24),h(36,Gi,3,3,"th",20)(37,Qi,3,2,"td",18),F(),D(38,25),h(39,zi,2,4,"td",26),F(),h(40,Yi,1,0,"tr",27)(41,Ji,1,0,"tr",28)(42,Xi,1,0,"tr",29)(43,Ki,6,3,"tr",30),a()()()()()()(),u(44,Zi,2,0,"div",31),p(45,"async")),r&2&&(i(5),d("",c(6,12,"USERS")," "),i(2),_("code","USERS"),i(2),_("hasClaim","CREATE_USER"),i(4),_("placeholder",Ke(c(15,14,"SEARCH_BY_USERNAME"))),i(6),_("dataSource",n.dataSource),i(21),_("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),i(),_("matRowDefColumns",n.displayedColumns),i(),_("matFooterRowDef",n.footerToDisplayed)("matFooterRowDefSticky",!0),i(2),f(c(45,16,n.dataSource.loading$)?44:-1))},dependencies:[Pe,De,W,G,L,Y,q,Ot,bt,It,Dt,Mt,Rt,At,Ut,Ft,Tt,Pt,wt,yt,kt,Nt,Bt,Et,xt,ht,pt,lt,st,mt,N,y,at,B,k,H,Q,z,ft,ut,dt,O,et],encapsulation:2})};var en=()=>["/users"];function tn(e,s){if(e&1){let t=M();o(0,"div",19)(1,"mat-checkbox",20),x("change",function(n){let m=I(t).$implicit,S=v().$implicit,E=v();return U(E.onPermissionChange(n,S,m))}),l(2),p(3,"translate"),a()()}if(e&2){let t=s.$implicit,r=v(2);i(),_("checked",r.checkPermission(t.id)),i(),d(" ",c(3,2,t.name.replaceAll(" ","_").toUpperCase())," ")}}function nn(e,s){if(e&1){let t=M();o(0,"div",12)(1,"div")(2,"mat-checkbox",17),x("change",function(n){let m=I(t).$implicit,S=v();return U(S.onPageSelect(n,m))}),o(3,"b"),l(4),p(5,"translate"),a()()(),o(6,"div",18),Z(7,tn,4,4,"div",19,K),a()()}if(e&2){let t=s.$implicit;i(4),d(" ",c(5,1,t.name.replaceAll(" ","_").toUpperCase())),i(3),ee(t.pageActions)}}function rn(e,s){if(e&1){let t=M();o(0,"button",21),x("click",function(){I(t);let n=v();return U(n.saveUserClaim())}),o(1,"mat-icon",16),l(2,"save"),a(),l(3),p(4,"translate"),a()}e&2&&(i(3),d(" ",c(4,1,"SAVE")," "))}var Me=class e{pages;user;manageUserClaimAction=new qe;step=0;constructor(){}ngOnInit(){}checkPermission(s){return!!this.user?.userClaims?.find(r=>r.pageActionId===s)}onPermissionChange(s,t,r){if(s.checked)this.user?.userClaims?.push({userId:this.user.id,claimType:r.code,claimValue:"",pageActionId:r.id,pageId:t.id});else{let n=this.user?.userClaims?.find(m=>m.pageActionId===r.id);if(n){let m=this.user?.userClaims?.indexOf(n,0);typeof m=="number"&&m>-1&&this.user?.userClaims?.splice(m,1)}}}onPageSelect(s,t){if(s.checked)t.pageActions.forEach(n=>{this.checkPermission(n.id)||this.user.userClaims?.push({userId:this.user.id,claimType:n.code,claimValue:"",pageActionId:n.id,pageId:t.id})});else{var r=t.pageActions?.map(n=>n.id);this.user.userClaims=this.user.userClaims?.filter(n=>r.indexOf(n.pageActionId)<0)}}saveUserClaim(){this.manageUserClaimAction.emit(this.user)}selecetAll(s){s.checked?this.pages.forEach(t=>{t.pageActions.forEach(r=>{this.checkPermission(r.id)||this.user.userClaims?.push({userId:this.user.id,claimType:r.code,claimValue:"",pageActionId:r.id,pageId:t.id})})}):this.user.userClaims=[]}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=T({type:e,selectors:[["app-user-permission-presentation"]],inputs:{pages:"pages",user:"user"},outputs:{manageUserClaimAction:"manageUserClaimAction"},decls:28,vars:14,consts:[[1,"content"],[1,"container-fluid"],[1,"d-flex","mb-2"],[1,"me-auto"],[1,"mb-0","page-title"],["code","USER_PAGE_PERMISSION_TO"],["appearance","outlined"],[1,"row","align-items-center"],[1,"col-md-4","col-sm-12"],[1,"page-title"],[1,"row"],[1,"col-sm-12","alt-bg"],[1,"d-flex","flex-column"],[1,"mt-2"],["class","success me-2","matButton","filled","cdkFocusInitial","",3,"click",4,"hasClaim"],["matButton","filled",1,"error",3,"routerLink"],[1,"medium-icon","align-middle"],["color","primary",3,"change"],[1,"row","ms-2"],[1,"col-sm-3","mb-0"],["color","primary",3,"change","checked"],["matButton","filled","cdkFocusInitial","",1,"success","me-2",3,"click"]],template:function(t,r){t&1&&(o(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),l(5),p(6,"translate"),o(7,"span"),l(8),g(9,"app-page-help-text",5),a()()()(),o(10,"mat-card",6)(11,"mat-card-content")(12,"div",7)(13,"div",8)(14,"h2",9),l(15),p(16,"translate"),a()()(),o(17,"div",10)(18,"div",11),Z(19,nn,9,3,"div",12,K),a()(),o(21,"div",13),h(22,rn,5,3,"button",14),o(23,"button",15)(24,"mat-icon",16),l(25,"cancel"),a(),l(26),p(27,"translate"),a()()()()()()),t&2&&(i(5),d("",c(6,7,"USER_PAGE_PERMISSION_TO")," "),i(3),me("",r.user.firstName," ",r.user.lastName," "),i(7),R(c(16,9,"PERMISSION")),i(4),ee(r.pages),i(3),_("hasClaim","ASSIGN_PERMISSION"),i(),_("routerLink",A(13,en)),i(3),d(" ",c(27,11,"CANCEL")," "))},dependencies:[Y,q,xe,he,W,G,L,H,Q,z,N,y,B,k,O],encapsulation:2})};var Te=class e extends j{constructor(t,r,n,m){super();this.activeRoute=t;this.router=r;this.toastrService=n;this.userService=m}user;actionStore=X(Vt);pageStore=X(Ht);pagesWithActions=Ze(()=>{let t=this.pageStore.pages(),r=this.actionStore.actions();return t.map(n=>Oe(Be({},n),{pageActions:r.filter(m=>m.pageId===n.id)}))});ngOnInit(){this.sub$.sink=this.activeRoute.data.subscribe(t=>{this.user=t.user})}manageUserClaimAction(t){let r=t.userClaims?.length?t.userClaims:[];this.sub$.sink=this.userService.updateUserClaim(r,t.id??"").subscribe(()=>{this.toastrService.success(this.translationService.getValue("USER_PERMISSION_UPDATED_SUCCESSFULLY")),this.router.navigate(["/users"])})}static \u0275fac=function(r){return new(r||e)(C(pe),C($),C(V),C(w))};static \u0275cmp=T({type:e,selectors:[["app-user-permission"]],features:[P],decls:1,vars:2,consts:[[3,"manageUserClaimAction","pages","user"]],template:function(r,n){r&1&&(o(0,"app-user-permission-presentation",0),x("manageUserClaimAction",function(S){return n.manageUserClaimAction(S)}),a()),r&2&&_("pages",n.pagesWithActions())("user",n.user)},dependencies:[Me],encapsulation:2})};var qr=[{path:"",component:Ue,data:{claimType:"VIEW_USERS"},canActivate:[te]},{path:"manage/:id",component:ie,resolve:{user:re},data:{claimType:"EDIT_USER"},canActivate:[te]},{path:"manage",component:ie,data:{claimType:"CREATE_USER"},canActivate:[te]},{path:"permission/:id",component:Te,resolve:{user:re},data:{claimType:"ASSIGN_PERMISSION"},canActivate:[te]}];export{qr as USER_ROUTES};
