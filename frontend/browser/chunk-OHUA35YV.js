import{A as O,Nb as p,Ob as I,Pb as M,d as P,i as m,o as x,t as w,v as j,z as l}from"./chunk-KZMFGXDY.js";import{C as K,Da as T,N as E,_b as C,d as v,gb as A,n as k}from"./chunk-W3TJXGK4.js";import{a as r,b as f}from"./chunk-H5HZ6YB3.js";function oe(t,e,n){let o=typeof t=="function"?{next:t,error:e,complete:n}:t;return c=>c.pipe(C({next:o.next,complete:o.complete}),T(i=>(o.error(i),K)),o.finalize?A(o.finalize):i=>i)}var W=Symbol("DEEP_SIGNAL");function F(t){return new Proxy(t,{has(e,n){return!!this.get(e,n,void 0)},get(e,n){let o=p(e);return!U(o)||!(n in o)?(l(e[n])&&e[n][W]&&delete e[n],e[n]):(l(e[n])||(Object.defineProperty(e,n,{value:I(()=>e()[n]),configurable:!0}),e[n][W]=!0),F(e[n]))}})}var H=[WeakSet,WeakMap,Promise,Date,Error,RegExp,ArrayBuffer,DataView,Function];function U(t){if(t===null||typeof t!="object"||_(t))return!1;let e=Object.getPrototypeOf(t);if(e===Object.prototype)return!0;for(;e&&e!==Object.prototype;){if(H.includes(e.constructor))return!1;e=Object.getPrototypeOf(e)}return e===Object.prototype}function _(t){return typeof t?.[Symbol.iterator]=="function"}var G=new WeakMap,u=Symbol("STATE_SOURCE");function ue(t,...e){let n=p(()=>z(t)),o=e.reduce((s,a)=>r(r({},s),typeof a=="function"?a(s):a),n),c=t[u],i=Reflect.ownKeys(t[u]);for(let s of Reflect.ownKeys(o))if(i.includes(s)){let a=s;n[a]!==o[a]&&c[a].set(o[a])}q(t)}function z(t){let e=t[u];return Reflect.ownKeys(t[u]).reduce((n,o)=>{let c=e[o]();return f(r({},n),{[o]:c})},{})}function $(t){return G.get(t[u])||[]}function q(t){let e=$(t);for(let n of e){let o=p(()=>z(t));n(o)}}function fe(...t){let e=[...t],n=typeof e[0]=="function"?{}:e.shift(),o=e;return(()=>{class i{constructor(){let a=o.reduce((b,L)=>L(b),B()),{stateSignals:y,props:g,methods:h,hooks:d}=a,S=r(r(r({},y),g),h);this[u]=a[u];for(let b of Reflect.ownKeys(S))this[b]=S[b];let{onInit:R,onDestroy:D}=d;R&&R(),D&&m(j).onDestroy(D)}static \u0275fac=function(y){return new(y||i)};static \u0275prov=P({token:i,factory:i.\u0275fac,providedIn:n.providedIn||null})}return i})()}function B(){return{[u]:{},stateSignals:{},props:{},methods:{},hooks:{}}}function V(t){return e=>{let n=t(r(r(r({[u]:e[u]},e.stateSignals),e.props),e.methods));return Reflect.ownKeys(n),f(r({},e),{props:r(r({},e.props),n)})}}function le(t){return V(e=>{let n=t(e);return Reflect.ownKeys(n).reduce((c,i)=>{let s=n[i];return f(r({},c),{[i]:l(s)?s:I(s)})},{})})}function de(t){return e=>{let n=r(r(r({[u]:e[u]},e.stateSignals),e.props),e.methods),o=typeof t=="function"?t(n):t,c=i=>{let s=o[i],a=e.hooks[i];return s?()=>{a&&a(),s(n)}:a};return f(r({},e),{hooks:{onInit:c("onInit"),onDestroy:c("onDestroy")}})}}function pe(t){return e=>{let n=t(r(r(r({[u]:e[u]},e.stateSignals),e.props),e.methods));return Reflect.ownKeys(n),f(r({},e),{methods:r(r({},e.methods),n)})}}function ye(t){return e=>{let n=typeof t=="function"?t():t,o=Reflect.ownKeys(n);let c=e[u],i={};for(let s of o)c[s]=O(n[s]),i[s]=F(c[s]);return f(r({},e),{stateSignals:r(r({},e.stateSignals),i)})}}function Y(t,e){e?.injector||x(Y);let n=e?.injector??m(w),o=new k,c=t(o).subscribe();n.get(j).onDestroy(()=>c.unsubscribe());let i=(s,a)=>{if(J(s))return o.next(s),{destroy:v};let y=N(),g=a?.injector??y??n;if(l(s)){let d=M(()=>{let S=s();p(()=>o.next(S))},{injector:g});return c.add({unsubscribe:()=>d.destroy()}),d}let h=s.subscribe(d=>o.next(d));return c.add(h),g!==n&&g.get(j).onDestroy(()=>h.unsubscribe()),{destroy:()=>h.unsubscribe()}};return i.destroy=c.unsubscribe.bind(c),i}function J(t){return!l(t)&&!E(t)}function N(){try{return m(w)}catch{return}}export{oe as a,ue as b,fe as c,le as d,de as e,pe as f,ye as g,Y as h};
