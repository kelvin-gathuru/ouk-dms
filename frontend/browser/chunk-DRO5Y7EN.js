import{a as je,b as ze}from"./chunk-JZMP2LQQ.js";import{a as Ne,b as Pe,c as $e}from"./chunk-PJWKAJON.js";import{a as We}from"./chunk-47YH7K5Q.js";import{a as Ge}from"./chunk-C5E2LXAD.js";import{b as He}from"./chunk-D63AZ2OX.js";import{a as Ye}from"./chunk-FYSR42NU.js";import"./chunk-W6Y3OYFO.js";import{a as Ue}from"./chunk-DP5AXSVW.js";import{a as Qe}from"./chunk-MUB3U2II.js";import{a as se,b as le,c as ce,d as de}from"./chunk-AO6AHHEQ.js";import{a as Fe}from"./chunk-SBYXUONV.js";import{a as De}from"./chunk-XCFLXYBY.js";import"./chunk-3VFDPVPY.js";import{a as we}from"./chunk-VHQBXA4M.js";import"./chunk-DBWWD6JI.js";import{a as be}from"./chunk-E4NKSOB7.js";import{a as xe}from"./chunk-NHBDANCD.js";import"./chunk-D6HICPES.js";import"./chunk-KK3LA7D5.js";import"./chunk-PVDG46DZ.js";import{a as Le}from"./chunk-NUIAS2S4.js";import"./chunk-DD7TOTAW.js";import{b as fe}from"./chunk-ZPADZQPI.js";import"./chunk-I43MH25B.js";import"./chunk-OHUA35YV.js";import{c as Ie}from"./chunk-2OJALU77.js";import"./chunk-BJ2ZHXLF.js";import{a as Se}from"./chunk-APWCXNU6.js";import"./chunk-6B3EO7HE.js";import{a as pe}from"./chunk-6GBRFDEJ.js";import"./chunk-KBYUC6BL.js";import"./chunk-7UZYWCAJ.js";import"./chunk-55DV7QCW.js";import"./chunk-SJIWHW3R.js";import"./chunk-ZL3HBFEV.js";import"./chunk-PT2JM3JA.js";import"./chunk-4U6IWAJM.js";import"./chunk-73AGG5TT.js";import{b as Oe}from"./chunk-BEIMTKK4.js";import{a as ye,b as Ve}from"./chunk-YCBFVA3Y.js";import{a as he}from"./chunk-ZXWR2MAY.js";import"./chunk-G4LST2RF.js";import"./chunk-F2N2VWHU.js";import"./chunk-AHHITDV2.js";import"./chunk-QPRQJRAS.js";import{c as Be}from"./chunk-PJSVLHWR.js";import{a as Ee}from"./chunk-546GNQSA.js";import{d as ee,f as te}from"./chunk-2DXU6Z77.js";import{b as ve}from"./chunk-WC3ZMFX5.js";import{b as ge}from"./chunk-UFOTACYY.js";import{a as Ce}from"./chunk-RKRBEXQJ.js";import{a as _e}from"./chunk-C3OPHOKD.js";import{a as Re,b as Ae,e as Me}from"./chunk-F3ENXN4Q.js";import{D as Te,E as ke}from"./chunk-KYSGX4IW.js";import"./chunk-LCPYESOB.js";import{e as J,k as X}from"./chunk-BFSIXXTJ.js";import{a as re,b as ae}from"./chunk-P6E4AR6Q.js";import{D as Z,ta as ie,ua as oe,va as ne}from"./chunk-GDJX5AXE.js";import{Ca as f,Da as x,Db as u,Eb as h,Ec as q,Fb as R,G as N,Ga as E,Ha as y,Ia as m,Ja as r,Ka as a,La as b,Pa as W,Pc as me,Qa as G,R as P,Rc as ue,Sa as g,U as $,Ua as C,W as s,Wa as c,eb as k,ga as U,i as _,jb as l,ka as H,kb as D,lb as p,ma as w,p as v,q as S,sb as Q,tb as j,ub as z,vb as K,xb as I,za as Y,zb as V}from"./chunk-KZMFGXDY.js";import{I as T,Ja as L,_ as B,za as O}from"./chunk-W3TJXGK4.js";import{p as M}from"./chunk-H5HZ6YB3.js";var qe=()=>["name","asc"],Je=()=>["RESTORE_FOLDER","DELETE_CATEGORY"],Xe=()=>["CREATE_SHAREABLE_LINK","DOWNLOAD_DOCUMENT","VIEW_VERSION_HISTORY","SEND_EMAIL","DELETE_DOCUMENT"],A=(o,t)=>t.id;function Ze(o,t){if(o&1){let e=g();r(0,"a",29),C("click",function(){v(e);let n=c();return S(n.onHomeClick())}),r(1,"span",30),l(2," home "),a(),l(3),u(4,"translate"),a(),r(5,"mat-icon",31),l(6,"arrow_right"),a()}if(o&2){let e=c();m("dir",e.langDir),s(3),p(" ",h(4,2,"HOME")," ")}}function et(o,t){if(o&1&&(r(0,"span",16)(1,"span",30),l(2," home "),a(),l(3),u(4,"translate"),a()),o&2){let e=c();m("dir",e.langDir),s(3),p(" ",h(4,2,"HOME")," ")}}function tt(o,t){if(o&1){let e=g();r(0,"button",33),C("click",function(){v(e);let n=c().$implicit,d=c();return S(d.onFolderClickFromPath(n))}),l(1),a(),r(2,"mat-icon",31),l(3,"arrow_right"),a()}if(o&2){let e=c().$implicit,i=c();m("dir",i.langDir)("title",e.name),s(),p(" ",e.name," ")}}function it(o,t){if(o&1&&(r(0,"span",32),l(1),a()),o&2){let e=c().$implicit,i=c();m("dir",i.langDir),s(),p(" ",e.name," ")}}function ot(o,t){if(o&1&&f(0,tt,4,3)(1,it,2,2,"span",32),o&2){let e=t.$index,i=t.$count;x(e!==i-1?0:1)}}function nt(o,t){o&1&&(r(0,"span",35)(1,"span",42),b(2,"img",43),a()())}function rt(o,t){o&1&&(r(0,"span",36),l(1," folder "),a())}function at(o,t){if(o&1&&(r(0,"button",44)(1,"mat-icon",45),l(2,"more_vert"),a()()),o&2){c();let e=k(20);m("matMenuTriggerFor",e)}}function st(o,t){if(o&1){let e=g();r(0,"button",46),C("click",function(){v(e);let n=c().$implicit,d=c(2);return S(d.restoreFolder(n))}),r(1,"mat-icon"),l(2,"restore_from_trash"),a(),l(3),u(4,"translate"),a()}o&2&&(s(3),p(" ",h(4,1,"RESTORE")," "))}function lt(o,t){if(o&1){let e=g();r(0,"button",47),C("click",function(){v(e);let n=c().$implicit,d=c(2);return S(d.deleteFolder(n))}),r(1,"mat-icon"),l(2,"delete"),a(),l(3),u(4,"translate"),a()}o&2&&(s(3),p(" ",h(4,1,"DELETE")," "))}function ct(o,t){if(o&1){let e=g();r(0,"tr")(1,"td")(2,"a",34),C("click",function(){let n=v(e).$implicit,d=c(2);return S(d.onFolderClick(n))}),f(3,nt,3,0,"span",35)(4,rt,2,0,"span",36),r(5,"span",37),l(6),a()()(),b(7,"td")(8,"td"),r(9,"td")(10,"span",38),l(11),a()(),r(12,"td")(13,"span",38),l(14),u(15,"utcToLocalTime"),a()(),r(16,"td"),W(17),w(18,at,3,1,"button",39),r(19,"mat-menu",null,0),w(21,st,5,3,"button",40)(22,lt,5,3,"button",41),a(),G(),a()()}if(o&2){let e=t.$implicit;s(3),x(e.isShared?3:4),s(3),p(" ",e.name," "),s(5),D(e.createdUserName),s(3),p("",R(15,7,e.createdDate,"short")," "),s(4),m("hasClaim",V(10,Je)),s(3),m("hasClaim","RESTORE_FOLDER"),s(),m("hasClaim","DELETE_CATEGORY")}}function dt(o,t){if(o&1&&E(0,ct,23,11,"tr",null,A),o&2){let e=c();y(e.archiveFoldersViewStore.sortedCategories())}}function mt(o,t){if(o&1&&(r(0,"span",51),u(1,"translate"),r(2,"mat-icon"),l(3,"activity"),a()()),o&2){c();let e=z(8);m("matTooltip",I("",h(1,3,"CURRENT_WORKFLOW"),"-",e))}}function ut(o,t){if(o&1&&(r(0,"span",51),u(1,"translate"),u(2,"translate"),r(3,"mat-icon"),l(4,"edit"),a()()),o&2){let e=c().$implicit;m("matTooltip",I("",h(1,4,"SIGN_BY"),"-",e.signBy)),Y("aria-label",h(2,6,"SIGN_BY"))}}function pt(o,t){if(o&1&&(r(0,"button",59)(1,"mat-icon",45),l(2,"more_vert"),a()()),o&2){c();let e=k(25),i=c(2);m("dir",i.langDir)("matMenuTriggerFor",e)}}function ht(o,t){if(o&1){let e=g();r(0,"button",60),C("click",function(){v(e);let n=c().$implicit,d=c(2);return S(d.onCreateShareableLink(n))}),r(1,"mat-icon"),l(2,"link"),a(),l(3),u(4,"translate"),a()}if(o&2){let e=c(3);m("dir",e.langDir),s(3),p(" ",h(4,2,"GET_SHAREABLE_LINK")," ")}}function _t(o,t){if(o&1){let e=g();r(0,"button",60),C("click",function(){v(e);let n=c().$implicit,d=c(2);return S(d.downloadDocument(n))}),r(1,"mat-icon"),l(2,"download"),a(),l(3),u(4,"translate"),a()}if(o&2){let e=c(3);m("dir",e.langDir),s(3),p(" ",h(4,2,"DOWNLOAD")," ")}}function Ct(o,t){if(o&1){let e=g();r(0,"button",61),C("click",function(){v(e);let n=c().$implicit,d=c(2);return S(d.onVersionHistoryClick(n))}),r(1,"mat-icon"),l(2," history"),a(),l(3),u(4,"translate"),a()}if(o&2){let e=c(3);m("dir",e.langDir),s(3),p(" ",h(4,2,"VERSION_HISOTRY")," ")}}function vt(o,t){if(o&1){let e=g();r(0,"button",60),C("click",function(){v(e);let n=c().$implicit,d=c(2);return S(d.sendEmail(n))}),r(1,"mat-icon"),l(2,"forward_to_inbox"),a(),l(3),u(4,"translate"),a()}if(o&2){let e=c(3);m("dir",e.langDir),s(3),p(" ",h(4,2,"SEND_EMAIL")," ")}}function St(o,t){if(o&1){let e=g();r(0,"button",62),C("click",function(){v(e);let n=c().$implicit,d=c(2);return S(d.deleteDocument(n))}),r(1,"mat-icon"),l(2,"delete"),a(),l(3),u(4,"translate"),a()}if(o&2){let e=c(3);m("dir",e.langDir),s(3),p(" ",h(4,2,"DELETE")," ")}}function gt(o,t){if(o&1){let e=g();r(0,"tr")(1,"td")(2,"a",48),C("click",function(){let n=v(e).$implicit,d=c(2);return S(d.onDocumentView(n))}),b(3,"img",49),u(4,"imagePath"),l(5),a()(),r(6,"td")(7,"div",50),Q(8),u(9,"workflowCombine"),f(10,mt,4,5,"span",51),f(11,ut,5,8,"span",51),a()(),r(12,"td")(13,"span",52),l(14),a()(),r(15,"td")(16,"span",38),l(17),a()(),r(18,"td")(19,"span",38),l(20),u(21,"utcToLocalTime"),a()(),r(22,"td"),w(23,pt,3,2,"button",53),r(24,"mat-menu",54,1),w(26,ht,5,4,"button",55)(27,_t,5,4,"button",56)(28,Ct,5,4,"button",57)(29,vt,5,4,"button",56)(30,St,5,4,"button",58),a()()()}if(o&2){let e=t.$implicit,i=c(2);s(3),m("src",K(h(4,16,e.extension)),P)("alt",e.name),s(2),p(" ",e.name," "),s(3);let n=j(h(9,18,e.workflowsDetail));s(2),x(n?10:-1),s(),x(e.signBy?11:-1),s(3),p(" ",e.documentNumber," \xA0\xA0 "),s(3),p(" ",e.createdBy),s(3),p(" ",R(21,21,e.createdDate,"short")," "),s(3),m("hasClaim",V(24,Xe)),s(),m("dir",i.langDir),s(2),m("hasClaim","CREATE_SHAREABLE_LINK"),s(),m("hasClaim","DOWNLOAD_DOCUMENT"),s(),m("hasClaim","VIEW_VERSION_HISTORY"),s(),m("hasClaim","SEND_EMAIL"),s(),m("hasClaim","DELETE_DOCUMENT")}}function ft(o,t){if(o&1&&E(0,gt,31,25,"tr",null,A),o&2){let e=c();y(e.archiveFoldersViewStore.sortedDocuments())}}function xt(o,t){if(o&1&&(r(0,"tr")(1,"td",63)(2,"p",64),l(3),u(4,"translate"),a()()()),o&2){let e=c();s(2),m("dir",e.langDir),s(),p(" ",h(4,2,"NO_FILES_OR_FOLDERS_FOUND")," ")}}function bt(o,t){o&1&&(r(0,"div",27),l(1," Loading... "),a())}function Ft(o,t){o&1&&(r(0,"div",28),b(1,"mat-progress-spinner",65),a())}var Ke=class o extends he{foldersViewStore=_(be);assignFoldersViewStore=_(Fe);activatedRoute=_(J);overlay=_(Ie);dialog=_(ee);documentStore=_(fe);categoryService=_(xe);categories=[];allCategories=[];clonerService=_(_e);documentStatuses=[];documentStatusService=_(Ye);securityService=_(Ce);clientStore=_(He);documentService=_(Se);selectedDocument;commonService=_(ge);toastrService=_(ve);documentChunks=[];contentType="";documentChunkDownloads=[];commonDialogService=_(Ue);archiveDocumentsStore=_(De);archiveFoldersViewStore=_(we);isLoadingResults=!1;mode="indeterminate";documentResource=this.documentStore.documentResourceParameter();onScroll(){window.innerHeight+window.scrollY>=document.body.offsetHeight-100&&this.loadDocument()}trackByFn(t,e){return e.id?e.id:""}trackByCategoryPath(t,e){return e.id?e.id:""}ngOnInit(){this.archiveFoldersViewStore.categories().length===0&&this.archiveFoldersViewStore.loadCategoriesById(""),this.getCategories(),this.getDocumentStatus()}getDocumentStatus(){this.documentStatusService.getDocumentStatuss().subscribe(t=>{t&&t.length>0&&(this.documentStatuses=[...t])})}getCategories(){this.categoryService.getAllCategories().subscribe(t=>{this.categories=[...t],this.categories.filter(i=>i.parentId==null).forEach((i,n)=>{i.deafLevel=0,i.index=n*Math.pow(.1,i.deafLevel),i.displayName=i.name,this.allCategories.push(i),this.setDeafLevel(i)}),this.allCategories=this.clonerService.deepClone(this.allCategories)})}setDeafLevel(t){return t?.children&&t.children.length>0&&t.children.map((e,i)=>{e.displayName=t.displayName+" > "+e.name,e.deafLevel=t?.deafLevel?t?.deafLevel+1:0,e.index=(t?.index?t.index:0)+i*Math.pow(.1,e.deafLevel),this.allCategories.push(e),this.setDeafLevel(e)}),t}onFolderClick(t){if(t.id===this.archiveFoldersViewStore.selectedCategoryId())return;let e=this.archiveFoldersViewStore.documentResourceParameter();e.categoryId=t.id,this.archiveFoldersViewStore.loadCategoriesById(t.id?t.id:""),this.archiveFoldersViewStore.setDocumentsEmpty(),e.skip=0,this.archiveFoldersViewStore.loadByQuery(e),this.archiveFoldersViewStore.addCategoryPath(t)}onFolderClickFromPath(t){this.archiveFoldersViewStore.removeCategoryPath(t);let e=this.archiveFoldersViewStore.documentResourceParameter();e.categoryId=t.id,this.archiveFoldersViewStore.loadCategoriesById(t.id?t.id:""),this.archiveFoldersViewStore.setDocumentsEmpty(),e.skip=0,this.archiveFoldersViewStore.loadByQuery(e)}onDocumentView(t){return M(this,null,function*(){let e=t.url?.split(".")[1],i={documentId:t.id,name:t.name,url:t.url,extension:t.extension?t.extension:e,isVersion:!1,isFromPublicPreview:!1,isPreviewDownloadEnabled:this.securityService.hasClaim("archive_documents_download_document"),isFileRequestDocument:!1,isSignatureExists:t.isSignatureExists,isChunk:t.isChunk,documentNumber:t.documentNumber},{BasePreviewComponent:n}=yield import("./chunk-BJ7BM7KC.js");this.overlay.open(n,{position:"center",origin:"global",panelClass:["file-preview-overlay-container","white-background"],data:i})})}sortData(t){if(t.active)if(t.active=="name"&&this.archiveFoldersViewStore.documents().length==0&&this.archiveFoldersViewStore.categories().length>0){let e=this.archiveFoldersViewStore.documentResourceParameter();e.orderBy=`${t.active} ${t.direction}`,this.archiveFoldersViewStore.setDocumentResource(e)}else if(this.archiveFoldersViewStore.documentResourceParameter().totalCount==this.archiveFoldersViewStore.documents().length){let e=this.archiveFoldersViewStore.documentResourceParameter();e.orderBy=`${t.active} ${t.direction}`,this.archiveFoldersViewStore.setDocumentResource(e)}else{this.archiveFoldersViewStore.setDocumentsEmpty();let e=this.archiveFoldersViewStore.documentResourceParameter();e.orderBy=`${t.active} ${t.direction}`,e.skip=0,this.archiveFoldersViewStore.loadByQuery(e)}}loadDocument(){if(this.archiveFoldersViewStore.isLoading()||this.archiveFoldersViewStore.documentResourceParameter().totalCount==this.archiveFoldersViewStore.documents().length)return;let t=this.archiveFoldersViewStore.documentResourceParameter();t.categoryId=this.archiveFoldersViewStore.selectedCategoryId(),t.skip=this.archiveFoldersViewStore.documents().length,this.archiveFoldersViewStore.loadByQuery(t)}onHomeClick(){this.archiveFoldersViewStore.setDocumentsEmpty(),this.archiveFoldersViewStore.removeCategoryPath(null),this.archiveFoldersViewStore.loadCategoriesById("")}onCreateShareableLink(t){this.sub$.sink=this.documentService.getDocumentShareableLink(t.id??"").subscribe(e=>{this.dialog.open(Ge,{width:"500px",data:{document:t,link:e}})})}addDocumentTrail(t,e){let i={documentId:t,operationName:e};this.documentStore.addDocumentAudit(i)}downloadDocument(t){if(this.selectedDocument=t,this.documentStore.setLoadingFlag(!0),t.isChunk)this.getAllDocumentChunks();else{let e=t.extension;e?.includes(".")||(e="."+e);let i={documentId:t.id,name:"",extension:t.extension?e:t.url?.split(".")[1],isVersion:!1,isFromPublicPreview:!1,isPreviewDownloadEnabled:!1,isFileRequestDocument:!1,isSignatureExists:!1,documentNumber:t.documentNumber};this.sub$.sink=this.commonService.downloadDocument(i).subscribe({next:n=>{if(n.type===q.Response)if(this.addDocumentTrail(t.id??"",8 .toString()),n.body){let d=new Blob([n.body],{type:n.body.type});this.downloadFile(d)}else this.toastrService.error(this.translationService.getValue("ERROR_WHILE_DOWNLOADING_DOCUMENT"))},error:n=>{this.toastrService.error(this.translationService.getValue("ERROR_WHILE_DOWNLOADING_DOCUMENT"))}})}}getAllDocumentChunks(){this.sub$.sink=this.commonService.getDocumentChunks(this.selectedDocument.id??"").subscribe({next:t=>{this.documentChunks=t,this.documentChunks.length>0&&this.startDownload()},error:t=>{this.toastrService.error(t.error.message)}})}startDownload(){let{chunkSize1:t,parallelCalls:e}=this.commonService.getNetworkSpeed(),i=[];for(let n=0;n<this.documentChunks.length;n++)i.push({chunkIndex:n,documentVersionId:this.documentChunks[n].documentVersionId});this.sub$.sink=T(i).pipe(O(e),L(n=>T(n).pipe(B(d=>this.downloadChunk(d.chunkIndex,d.documentVersionId),e)))).subscribe({next:n=>{this.contentType=n.contentType;let d=this.base64ToBlob(n.data,n.contentType);n.blobChunk=d,this.documentChunkDownloads.push(n)},complete:()=>this.mergeChunks(),error:n=>{this.documentStore.setLoadingFlag(!1),this.toastrService.error(this.translationService.getValue("ERROR_WHILE_DOWNLOADING_DOCUMENT")),console.error("Error downloading chunks",n)}})}base64ToBlob(t,e){let i=atob(t),n=new Array(i.length);for(let F=0;F<i.length;F++)n[F]=i.charCodeAt(F);let d=new Uint8Array(n);return new Blob([d],{type:e})}downloadChunk(t,e){return this.commonService.downloadDocumentChunk(e,t)}mergeChunks(){let t=this.documentChunkDownloads.sort((i,n)=>i.chunkIndex-n.chunkIndex).map(i=>i.blobChunk).filter(i=>i!==void 0),e=new Blob(t,{type:this.contentType});this.documentStore.setLoadingFlag(!1),this.addDocumentTrail(this.selectedDocument.id??"",8 .toString()),this.downloadFile(e)}downloadFile(t){this.documentStore.setLoadingFlag(!1);let e=document.createElement("a");e.setAttribute("style","display:none;"),document.body.appendChild(e),e.download=this.selectedDocument.name,e.href=URL.createObjectURL(t),e.target="_blank",e.click(),document.body.removeChild(e)}onVersionHistoryClick(t){let e=this.clonerService.deepClone(t);this.sub$.sink=this.documentService.getDocumentVersion(t.id??"").subscribe(i=>{e.documentVersions=i,this.dialog.open(We,{maxWidth:"95vw",panelClass:"full-width-dialog",data:Object.assign({},e)}).afterClosed().subscribe(d=>{d&&(this.documentStore.loadDocuments(),this.archiveFoldersViewStore.selectedCategoryId()==t.categoryId&&(this.archiveFoldersViewStore.setDocumentsEmpty(),this.archiveFoldersViewStore.loadDocumentsByCategory(this.archiveFoldersViewStore.selectedCategoryId())))})})}sendEmail(t){this.dialog.open(Qe,{data:t,width:"80vw",maxHeight:"80vh"})}archiveDocument(t){this.sub$.sink=this.commonDialogService.deleteConfirmtionDialog(`${this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_ARCHIVE")} ${t.name}`).subscribe(e=>{e&&(this.sub$.sink=this.documentService.archiveDocument(t.id??"").subscribe(()=>{this.addDocumentTrail(t.id??"",12 .toString()),this.toastrService.success(this.translationService.getValue("DOCUMENT_ARCHIVE_SUCCESSFULLY")),this.archiveFoldersViewStore.setDocumentsEmpty(),this.archiveFoldersViewStore.loadDocumentsByCategory(this.archiveFoldersViewStore.selectedCategoryId()),this.archiveDocumentsStore.getArchiveDocuments()}))})}restoreFolder(t){this.sub$.sink=this.commonDialogService.deleteConfirmtionDialog(`${this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_RESTORE")} ${t.name}`).subscribe(e=>{e&&(this.sub$.sink=this.categoryService.restoreFolder(t.id??"").subscribe({next:()=>{this.toastrService.success(this.translationService.getValue("CATEGORY_RESTORE_SUCCESSFULLY")),this.archiveFoldersViewStore.loadCategoriesById(this.archiveFoldersViewStore.selectedCategoryId()),(this.foldersViewStore.selectedCategoryId()==t.id||this.foldersViewStore.selectedCategoryId()==""&&t.parentId==null)&&(this.foldersViewStore.loadCategoriesById(this.foldersViewStore.selectedCategoryId()),this.foldersViewStore.loadDocuments()),(this.assignFoldersViewStore.selectedCategoryId()==t.id||this.assignFoldersViewStore.selectedCategoryId()==""&&t.parentId==null)&&(this.assignFoldersViewStore.loadCategoriesById(this.assignFoldersViewStore.selectedCategoryId()),this.assignFoldersViewStore.loadDocuments()),this.archiveDocumentsStore.loadByQuery(this.archiveDocumentsStore.documentResourceParameter()),this.documentStore.loadDocuments()},error:i=>{let n=this.translationService.getValue("ERROR_WHILE_RESTORING_CATEGORY");i?.error?.errors&&Array.isArray(i.error.errors)&&i.error.errors.length>0&&(n=i.error.errors.join(", ")),this.toastrService.error(n)}}))})}deleteDocument(t){this.sub$.sink=this.commonDialogService.deleteConfirmtionDialog(`${this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")} ${t.name}`).subscribe(e=>{e&&(this.sub$.sink=this.documentService.deleteDocument(t.id??"").subscribe(()=>{this.addDocumentTrail(t.id??"",4 .toString()),this.toastrService.success(this.translationService.getValue("DOCUMENT_DELETED_SUCCESSFULLY")),this.archiveDocumentsStore.loadByQuery(this.archiveDocumentsStore.documentResourceParameter()),this.archiveFoldersViewStore.loadByQuery(this.archiveFoldersViewStore.documentResourceParameter())}))})}deleteFolder(t){this.commonDialogService.deleteConfirmtionDialog(this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")).subscribe(e=>{e&&this.categoryService.delete(t.id??"").subscribe(i=>{this.toastrService.success(this.translationService.getValue("CATEGORY_DELETED_SUCCESSFULLY")),this.archiveFoldersViewStore.loadCategoriesById(this.archiveFoldersViewStore.selectedCategoryId()),this.archiveDocumentsStore.loadByQuery(this.archiveDocumentsStore.documentResourceParameter()),this.archiveFoldersViewStore.loadByQuery(this.archiveFoldersViewStore.documentResourceParameter()),this.getCategories()})})}onRefresh(){this.archiveFoldersViewStore.setDocumentsEmpty(),this.archiveFoldersViewStore.loadCategoriesById(this.archiveFoldersViewStore.selectedCategoryId()),this.archiveFoldersViewStore.loadDocuments()}static \u0275fac=(()=>{let t;return function(i){return(t||(t=N(o)))(i||o)}})();static \u0275cmp=U({type:o,selectors:[["app-archive-folders"]],hostBindings:function(e,i){e&1&&C("scroll",function(){return i.onScroll()},$)},features:[H],decls:52,vars:32,consts:[["folderMenu","matMenu"],["menu","matMenu"],[1,"content"],[1,"container-fluid"],[1,"row","align-items-center"],[1,"col-md-6","col","mb-2"],[1,"mb-0","page-title"],[3,"code"],[1,"col-md-6","col-auto","d-flex","justify-content-end","mb-2"],["matButton","filled",1,"error",3,"click"],[1,"medium-icon","fs-5","align-middle"],[1,"d-none","d-lg-inline","ms-1"],["appearance","outlined"],[1,"row","align-items-center","justify-content-between"],[1,"col-md-auto","col-sm-auto"],[1,"d-flex","align-items-center",2,"height","30px"],["role","button",1,"d-flex","align-items-center","pl-3","height-30","fw-bolder",3,"dir"],[1,"row"],[1,"col"],[1,"table-responsive"],[1,"table","table-pos","table_color",3,"dir"],["matSort","","matSortDisableClear","",3,"matSortChange","matSortActive","matSortDirection"],["mat-sort-header","name",2,"width","50%"],[2,"width","5%"],["mat-sort-header","documentNumber",2,"width","10%"],["mat-sort-header","createdBy",2,"width","15%"],["mat-sort-header","createdDate",2,"width","15%"],[1,"loading-text"],[1,"spinner-container"],["role","button",1,"d-flex","align-items-center","pl-3","height-30","text-decoration-none",3,"click","dir"],[1,"material-icons","folder_shared","text-primary"],[1,"material-icons-outlined","small-arrow","align-middle"],[1,"fw-bolder",3,"dir"],["type","button",1,"btn","btn-link","text-decoration-none",3,"click","dir","title"],["role","button",1,"d-flex","align-items-center","pl-3","height-30","text-decoration-none",3,"click"],[1,"material-icons"],[1,"material-icons","folder_shared"],[1,"m-1"],[1,"d-flex","align-items-center","pl-3","height-30"],["matMiniFab","","class","primary",3,"matMenuTriggerFor",4,"hasClaim"],["class","btn btn-light btn-sm","mat-menu-item","","type","button",3,"click",4,"hasClaim"],["mat-menu-item","","type","button",3,"click",4,"hasClaim"],[1,"folder_shared"],["src","/images/share-icon.svg",1,"shared-icon"],["matMiniFab","",1,"primary",3,"matMenuTriggerFor"],[1,"fs-4","align-middle"],["mat-menu-item","","type","button",1,"btn","btn-light","btn-sm",3,"click"],["mat-menu-item","","type","button",3,"click"],["role","button",1,"d-flex","align-items-center","pl-3","text-decoration-none",3,"click"],["loading","lazy",1,"me-2","list-img",3,"src","alt"],[1,"d-flex"],[3,"matTooltip"],[1,"d-flex","align-items-center","pl-3","document-number","height-30"],["matMiniFab","","class","primary",3,"dir","matMenuTriggerFor",4,"hasClaim"],[3,"dir"],["mat-menu-item","","class","btn btn-light btn-sm","type","button",3,"dir","click",4,"hasClaim"],["class","btn btn-light btn-sm","mat-menu-item","","type","button",3,"dir","click",4,"hasClaim"],["class","btn btn-light btn-sm","mat-menu-item","",3,"dir","click",4,"hasClaim"],["mat-menu-item","","type","button",3,"dir","click",4,"hasClaim"],["matMiniFab","",1,"primary",3,"dir","matMenuTriggerFor"],["mat-menu-item","","type","button",1,"btn","btn-light","btn-sm",3,"click","dir"],["mat-menu-item","",1,"btn","btn-light","btn-sm",3,"click","dir"],["mat-menu-item","","type","button",3,"click","dir"],["colspan","6"],[1,"text-danger",3,"dir"],["mode","indeterminate","diameter","60","strokeWidth","5"]],template:function(e,i){if(e&1){let n=g();r(0,"section",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"span",6),l(5),u(6,"translate"),a(),b(7,"app-page-help-text",7),a(),r(8,"div",8)(9,"button",9),C("click",function(){return v(n),S(i.onRefresh())}),r(10,"mat-icon",10),l(11,"refresh"),a(),r(12,"span",11),l(13),u(14,"translate"),a()()()(),r(15,"mat-card",12)(16,"mat-card-content")(17,"div",13)(18,"div",14)(19,"div",15),f(20,Ze,7,4)(21,et,5,4,"span",16),E(22,ot,2,1,null,null,A),a()()(),r(24,"div",17)(25,"div",18)(26,"div",19)(27,"table",20)(28,"thead",21),C("matSortChange",function(F){return v(n),S(i.sortData(F))}),r(29,"tr")(30,"th",22),l(31),u(32,"translate"),a(),b(33,"th",23),r(34,"th",24),l(35),u(36,"translate"),a(),r(37,"th",25),l(38),u(39,"translate"),a(),r(40,"th",26),l(41),u(42,"translate"),a(),r(43,"th",23),l(44),u(45,"translate"),a()()(),r(46,"tbody"),f(47,dt,2,0),f(48,ft,2,0),f(49,xt,5,4,"tr"),a()(),f(50,bt,2,0,"div",27),a()()()()()()(),f(51,Ft,2,0,"div",28)}if(e&2){s(5),D(h(6,17,"ARCHIVE_FOLDERS")),s(2),m("code","ARCHIVE_FOLDERS"),s(6),D(h(14,19,"REFRESH")),s(7),x(i.archiveFoldersViewStore.newCategoryPath().length>0?20:21),s(2),y(i.archiveFoldersViewStore.newCategoryPath()),s(5),m("dir",i.langDir);let n=i.archiveFoldersViewStore.documentResourceParameter()&&i.archiveFoldersViewStore.documentResourceParameter().orderBy?i.archiveFoldersViewStore.documentResourceParameter().orderBy.split(" "):V(31,qe);s(),m("matSortActive",n[0])("matSortDirection",n[1]==="asc"?"asc":"desc"),s(3),p(" ",h(32,21,"NAME")," "),s(4),p(" ",h(36,23,"DOCUMENT_NO")," "),s(3),p(" ",h(39,25,"CREATED_BY")," "),s(3),p(" ",h(42,27,"CREATED_AT")," "),s(3),D(h(45,29,"ACTIONS")),s(3),x(i.archiveFoldersViewStore.categories()&&i.archiveFoldersViewStore.categories().length>0?47:-1),s(),x(i.archiveFoldersViewStore.sortedDocuments().length>0?48:-1),s(),x(!i.archiveFoldersViewStore.isLoading()&&i.archiveFoldersViewStore.categories().length===0&&i.archiveFoldersViewStore.documents().length===0?49:-1),s(),x(i.archiveFoldersViewStore.isLoading()?50:-1),s(),x(i.archiveFoldersViewStore.isLoading()?51:-1)}},dependencies:[ke,te,Z,$e,Ne,Pe,Le,Oe,Te,Ve,ye,ae,re,ne,ie,oe,ue,de,le,se,ce,X,Ee,Be,Me,Re,Ae,me,ze,je,pe],styles:[".list-img[_ngcontent-%COMP%]{width:30px}  .mat-mdc-icon-button .mat-mdc-button-touch-target{height:30px!important}.height-30[_ngcontent-%COMP%]{height:30px!important}.folder_shared[_ngcontent-%COMP%]{color:#f2d300;font-size:30px;margin-top:0;float:left}.text-decoration-none[_ngcontent-%COMP%]{text-decoration:none}.loading-text[_ngcontent-%COMP%]{position:fixed;bottom:10px;left:50%;transform:translate(-50%);background:#000000b3;color:#fff;padding:10px 20px;border-radius:5px;font-size:16px;text-align:center}  .mat-mdc-tooltip{background-color:#3f51b5!important;color:#fff!important}.shared-icon[_ngcontent-%COMP%]{max-height:21px;margin-top:-14px}"]})};export{Ke as ArchiveFoldersComponent};
