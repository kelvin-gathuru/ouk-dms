import{a as et}from"./chunk-Q64ABPSN.js";import{a as K}from"./chunk-XAYCIFZD.js";import{a as rt}from"./chunk-SZELL2KP.js";import{a as lt}from"./chunk-WYJRAJHK.js";import{a as ot}from"./chunk-JTG74WW7.js";import{a as at}from"./chunk-JUFSZQR3.js";import{b as it}from"./chunk-RSOKOSFJ.js";import{a as mt}from"./chunk-KXR3ZNF4.js";import{b as Q}from"./chunk-ZBYQRGLJ.js";import{b as tt}from"./chunk-D63AZ2OX.js";import{a as nt}from"./chunk-FYSR42NU.js";import{a as Y}from"./chunk-E4NKSOB7.js";import{a as Me}from"./chunk-NHBDANCD.js";import"./chunk-C2FLN6YV.js";import"./chunk-KK3LA7D5.js";import"./chunk-PVDG46DZ.js";import{a as qe}from"./chunk-NUIAS2S4.js";import{a as ae}from"./chunk-DD7TOTAW.js";import{b as ye}from"./chunk-ZPADZQPI.js";import"./chunk-I43MH25B.js";import"./chunk-OHUA35YV.js";import{a as $}from"./chunk-APWCXNU6.js";import{a as We}from"./chunk-3NQBK7XS.js";import{a as Qe,b as Ke}from"./chunk-55DV7QCW.js";import{a as Xe,b as Je,c as Ze}from"./chunk-SJIWHW3R.js";import"./chunk-ZL3HBFEV.js";import"./chunk-4U6IWAJM.js";import"./chunk-73AGG5TT.js";import{b as je}from"./chunk-BEIMTKK4.js";import{a as z,b as H}from"./chunk-YCBFVA3Y.js";import{a as q}from"./chunk-ZXWR2MAY.js";import"./chunk-G4LST2RF.js";import"./chunk-NJY6F3LT.js";import{a as Ye,b as ze,c as He}from"./chunk-GYIDN45C.js";import"./chunk-G5E2PA5H.js";import"./chunk-DXL7FQB3.js";import"./chunk-F2N2VWHU.js";import{d as $e}from"./chunk-AHHITDV2.js";import"./chunk-QPRQJRAS.js";import{c as Ge}from"./chunk-PJSVLHWR.js";import{a as Ie}from"./chunk-546GNQSA.js";import{d as ve}from"./chunk-2DXU6Z77.js";import{b as W}from"./chunk-WC3ZMFX5.js";import{b as Ee}from"./chunk-UFOTACYY.js";import"./chunk-RKRBEXQJ.js";import{a as Te}from"./chunk-C3OPHOKD.js";import{a as Oe,b as Ue,e as Le}from"./chunk-F3ENXN4Q.js";import{C as Re,E as Be,c as Fe,e as A,h as be,i as Pe,o as Ae,r as Ve,s as we,t as ke,u as Ne}from"./chunk-KYSGX4IW.js";import"./chunk-LCPYESOB.js";import{e as G,g as j}from"./chunk-BFSIXXTJ.js";import{a as Ce,b as Se}from"./chunk-P6E4AR6Q.js";import{ta as fe,va as he}from"./chunk-GDJX5AXE.js";import{$ as x,Ab as ne,Ca as f,Da as h,Db as s,Ea as se,Eb as d,Fa as R,Fb as ue,Ga as w,Ha as k,Ia as g,Ja as o,Ka as r,La as E,Pa as de,Pc as De,Qa as ce,Rc as xe,Sa as y,Ua as D,W as a,Wa as v,Yb as _e,eb as P,ga as U,i as V,jb as l,ka as L,kb as F,lb as p,ma as B,mb as O,oa as Z,p as C,pb as ee,pc as ge,q as S,qb as te,rb as ie,vb as b,yb as pe}from"./chunk-KZMFGXDY.js";import{I as J,Ja as le,_ as oe,_b as me,za as re}from"./chunk-W3TJXGK4.js";import{p as N}from"./chunk-H5HZ6YB3.js";var vt=i=>({"margin-left.px":i}),ft=i=>({color:i}),ht=(i,c)=>c.id;function Ct(i,c){i&1&&(o(0,"div",48),l(1),s(2,"translate"),r()),i&2&&(a(),p(" ",d(2,1,"DOCUMENT_IS_REQUIRED")," "))}function St(i,c){if(i&1&&(o(0,"div"),f(1,Ct,3,3,"div",48),r()),i&2){let e,n=v();a(),h(!((e=n.documentForm.get("url"))==null||e.errors==null)&&e.errors.required?1:-1)}}function Dt(i,c){i&1&&(o(0,"div",48),l(1),s(2,"translate"),r()),i&2&&(a(),p(" ",d(2,1,"DOCUMENT_TYPE_IS_NOT_ALLOW")," "))}function xt(i,c){if(i&1&&(o(0,"div"),f(1,Dt,3,3,"div",48),r()),i&2){let e,n=v();a(),h(!((e=n.documentForm.get("extension"))==null||e.errors==null)&&e.errors.required?1:-1)}}function Tt(i,c){i&1&&(o(0,"div",48),l(1),s(2,"translate"),r()),i&2&&(a(),p(" ",d(2,1,"NAME_IS_REQUIRED")," "))}function Et(i,c){if(i&1&&(o(0,"div"),f(1,Tt,3,3,"div",48),r()),i&2){let e,n=v();a(),h(!((e=n.documentForm.get("name"))==null||e.errors==null)&&e.errors.required?1:-1)}}function yt(i,c){if(i&1&&(o(0,"div",55)(1,"mat-icon",57),l(2,"folder"),r(),o(3,"b"),l(4),r()()),i&2){let e=v().$implicit;a(4),F(e.name)}}function Mt(i,c){if(i&1&&(o(0,"div",56)(1,"mat-icon",57),l(2,"folder"),r(),l(3),r()),i&2){let e=v().$implicit;g("matTooltip",e.name),a(3),p(" ",e.name," ")}}function It(i,c){if(i&1&&(o(0,"mat-option",22)(1,"div",54),f(2,yt,5,1,"div",55)(3,Mt,4,2,"div",56),r()()),i&2){let e=c.$implicit;g("value",e.id),a(),g("ngStyle",ne(3,vt,(e.deafLevel??0)*20)),a(),h(e.deafLevel==0?2:3)}}function Ft(i,c){if(i&1){let e=y();o(0,"button",58),D("click",function(){C(e);let t=v();return S(t.addFolder())}),o(1,"mat-icon",59),l(2,"add"),r()()}}function bt(i,c){i&1&&(o(0,"div",48),l(1),s(2,"translate"),r()),i&2&&(a(),p(" ",d(2,1,"CATEGORY_IS_REQUIRED")," "))}function Pt(i,c){if(i&1&&(o(0,"div"),f(1,bt,3,3,"div",48),r()),i&2){let e,n=v();a(),h(!((e=n.documentForm.get("categoryId"))==null||e.errors==null)&&e.errors.required?1:-1)}}function At(i,c){if(i&1&&(o(0,"mat-option",22),l(1),s(2,"storageType"),r()),i&2){let e=c.$implicit;g("value",e.id),a(),p(" ",ue(2,2,e.storageType,e.name)," ")}}function Vt(i,c){if(i&1&&(o(0,"mat-option",22)(1,"span",60),l(2),r()()),i&2){let e=c.$implicit;g("value",e.id),a(),g("ngStyle",ne(3,ft,e==null?null:e.colorCode)),a(),p(" ",e.name," ")}}function wt(i,c){if(i&1){let e=y();o(0,"button",58),D("click",function(){C(e);let t=v();return S(t.addDocumentStatus())}),o(1,"mat-icon",59),l(2,"add"),r()()}}function kt(i,c){if(i&1&&(o(0,"mat-option",22)(1,"span"),l(2),r()()),i&2){let e=c.$implicit;g("value",e.id),a(2),p(" ",e.companyName," ")}}function Nt(i,c){if(i&1){let e=y();o(0,"button",58),D("click",function(){C(e);let t=v();return S(t.addClient())}),o(1,"mat-icon",59),l(2,"add"),r()()}}function Rt(i,c){if(i&1&&(o(0,"span"),l(1),r()),i&2){let e=v(2);a(),p(" ",e.selectedRoles[0].name," ")}}function Bt(i,c){if(i&1&&(o(0,"span",62),l(1),r()),i&2){let e=v(2);a(),O(" (+",e.selectedRoles.length-1," ",e.selectedRoles.length===2?"other":"others",") ")}}function Ot(i,c){if(i&1&&(o(0,"mat-option",22),l(1),r()),i&2){let e=c.$implicit;g("value",e),a(),p(" ",e.name," ")}}function Ut(i,c){i&1&&(o(0,"div",48),l(1),s(2,"translate"),r()),i&2&&(a(),p(" ",d(2,1,"START_DATE_IS_REQURED")," "))}function Lt(i,c){i&1&&(o(0,"div",48),l(1),s(2,"translate"),r()),i&2&&(a(),p(" ",d(2,1,"END_DATE_IS_REQURED")," "))}function Gt(i,c){if(i&1){let e=y();o(0,"div",13)(1,"div",34)(2,"div",19),E(3,"input",66,1),s(5,"translate"),o(6,"div",67)(7,"button",68),D("click",function(){C(e);let t=P(11);return S(t.open())}),o(8,"mat-icon",69),l(9,"calendar_today"),r()()()(),E(10,"mat-datepicker",null,2),f(12,Ut,3,3,"div",48),r(),o(13,"div",34)(14,"div",19),E(15,"input",70),s(16,"translate"),o(17,"div",67)(18,"button",68),D("click",function(){C(e);let t=P(22);return S(t.open())}),o(19,"mat-icon",69),l(20,"calendar_today"),r()()()(),E(21,"mat-datepicker",null,3),f(23,Lt,3,3,"div",48),r()()}if(i&2){let e,n,t,m=P(11),u=P(22),_=v(3);a(3),g("placeholder",b(d(5,10,"CHOOSE_A_START_DATE")))("min",_.minDate)("matDatepicker",m),a(9),h((e=_.rolePermissionFormGroup.get("startDate"))!=null&&e.touched&&((e=_.rolePermissionFormGroup.get("startDate"))!=null&&e.hasError("required"))?12:-1),a(3),g("placeholder",b(d(16,12,"CHOOSE_A_END_DATE")))("min",(n=_.rolePermissionFormGroup.get("startDate"))==null?null:n.value)("matDatepicker",u),a(8),h((t=_.rolePermissionFormGroup.get("startDate"))!=null&&t.touched&&((t=_.rolePermissionFormGroup.get("endDate"))!=null&&t.hasError("required"))?23:-1)}}function jt(i,c){if(i&1){let e=y();o(0,"div",63)(1,"mat-checkbox",64),D("change",function(t){C(e);let m=v(2);return S(m.roleTimeBoundChange(t))}),l(2),s(3,"translate"),r(),f(4,Gt,24,14,"div",13),o(5,"div")(6,"mat-checkbox",65),l(7),s(8,"translate"),r()()()}if(i&2){let e,n=v(2);a(2),p(" ",d(3,3,"SPACIFY_THE_PERIOD")," "),a(2),h((e=n.rolePermissionFormGroup.get("isTimeBound"))!=null&&e.value?4:-1),a(3),p("",d(8,5,"ALLOW_DOWNLOAD")," ")}}function qt(i,c){if(i&1){let e=y();o(0,"div",34)(1,"label",24),l(2),s(3,"translate"),r(),o(4,"mat-select",61),s(5,"translate"),ie("valueChange",function(t){C(e);let m=v();return te(m.selectedRoles,t)||(m.selectedRoles=t),S(t)}),o(6,"mat-select-trigger"),f(7,Rt,2,1,"span"),f(8,Bt,2,2,"span",62),r(),w(9,Ot,2,2,"mat-option",22,R),r(),f(11,jt,9,7,"div",63),r()}if(i&2){let e=v();a(2),F(d(3,7,"ASSIGN_ROLES")),a(2),g("placeholder",b(d(5,9,"ROLES"))),ee("value",e.selectedRoles),a(3),h(e.selectedRoles.length>0?7:-1),a(),h(e.selectedRoles.length>1?8:-1),a(),k(e.roles),a(2),h(e.selectedRoles.length>0?11:-1)}}function Wt(i,c){if(i&1&&(o(0,"span"),l(1),r()),i&2){let e=v(2);a(),O(" ",e.selectedUsers[0].firstName," ",e.selectedUsers[0].lastName," ")}}function $t(i,c){if(i&1&&(o(0,"span",62),l(1),r()),i&2){let e=v(2);a(),O(" (+",e.selectedUsers.length-1," ",e.selectedRoles.length===2?"other":"others",") ")}}function Yt(i,c){if(i&1&&(o(0,"mat-option",22),l(1),r()),i&2){let e=c.$implicit;g("value",e),a(),O(" ",e.firstName," ",e.lastName," ")}}function zt(i,c){i&1&&(o(0,"div",48),l(1),s(2,"translate"),r()),i&2&&(a(),p(" ",d(2,1,"START_DATE_IS_REQURED")," "))}function Ht(i,c){i&1&&(o(0,"div",48),l(1),s(2,"translate"),r()),i&2&&(a(),p(" ",d(2,1,"END_DATE_IS_REQURED")," "))}function Qt(i,c){if(i&1){let e=y();o(0,"div",13)(1,"div",34)(2,"div",19),E(3,"input",66,1),s(5,"translate"),o(6,"div",67)(7,"button",68),D("click",function(){C(e);let t=P(11);return S(t.open())}),o(8,"mat-icon",69),l(9,"calendar_today"),r()()()(),E(10,"mat-datepicker",null,2),f(12,zt,3,3,"div",48),r(),o(13,"div",34)(14,"div",19),E(15,"input",70),s(16,"translate"),o(17,"div",67)(18,"button",68),D("click",function(){C(e);let t=P(22);return S(t.open())}),o(19,"mat-icon",69),l(20,"calendar_today"),r()()()(),E(21,"mat-datepicker",null,3),f(23,Ht,3,3,"div",48),r()()}if(i&2){let e,n,t,m=P(11),u=P(22),_=v(3);a(3),g("placeholder",b(d(5,10,"CHOOSE_A_START_DATE")))("min",_.minDate)("matDatepicker",m),a(9),h((e=_.userPermissionFormGroup.get("startDate"))!=null&&e.touched&&((e=_.userPermissionFormGroup.get("startDate"))!=null&&e.hasError("required"))?12:-1),a(3),g("placeholder",b(d(16,12,"CHOOSE_A_END_DATE")))("min",(n=_.userPermissionFormGroup.get("startDate"))==null?null:n.value)("matDatepicker",u),a(8),h((t=_.userPermissionFormGroup.get("startDate"))!=null&&t.touched&&((t=_.userPermissionFormGroup.get("endDate"))!=null&&t.hasError("required"))?23:-1)}}function Kt(i,c){if(i&1){let e=y();o(0,"div",71)(1,"mat-checkbox",64),D("change",function(t){C(e);let m=v(2);return S(m.userTimeBoundChange(t))}),l(2),s(3,"translate"),r(),f(4,Qt,24,14,"div",13),o(5,"div")(6,"mat-checkbox",65),l(7),s(8,"translate"),r()()()}if(i&2){let e,n=v(2);a(2),p(" ",d(3,3,"SPACIFY_THE_PERIOD")),a(2),h((e=n.userPermissionFormGroup.get("isTimeBound"))!=null&&e.value?4:-1),a(3),F(d(8,5,"ALLOW_DOWNLOAD"))}}function Xt(i,c){if(i&1){let e=y();o(0,"div",34)(1,"label",24),l(2),s(3,"translate"),r(),o(4,"mat-select",61),s(5,"translate"),ie("valueChange",function(t){C(e);let m=v();return te(m.selectedUsers,t)||(m.selectedUsers=t),S(t)}),o(6,"mat-select-trigger"),f(7,Wt,2,2,"span"),f(8,$t,2,2,"span",62),r(),w(9,Yt,2,3,"mat-option",22,R),r(),f(11,Kt,9,7,"div",71),r()}if(i&2){let e=v();a(2),F(d(3,7,"ASSIGN_USERS")),a(2),g("placeholder",b(d(5,9,"USERS"))),ee("value",e.selectedUsers),a(3),h(e.selectedUsers.length>0?7:-1),a(),h(e.selectedUsers.length>1?8:-1),a(),k(e.userStore.users()),a(2),h(e.selectedUsers.length>0?11:-1)}}function Jt(i,c){i&1&&(o(0,"label"),l(1),s(2,"translate"),r()),i&2&&(a(),F(d(2,1,"META_TAGS")))}function Zt(i,c){if(i&1&&(o(0,"mat-option",22),l(1),r()),i&2){let e=c.$implicit;g("value",e.id),a(),F(e.name)}}function ei(i,c){i&1&&(o(0,"div",48),l(1),s(2,"translate"),r()),i&2&&(a(),p(" ",d(2,1,"META_TAG_VALUE_REQUIRED")," "))}function ti(i,c){if(i&1&&(o(0,"div",77),E(1,"input",81),s(2,"translate"),f(3,ei,3,3,"div",48),r()),i&2){let e,n=v().$implicit;a(),g("placeholder",b(d(2,3,"ENTER_META_TAG_VALUE"))),a(2),h((e=n.get("metatag"))!=null&&e.hasError("required")&&((e=n.get("metatag"))!=null&&e.touched)?3:-1)}}function ii(i,c){i&1&&(o(0,"div",48),l(1),s(2,"translate"),r()),i&2&&(a(),p(" ",d(2,1,"META_TAG_VALUE_REQUIRED")," "))}function ni(i,c){if(i&1){let e=y();o(0,"div",77)(1,"div",19),E(2,"input",82,1),s(4,"translate"),o(5,"div",67)(6,"button",68),D("click",function(){C(e);let t=P(10);return S(t.open())}),o(7,"mat-icon",69),l(8,"calendar_today"),r()()(),E(9,"mat-datepicker",null,4),r(),f(11,ii,3,3,"div",48),r()}if(i&2){let e,n=P(10),t=v().$implicit;a(2),g("placeholder",b(d(4,4,"CHOOSE_A_DATE")))("matDatepicker",n),a(9),h((e=t.get("metaTagDate"))!=null&&e.hasError("required")&&((e=t.get("metaTagDate"))!=null&&e.touched)?11:-1)}}function ai(i,c){if(i&1){let e=y();o(0,"button",83),D("click",function(){C(e);let t=v(2);return S(t.onAddAnotherMetaTag())}),o(1,"mat-icon"),l(2,"add"),r()()}}function oi(i,c){if(i&1){let e=y();o(0,"button",84),D("click",function(){C(e);let t=v().$index,m=v();return S(m.onDeleteMetaTag(t))}),o(1,"mat-icon"),l(2,"delete"),r()()}}function ri(i,c){if(i&1){let e=y();de(0,33),f(1,Jt,3,3,"label"),o(2,"div",72)(3,"div",13)(4,"div",73)(5,"mat-select",74),s(6,"translate"),D("selectionChange",function(t){let m=C(e).$index,u=v();return S(u.onMetaTagKeyChange(t,m))}),o(7,"mat-option"),l(8),s(9,"translate"),r(),w(10,Zt,2,2,"mat-option",22,ht),r()(),o(12,"div",75)(13,"div",76),f(14,ti,4,5,"div",77),f(15,ni,12,6,"div",77),o(16,"div",78),f(17,ai,3,0,"button",79)(18,oi,3,0,"button",80),r()()()()(),ce()}if(i&2){let e,n,t=c.$implicit,m=c.$index,u=v();g("formGroupName",m),a(),h(m==0?1:-1),a(4),g("placeholder",b(d(6,8,"SELECT_META_TAG"))),a(3),p("-- ",d(9,10,"NONE")," --"),a(2),k(u.metaTags()),a(4),h(((e=t.get("metaTagType"))==null?null:e.value)==0?14:-1),a(),h(((n=t.get("metaTagType"))==null?null:n.value)==1?15:-1),a(2),h(m==0?17:18)}}function li(i,c){i&1&&(o(0,"div",48),l(1),s(2,"translate"),r()),i&2&&(a(),p(" ",d(2,1,"SELECT_RETENTION_PERIOD")," "))}function mi(i,c){if(i&1){let e=y();o(0,"button",85),D("click",function(){C(e);let t=v();return S(t.saveDocument())}),o(1,"mat-icon",52),l(2,"save"),r(),l(3),s(4,"translate"),r()}i&2&&(a(3),p(" ",d(4,1,"SAVE")," "))}function si(i,c){if(i&1&&(o(0,"div",53),E(1,"mat-progress-spinner",86),r()),i&2){let e=v();a(),g("mode",e.mode)("value",e.progress)}}var X=class i extends q{constructor(e,n,t,m,u,_,I,T,M,ci,pi,ui){super();this.fb=e;this.cd=n;this.categoryService=t;this.commonService=m;this.documentStatusService=u;this.clonerService=_;this.StorageSettingService=I;this.documentService=T;this.route=M;this.router=ci;this.toastrService=pi;this.pptxMetadataService=ui;this.minDate=new Date}document;documentForm;extension="";categories=[];allCategories=[];storageSettings=[];documentStatues=[];documentSource="";onSaveDocument=new Z;addDocumentTrail=new Z;progress=0;message="";fileInfo;isFileUpload=!1;fileData;userStore=V(et);roles;selectedRoles=[];selectedUsers=[];allowFileExtension=[];minDate;parallelUploads=5;isLoading=!1;chunkSize=ae.chunkSize;mode="determinate";view="";categoryId="";dialog=V(ve);get documentMetaTagsArray(){return this.documentForm.get("documentMetaTags")}clientStore=V(tt);foldersViewStore=V(Y);documentMetaTagStore=V(Q);metaTags=this.documentMetaTagStore.documentMetaTags;selectedCategory;ngOnInit(){this.view=this.route.snapshot.queryParamMap.get("view"),this.categoryId=this.route.snapshot.queryParamMap.get("categoryId")?this.route.snapshot.queryParamMap.get("categoryId"):"",this.createDocumentForm(),this.getCategories(),this.getDocumentStatus(),this.getStorageSetting(),this.documentMetaTagsArray.push(this.buildDocumentMetaTag()),this.getRoles(),this.getAllAllowFileExtension()}getRoles(){this.commonService.getRoles().subscribe(e=>this.roles=e)}getDocumentStatus(){this.documentStatusService.getDocumentStatuss().subscribe(e=>{e&&e.length>0?this.documentStatues=e:this.documentStatues=[]})}onCategoryChange(e){this.selectedCategory=this.allCategories.find(n=>n.id===e.value)}getStorageSetting(){this.StorageSettingService.getStorageSettings().subscribe(e=>{if(e&&e.length>0){this.storageSettings=e;let n=this.storageSettings.find(t=>t.isDefault);n&&this.documentForm.patchValue({storageSettingId:n.id})}})}getAllAllowFileExtension(){this.commonService.getAllowFileExtensions().subscribe(),this.sub$.sink=this.commonService.allowFileExtension$.subscribe(e=>{e&&(this.allowFileExtension=e)})}getCategories(){this.categoryService.getAllCategories().subscribe(e=>{if(this.categories=[...e],this.categories.filter(t=>t.parentId==null).forEach((t,m)=>{t.deafLevel=0,t.index=m*Math.pow(.1,t.deafLevel),t.displayName=t.name,this.allCategories.push(t),this.setDeafLevel(t)}),this.allCategories=this.clonerService.deepClone(this.allCategories),this.categoryId){let t=this.allCategories.find(m=>m.id===this.categoryId);t&&(this.documentForm.patchValue({categoryId:t.id}),this.onCategoryChange({value:t.id}))}})}setDeafLevel(e){return e?.children&&e.children.length>0&&e.children.map((n,t)=>{n.displayName=e.displayName+" > "+n.name,n.deafLevel=e?(e.deafLevel??0)+1:0,n.index=e?(e.index??0)+t*Math.pow(.1,n.deafLevel):0,this.allCategories.push(n),this.setDeafLevel(n)}),e}onDocumentChange(e){let n=e.target.files||e.srcElement.files,t=n[0];if(this.fileData=n[0],this.extension=t.name.split(".").pop(),this.fileExtesionValidation(this.extension)){let m=new FileReader;m.onload=u=>N(this,null,function*(){this.documentSource=u.target.result,this.fileUploadValidation("upload")}),m.readAsArrayBuffer(t)}else this.documentSource="",this.fileUploadValidation("")}getPDFMetadata(e){return N(this,null,function*(){let n=yield this.pptxMetadataService.getPDFMetadata(e);n&&this.populateMetadataTags(n)})}fileUploadValidation(e){this.documentForm.patchValue({url:e}),this.documentForm.get("url")?.markAsTouched(),this.documentForm.updateValueAndValidity()}fileUploadExtensionValidation(e){this.documentForm.patchValue({extension:e}),this.documentForm.get("extension")?.markAsTouched(),this.documentForm.updateValueAndValidity()}fileExtesionValidation(e){return!!this.allowFileExtension?.find(t=>t.extensions?.find(m=>m.toLowerCase()===e.toLowerCase()))}createDocumentForm(){this.documentForm=this.fb.group({name:["",[A.required]],description:[""],categoryId:[this.categoryId,[A.required]],url:["",[A.required]],extension:["",[A.required]],documentMetaTags:this.fb.array([]),documentStatusId:[""],storageSettingId:[""],clientId:[""],selectedRoles:[],selectedUsers:[],rolePermissionForm:this.fb.group({isTimeBound:[!1],startDate:[""],endDate:[""],isAllowDownload:[!1]}),userPermissionForm:this.fb.group({isTimeBound:[!1],startDate:[""],endDate:[""],isAllowDownload:[!1]}),retentionPeriodInDays:["0"],onExpiryAction:["0"]},{validators:mt})}buildDocumentMetaTag(){return this.fb.group({id:[""],documentId:[""],documentMetaTagId:[""],metatag:[""],metaTagDate:[null],metaTagType:[0]})}get rolePermissionFormGroup(){return this.documentForm.get("rolePermissionForm")}get userPermissionFormGroup(){return this.documentForm.get("userPermissionForm")}onMetatagChange(e,n){if(!this.documentMetaTagsArray.at(n).get("metatag")?.value)return;let m=this.documentMetaTagsArray.at(n).get("metatag");m?.setValidators([A.required]),m?.updateValueAndValidity()}onMetaTagKeyChange(e,n){let t=e.value;if(this.documentMetaTagsArray.value.map(M=>M.documentMetaTagId).filter(M=>M===t).length>1){this.toastrService.error(this.translationService.getValue("DUPLICATE_META_TAG_NOT_ALLOWED")),this.documentMetaTagsArray.at(n).get("documentMetaTagId")?.setValue(null);return}let u=this.metaTags().find(M=>M.id===t);if(!u)return;let _=this.documentMetaTagsArray.at(n),I=_.get("metatag"),T=_.get("metaTagDate");_.get("metaTagType")?.setValue(u.type),u.type===0?(I?.setValidators([A.required]),I?.updateValueAndValidity(),T?.clearValidators(),T?.setValue(null),T?.updateValueAndValidity()):u.type===1&&(T?.setValidators([A.required]),T?.updateValueAndValidity(),I?.clearValidators(),I?.setValue(null),I?.updateValueAndValidity())}editDocmentMetaData(e){return this.fb.group({id:[e.id],documentId:[e.documentId],documentMetaTagId:[e.documentMetaTagId],metatag:[e.metatag],metaTagDate:[e.metaTagDate],metaTagType:[e.metaTagType]})}saveDocument(){if(this.documentForm.valid){let e=this.commonService.getInternetSpeed();this.fileData.size>this.chunkSize?this.saveDocumentChunk():this.onSaveDocument.emit(this.buildDocumentObject())}else this.documentForm.markAllAsTouched()}saveDocumentChunk(){this.documentService.addChunkDocument(this.buildDocumentObject()).subscribe(e=>{this.document=e,this.uploadFileInChunks(e.documentVersionId??"")})}markFormGroupTouched(e){Object.values(e.controls).forEach(n=>{n.controls&&this.markFormGroupTouched(n)})}buildMetaTagObject(){return(this.documentMetaTagsArray.getRawValue().length>0?this.documentMetaTagsArray.getRawValue():[]).map(t=>({id:t.id,documentId:t.documentId,documentMetaTagId:t.documentMetaTagId,metatag:t.metatag,metaTagDate:t.metaTagDate?.toString()==="Invalid Date"?void 0:t.metaTagDate?new Date(t.metaTagDate).toISOString():void 0,metaTagType:t.metaTagType}))}buildDocumentObject(){let e={categoryId:this.documentForm.get("categoryId")?.value??"",documentStatusId:this.documentForm.get("documentStatusId")?.value??"",clientId:this.documentForm.get("clientId")?.value??"",storageSettingId:this.documentForm.get("storageSettingId")?.value??"",description:this.documentForm.get("description")?.value??"",name:this.documentForm.get("name")?.value,url:this.fileData.name,documentMetaDatas:[...this.buildMetaTagObject()],file:this.fileData,extension:this.extension,isAssignToMe:!1,retentionPeriodInDays:this.documentForm.get("retentionPeriodInDays")?.value??null,onExpiryAction:this.documentForm.get("onExpiryAction")?.value??null};return this.selectedRoles.length>0&&(e.documentRolePermissions=this.selectedRoles.map(n=>Object.assign({},{id:"",documentId:"",roleId:n.id},this.rolePermissionFormGroup.value))),this.selectedUsers.length>0&&(e.documentUserPermissions=this.selectedUsers.map(n=>Object.assign({},{id:"",documentId:"",userId:n.id},this.userPermissionFormGroup.value))),e}onAddAnotherMetaTag(){let n=this.documentMetaTagsArray.value.map(t=>t.documentMetaTagId).filter(t=>t!=="");if(new Set(n).size!==n.length){this.toastrService.error(this.translationService.getValue("DUPLICATE_META_TAG_NOT_ALLOWED"));return}this.documentMetaTagsArray.push(this.buildDocumentMetaTag()),this.documentForm.updateValueAndValidity(),this.cd.detectChanges()}onDeleteMetaTag(e){this.documentMetaTagsArray.removeAt(e),this.documentForm.updateValueAndValidity(),this.cd.detectChanges()}upload(e){return N(this,null,function*(){if(!e||e.length===0)return;if(!(yield We(e[0]))){this.documentSource="",this.fileUploadValidation(""),this.toastrService.error(this.translationService.getValue("INVALID_EXTENSION_OR_CORRUPT_INVALID_SIGNATURE")),this.cd.markForCheck();return}if(this.extension=e[0].name.split(".").pop()??"",this.fileExtesionValidation(this.extension))this.fileUploadExtensionValidation("valid");else{this.fileUploadExtensionValidation(""),this.cd.markForCheck();return}let n=ae.allowExtesions.find(t=>t.extentions.find(m=>m.toLowerCase()===this.extension.toLowerCase()));if(this.fileData=e[0],this.extension==="pdf")yield this.getPDFMetadata(e[0]);else if(this.extension==="docx"||this.extension==="doc"){let t=yield this.readWordMetadata(e[0])}else this.extension==="ppt"||this.extension==="pptx"?this.readPPTXMetadata(e[0]):(this.extension==="xls"||this.extension==="xlsx")&&this.readXlsMetadata(e[0]);this.documentForm.get("url")?.setValue(e[0].name),this.documentForm.get("name")?.setValue(e[0].name)})}readWordMetadata(e){return N(this,null,function*(){let n=yield this.pptxMetadataService.extractMetadata(e);n&&(this.populateMetadataTags(n),console.log("Metadata:",n))})}readPPTXMetadata(e){return N(this,null,function*(){let n=yield this.pptxMetadataService.extractMetadata(e);n&&(this.populateMetadataTags(n),console.log("Metadata:",n))})}readXlsMetadata(e){return N(this,null,function*(){let n=yield this.pptxMetadataService.extractMetadata(e);n&&(this.populateMetadataTags(n),console.log("Metadata:",n))})}populateMetadataTags(e){this.documentMetaTagsArray.clear(),Object.keys(e).forEach(n=>{let t=this.metaTags().find(u=>u?.name.toLocaleLowerCase()===n),m=n.toLocaleLowerCase()==="title"&&(!e[n]||e[n].toLocaleLowerCase()==="n/a")?this.fileData.name.split(".")[0]:e[n];t&&m&&this.documentMetaTagsArray.push(this.fb.group({id:[""],documentId:[""],documentMetaTagId:[t.id],metatag:[t.type==0?m:""],metaTagDate:[t.type==1&&m?new Date(m):null],metaTagType:[t.type]}))}),this.documentForm.updateValueAndValidity(),this.cd.detectChanges()}uploadFileInChunks(e){if(!this.fileData)return;let{parallelCalls:n}=this.commonService.getNetworkSpeed(),t=Math.ceil(this.fileData.size/this.chunkSize),m=[];this.progress=0,this.isLoading=!0;for(let u=0;u<t;u++){let _=u*this.chunkSize,I=Math.min(_+this.chunkSize,this.fileData.size),T=this.fileData.slice(_,I),M=new FormData;M.append("file",T),M.append("chunkIndex",u.toString()),M.append("size",this.chunkSize.toString()),M.append("totalChunks",t.toString()),M.append("extension",this.extension),M.append("documentVersionId",e),m.push(M)}this.sub$.sink=J(m).pipe(re(n),le(u=>J(u).pipe(me(()=>console.log("Processing batch:",u)),oe(_=>this.uploadChunk(_),n)))).subscribe({next:u=>{this.progress=Math.min(this.progress+100/t,100),this.cd.markForCheck()},complete:()=>{this.isLoading=!1,this.progress=100,this.markChunkAsUploaded(),this.cd.markForCheck()},error:u=>{this.markChunkAsUploaded(!1),this.isLoading=!1,this.cd.markForCheck()}})}uploadChunk(e){return this.documentService.uploadChunkDocument(e)}markChunkAsUploaded(e=!0){this.isLoading=!0,this.commonService.markChunkAsUploaded(this.document.id??"",e).subscribe({next:n=>{this.isLoading=!1,e&&this.addDocumentTrail.emit(this.document)},error:n=>{this.isLoading=!1}})}roleTimeBoundChange(e){e.checked?(this.rolePermissionFormGroup.get("startDate").setValidators([A.required]),this.rolePermissionFormGroup.get("endDate").setValidators([A.required])):(this.rolePermissionFormGroup.get("startDate")?.clearValidators(),this.rolePermissionFormGroup.get("startDate")?.updateValueAndValidity(),this.rolePermissionFormGroup.get("endDate")?.clearValidators(),this.rolePermissionFormGroup.get("endDate")?.updateValueAndValidity())}userTimeBoundChange(e){e.checked?(this.userPermissionFormGroup.get("startDate").setValidators([A.required]),this.userPermissionFormGroup.get("endDate").setValidators([A.required])):(this.userPermissionFormGroup.get("startDate").clearValidators(),this.userPermissionFormGroup.get("startDate").updateValueAndValidity(),this.userPermissionFormGroup.get("endDate").clearValidators(),this.userPermissionFormGroup.get("endDate").updateValueAndValidity())}cancel(){this.view==="list"?this.router.navigate(["/documents/list-view"]):this.view==="folders"?this.router.navigate(["/documents/folder-view"]):this.router.navigate(["/documents/list-view"])}addFolder(){this.dialog.open(ot,{width:"400px",data:Object.assign({},null)}).afterClosed().subscribe(n=>{n&&(this.categories=[...this.categories,n],this.categories.forEach((t,m)=>{t.deafLevel=0,t.index=m*Math.pow(.1,t.deafLevel),t.displayName=t.name,this.allCategories.push(t),this.setDeafLevel(t)}),this.allCategories=this.clonerService.deepClone(this.allCategories),this.documentForm.get("categoryId")?.setValue(n.id))})}addClient(){this.dialog.open(rt,{maxWidth:"50vw",width:"100%",data:!0}).afterClosed().subscribe(n=>{n&&this.documentForm.get("clientId")?.setValue(n.id)})}addDocumentStatus(){this.dialog.open(lt,{width:"500px"}).afterClosed().subscribe(n=>{n&&(this.documentStatues=[...this.documentStatues,n],this.documentForm.get("documentStatusId")?.setValue(n.id))})}static \u0275fac=function(n){return new(n||i)(x(Re),x(_e),x(Me),x(Ee),x(nt),x(Te),x(at),x($),x(G),x(j),x(W),x(K))};static \u0275cmp=U({type:i,selectors:[["app-document-manage-presentation"]],outputs:{onSaveDocument:"onSaveDocument",addDocumentTrail:"addDocumentTrail"},features:[pe([K]),L],decls:162,vars:107,consts:[["file",""],["ref",""],["startDatePicker",""],["endDatePicker",""],["picker",""],[1,"content"],[1,"container-fluid"],[1,"d-flex","mb-2"],[1,"me-auto"],[1,"mb-0","page-title"],["code","ADD_DOCUMENT"],[3,"formGroup"],["appearance","outlined"],[1,"row"],[1,"col-md-3"],[1,"form-group"],[1,"form-label","text-danger"],["type","file",1,"form-control",3,"change"],["formControlName","name","type","text",1,"form-control"],[1,"input-group"],["panelClass","mat-select-control","formControlName","categoryId",1,"form-control",3,"selectionChange","placeholder"],[3,"matTooltip"],[3,"value"],["type","button","class","btn btn-primary btn-sm",3,"click",4,"hasClaim"],[1,"form-label"],["panelClass","mat-select-control","formControlName","storageSettingId",1,"form-control"],["formControlName","description",1,"form-control"],["panelClass","mat-select-control","formControlName","documentStatusId",1,"form-control"],["class","btn btn-primary btn-sm","type","button",3,"click",4,"hasClaim"],["panelClass","mat-select-control","formControlName","clientId",1,"form-control"],["class","col-md-6",4,"hasClaim"],[1,"col-sm-12","col-md-12"],["formArrayName","documentMetaTags"],[3,"formGroupName"],[1,"col-md-6"],["panelClass","mat-select-control","formControlName","retentionPeriodInDays",1,"form-control",3,"placeholder"],["value","0"],["value","30"],["value","60"],["value","90"],["value","180"],["value","365"],["value","730"],["value","1095"],["value","1825"],["panelClass","mat-select-control","formControlName","onExpiryAction",1,"form-control",3,"placeholder"],["value","1"],["value","2"],[1,"text-danger"],[1,"mt-2","col-md-12"],["class","success me-2","matButton","filled","cdkFocusInitial","",3,"click",4,"hasClaim"],["type","button","matButton","filled",1,"error",3,"click"],[1,"medium-icon"],[1,"spinner-container"],[1,"country-item",3,"ngStyle"],[1,"d-flex","align-items-center"],[1,"d-flex","align-items-center",3,"matTooltip"],[1,"text-warning","me-1"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"medium-icon","fs-5","align-middle"],[3,"ngStyle"],["panelClass","mat-select-control","multiple","",1,"form-control",3,"valueChange","placeholder","value"],[1,"example-additional-selection"],["formGroupName","rolePermissionForm",1,"mt-3"],["color","primary","formControlName","isTimeBound",3,"change"],["color","primary","formControlName","isAllowDownload"],["formControlName","startDate",1,"form-control",3,"min","placeholder","matDatepicker"],[1,"input-group-append"],["type","button",1,"btn","btn-primary","calendar-button",3,"click"],[1,"medium-icon","fs-6","align-middle"],["formControlName","endDate",1,"form-control",3,"min","placeholder","matDatepicker"],["formGroupName","userPermissionForm",1,"mt-3"],[1,"form-group","mb-3","meta-tag-item"],[1,"col-12","col-md-4","mb-2","mb-md-0"],["panelClass","mat-select-control","formControlName","documentMetaTagId",1,"form-control",3,"selectionChange","placeholder"],[1,"col-12","col-md-8"],[1,"row","align-items-center"],[1,"col-9","col-md-9"],[1,"col-3","col-md-auto","text-end","ps-0"],["type","button",1,"btn","btn-outline-success"],["type","button",1,"btn","btn-outline-danger"],["formControlName","metatag","type","text",1,"form-control",3,"placeholder"],["formControlName","metaTagDate",1,"form-control",3,"placeholder","matDatepicker"],["type","button",1,"btn","btn-outline-success",3,"click"],["type","button",1,"btn","btn-outline-danger",3,"click"],["matButton","filled","cdkFocusInitial","",1,"success","me-2",3,"click"],["diameter","60","strokeWidth","5",1,"example-margin",3,"mode","value"]],template:function(n,t){if(n&1){let m=y();o(0,"section",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"span",9),l(5),s(6,"translate"),E(7,"app-page-help-text",10),r()()(),o(8,"form",11)(9,"mat-card",12)(10,"mat-card-content")(11,"div",13)(12,"div",14)(13,"div",15)(14,"label",16),l(15),s(16,"translate"),o(17,"sup"),l(18,"*"),r()(),o(19,"input",17,0),D("change",function(){C(m);let _=P(20);return S(t.upload(_==null?null:_.files))}),r(),f(21,St,2,1,"div"),f(22,xt,2,1,"div"),r()(),o(23,"div",14)(24,"div",15)(25,"label",16),l(26),s(27,"translate"),o(28,"sup"),l(29,"*"),r()(),E(30,"input",18),f(31,Et,2,1,"div"),r()(),o(32,"div",14)(33,"div",15)(34,"label",16),l(35),s(36,"translate"),o(37,"sup"),l(38,"*"),r()(),o(39,"div",19)(40,"mat-select",20),s(41,"translate"),D("selectionChange",function(_){return C(m),S(t.onCategoryChange(_))}),o(42,"mat-select-trigger")(43,"span",21),l(44),s(45,"translate"),r()(),o(46,"mat-option",22),l(47),s(48,"translate"),r(),w(49,It,4,5,"mat-option",22,R),r(),B(51,Ft,3,0,"button",23),r(),f(52,Pt,2,1,"div"),r()(),o(53,"div",14)(54,"div",15)(55,"label",24),l(56),s(57,"translate"),r(),o(58,"mat-select",25),w(59,At,3,5,"mat-option",22,R),r()()(),o(61,"div",14)(62,"div",15)(63,"label",24),l(64),s(65,"translate"),r(),o(66,"textarea",26),l(67,"                "),r()()(),o(68,"div",14)(69,"div",15)(70,"label",24),l(71),s(72,"translate"),r(),o(73,"div",19)(74,"mat-select",27)(75,"mat-option"),l(76),s(77,"translate"),r(),w(78,Vt,3,5,"mat-option",22,R),r(),B(80,wt,3,0,"button",28),r()()(),o(81,"div",14)(82,"div",15)(83,"label",24),l(84),s(85,"translate"),r(),o(86,"div",19)(87,"mat-select",29)(88,"mat-option"),l(89),s(90,"translate"),r(),w(91,kt,3,2,"mat-option",22,R),r(),B(93,Nt,3,0,"button",28),r()()(),B(94,qt,12,11,"div",30)(95,Xt,12,11,"div",30),o(96,"div",13)(97,"div",31)(98,"div",32),w(99,ri,19,12,"ng-container",33,se),r()()(),o(101,"div",13)(102,"div",34)(103,"div",15)(104,"label"),l(105),s(106,"translate"),r(),o(107,"mat-select",35),s(108,"translate"),o(109,"mat-option",36),l(110),s(111,"translate"),r(),o(112,"mat-option",37),l(113),s(114,"translate"),r(),o(115,"mat-option",38),l(116),s(117,"translate"),r(),o(118,"mat-option",39),l(119),s(120,"translate"),r(),o(121,"mat-option",40),l(122),s(123,"translate"),r(),o(124,"mat-option",41),l(125),s(126,"translate"),r(),o(127,"mat-option",42),l(128),s(129,"translate"),r(),o(130,"mat-option",43),l(131),s(132,"translate"),r(),o(133,"mat-option",44),l(134),s(135,"translate"),r()()()(),o(136,"div",34)(137,"div",15)(138,"label"),l(139),s(140,"translate"),r(),o(141,"mat-select",45),s(142,"translate"),o(143,"mat-option",36),l(144),s(145,"translate"),r(),o(146,"mat-option",46),l(147),s(148,"translate"),r(),o(149,"mat-option",47),l(150),s(151,"translate"),r()(),f(152,li,3,3,"div",48),r()()()(),o(153,"div",13)(154,"div",49),B(155,mi,5,3,"button",50),o(156,"button",51),D("click",function(){return C(m),S(t.cancel())}),o(157,"mat-icon",52),l(158,"cancel"),r(),l(159),s(160,"translate"),r()()()()()()()(),f(161,si,2,2,"div",53)}if(n&2){let m,u,_,I,T;a(5),p("",d(6,47,"ADD_DOCUMENT")," "),a(3),g("formGroup",t.documentForm),a(7),p("",d(16,49,"DOCUMENT_UPLOAD")," "),a(6),h((m=t.documentForm.get("url"))!=null&&m.invalid&&((m=t.documentForm.get("url"))!=null&&m.touched||(m=t.documentForm.get("url"))!=null&&m.dirty)?21:-1),a(),h((u=t.documentForm.get("extension"))!=null&&u.invalid&&((u=t.documentForm.get("extension"))!=null&&u.touched||(u=t.documentForm.get("extension"))!=null&&u.dirty)?22:-1),a(4),p("",d(27,51,"NAME")," "),a(5),h((_=t.documentForm.get("name"))!=null&&_.touched&&((_=t.documentForm.get("name"))!=null&&_.errors)?31:-1),a(4),p("",d(36,53,"CATEGORY")," "),a(5),g("placeholder",b(d(41,55,"SELECT_CATEGORY"))),a(3),g("matTooltip",t.selectedCategory==null?null:t.selectedCategory.displayName),a(),p(" ",d(45,57,(t.selectedCategory==null?null:t.selectedCategory.displayName)||"NONE")," "),a(3),p("-- ",d(48,59,"NONE")," --"),a(2),k(t.allCategories),a(2),g("hasClaim","CREATE_CATEGORY"),a(),h((I=t.documentForm.get("categoryId"))!=null&&I.touched&&((I=t.documentForm.get("categoryId"))!=null&&I.errors)?52:-1),a(4),F(d(57,61,"STORAGE")),a(3),k(t.storageSettings),a(5),F(d(65,63,"DESCRIPTION")),a(7),F(d(72,65,"DOCUMENT_STATUS")),a(5),p("-- ",d(77,67,"NONE")," --"),a(2),k(t.documentStatues),a(2),g("hasClaim","MANAGE_DOCUMENT_STATUS"),a(4),F(d(85,69,"CLIENT")),a(5),p("-- ",d(90,71,"NONE")," --"),a(2),k(t.clientStore.clients()),a(2),g("hasClaim","ADD_CLIENTS"),a(),g("hasClaim","ALL_SHARE_DOCUMENT"),a(),g("hasClaim","ALL_SHARE_DOCUMENT"),a(4),k(t.documentMetaTagsArray.controls),a(6),F(d(106,73,"RETENTION_PERIOD")),a(2),g("placeholder",b(d(108,75,"RETENTION_PERIOD"))),a(3),p("-- ",d(111,77,"NONE")," --"),a(3),p(" ",d(114,79,"30_DAYS")," "),a(3),p(" ",d(117,81,"60_DAYS")," "),a(3),p(" ",d(120,83,"90_DAYS")," "),a(3),p(" ",d(123,85,"180_DAYS")," "),a(3),p(" ",d(126,87,"365_DAYS")," "),a(3),p(" ",d(129,89,"2_YEARS")," "),a(3),p(" ",d(132,91,"3_YEARS")," "),a(3),p(" ",d(135,93,"5_YEARS")," "),a(5),F(d(140,95,"RETENTION_PERIOD_ACTION")),a(2),g("placeholder",b(d(142,97,"RETENTION_PERIOD_ACTION"))),a(3),p("-- ",d(145,99,"NONE")," --"),a(3),p(" ",d(148,101,"ARCHIVE")," "),a(3),p(" ",d(151,103,"DELETE")," "),a(2),h(((T=t.documentForm.get("retentionPeriodInDays"))!=null&&T.touched||(T=t.documentForm.get("retentionPeriodInDays"))!=null&&T.dirty||(T=t.documentForm.get("onExpiryAction"))!=null&&T.touched||(T=t.documentForm.get("onExpiryAction"))!=null&&T.dirty)&&(t.documentForm.errors!=null&&t.documentForm.errors.retentionPeriodAndAction)?152:-1),a(3),g("hasClaim","ALL_CREATE_DOCUMENT"),a(4),p(" ",d(160,105,"CANCEL")," "),a(2),h(t.isLoading?161:-1)}},dependencies:[Be,Ae,Fe,be,Pe,Ve,Ne,we,ke,Ke,Qe,he,fe,Se,Ce,H,z,He,Ye,ze,$e,Ze,Xe,Je,xe,Ge,Ie,qe,je,Le,Oe,Ue,ge,De,it],encapsulation:2,changeDetection:0})};function di(i,c){i&1&&(o(0,"div",1),E(1,"mat-progress-spinner",2),r())}var st=class i extends q{constructor(e,n,t,m){super();this.toastrService=e;this.documentService=n;this.router=t;this.route=m}documentForm;loading=!1;documentSource;documentStore=V(ye);foldersViewStore=V(Y);chunkSize=1024*1024;parallelUploads=5;view="";documentMetaTagStore=V(Q);ngOnInit(){this.view=this.route.snapshot.queryParams.view}saveDocument(e){this.loading=!0,this.sub$.sink=this.documentService.addDocument(e).subscribe({next:n=>{this.addDocumentTrail(n)},error:n=>{this.loading=!1}})}addDocumentTrail(e){let n={documentId:e.id,operationName:2 .toString()};this.foldersViewStore.selectedCategoryId()==e.categoryId&&(this.foldersViewStore.setDocumentsEmpty(),this.foldersViewStore.loadDocumentsByCategory(this.foldersViewStore.selectedCategoryId())),this.toastrService.success(this.translationService.getValue("DOCUMENT_SAVE_SUCCESSFULLY")),this.loading=!1,this.documentStore.loadDocuments(),this.documentStore.addDocumentAudit(n),this.view==="list"?this.router.navigate(["/documents/list-view"]):this.view==="folders"?this.router.navigate(["/documents/folder-view"]):this.router.navigate(["/documents/list-view"])}static \u0275fac=function(n){return new(n||i)(x(W),x($),x(j),x(G))};static \u0275cmp=U({type:i,selectors:[["app-document-manage"]],features:[L],decls:2,vars:1,consts:[[3,"addDocumentTrail","onSaveDocument"],[1,"spinner-container"],["mode","indeterminate","diameter","60","strokeWidth","5"]],template:function(n,t){n&1&&(o(0,"app-document-manage-presentation",0),D("addDocumentTrail",function(u){return t.addDocumentTrail(u)})("onSaveDocument",function(u){return t.saveDocument(u)}),r(),f(1,di,2,0,"div",1)),n&2&&(a(),h(t.loading?1:-1))},dependencies:[X,H,z],encapsulation:2})};export{st as DocumentManageComponent};
