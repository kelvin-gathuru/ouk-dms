import{a as W}from"./chunk-D6ZLTYCQ.js";import{a as D}from"./chunk-ZXWR2MAY.js";import"./chunk-G4LST2RF.js";import{b as J,c as K,d as X,e as Z,f as ee}from"./chunk-2DXU6Z77.js";import{b as B}from"./chunk-WC3ZMFX5.js";import{a as T}from"./chunk-RKRBEXQJ.js";import"./chunk-C3OPHOKD.js";import{a as te,b as ie,e as q}from"./chunk-F3ENXN4Q.js";import{C as G,E as V,c as U,e as g,h as A,i as O,o as k,r as L,u as j}from"./chunk-KYSGX4IW.js";import"./chunk-LCPYESOB.js";import{g as Y,h as $,k as z}from"./chunk-BFSIXXTJ.js";import{a as b,b as y}from"./chunk-P6E4AR6Q.js";import{ta as N,va as x}from"./chunk-GDJX5AXE.js";import{$ as u,Ca as v,Da as _,Db as m,Eb as d,Ia as P,Ja as r,Ka as e,La as h,Pc as M,Rc as R,Ua as C,W as i,Wa as E,ga as w,jb as n,ka as I,kb as F,lb as p,zb as H}from"./chunk-KZMFGXDY.js";import"./chunk-W3TJXGK4.js";import"./chunk-H5HZ6YB3.js";function fe(t,S){t&1&&(r(0,"div",12),n(1),m(2,"translate"),e()),t&2&&(i(),p(" ",d(2,1,"CURRENT_PASSWORD_IS_REQUIRED")," "))}function ve(t,S){t&1&&(n(0),m(1,"translate")),t&2&&p(" ",d(1,1,"PASSWORD_IS_REQUIRED")," ")}function _e(t,S){t&1&&(r(0,"div"),n(1),m(2,"translate"),e()),t&2&&(i(),p(" ",d(2,1,"YOU_HAVE_TO_ENTER_AT_LEAST_DIGIT")," "))}function Se(t,S){if(t&1&&(r(0,"div",12),v(1,ve,2,3),v(2,_e,3,3,"div"),e()),t&2){let l,o,a=E();i(),_(!((l=a.changePasswordForm.get("password"))==null||l.errors==null)&&l.errors.required?1:-1),i(),_(!((o=a.changePasswordForm.get("password"))==null||o.errors==null)&&o.errors.minlength?2:-1)}}function ge(t,S){t&1&&(r(0,"div"),n(1),m(2,"translate"),e()),t&2&&(i(),p(" ",d(2,1,"CONFIRM_PASSWORD_IS_REQUIRED")," "))}function he(t,S){if(t&1&&(r(0,"div",12),v(1,ge,3,3,"div"),e()),t&2){let l,o=E();i(),_(!((l=o.changePasswordForm.get("confirmPassword"))==null||l.errors==null)&&l.errors.required?1:-1)}}function Ce(t,S){t&1&&(r(0,"div",12),n(1),m(2,"translate"),e()),t&2&&(i(),p(" ",d(2,1,"PASSWORDS_DO_NOT_MATCH")," "))}var Q=class t extends D{constructor(l,o,a,s,f,c){super();this.userService=l;this.fb=o;this.dialogRef=a;this.data=s;this.toastrService=f;this.securityService=c}changePasswordForm;ngOnInit(){this.createChangePasswordForm(),this.changePasswordForm.get("email")?.setValue(this.data.userName)}createChangePasswordForm(){this.changePasswordForm=this.fb.group({email:[{value:"",disabled:!0}],oldPasswordPassword:["",[g.required]],password:["",[g.required,g.minLength(6)]],confirmPassword:["",[g.required]]},{validator:this.checkPasswords})}checkPasswords(l){let o=l.get("password")?.value,a=l.get("confirmPassword")?.value;return o===a?null:{notSame:!0}}changePassword(){this.changePasswordForm.valid&&(this.sub$.sink=this.userService.changePassword(this.createBuildObject()).subscribe(l=>{this.toastrService.success(this.translationService.getValue("SUCCESSFULLY_CHANGED_PASSWORD")),this.securityService.logout(),this.dialogRef.close()}))}createBuildObject(){return{email:"",oldPassword:this.changePasswordForm.get("oldPasswordPassword")?.value,newPassword:this.changePasswordForm.get("password")?.value,userName:this.changePasswordForm.get("email")?.value}}onNoClick(){this.dialogRef.close()}static \u0275fac=function(o){return new(o||t)(u(W),u(G),u(J),u(K),u(B),u(T))};static \u0275cmp=w({type:t,selectors:[["app-change-password"]],features:[I],decls:55,vars:26,consts:[[1,"d-flex"],[1,"me-auto","p-2"],[1,"mb-3","page-title"],[1,"d-flex","justify-content-end","mb-2"],[1,"close-icon","text-danger","cursor-pointer",3,"click"],[3,"formGroup"],[1,"col-md-12"],[1,"form-group"],[1,"form-label"],["formControlName","email","type","email",1,"form-control"],[1,"form-label","text-danger"],["autocomplete","new-password","formControlName","oldPasswordPassword","type","password",1,"form-control"],[1,"text-danger"],["autocomplete","new-password","formControlName","password","type","password",1,"form-control"],["autocomplete","new-password","formControlName","confirmPassword","type","password",1,"form-control"],[1,"col-md-12","my-2"],["matButton","filled",1,"success","me-2",3,"click"],[1,"medium-icon","align-middle"],["matButton","filled",1,"error",3,"click"]],template:function(o,a){if(o&1&&(r(0,"mat-dialog-content")(1,"div",0)(2,"div",1)(3,"span",2),n(4),m(5,"translate"),e()(),r(6,"div",3)(7,"mat-icon",4),C("click",function(){return a.onNoClick()}),n(8,"cancel"),e()()(),r(9,"form",5)(10,"div",6)(11,"div",7)(12,"label",8),n(13),m(14,"translate"),e(),h(15,"input",9),e()(),r(16,"div",6)(17,"div",7)(18,"label",10),n(19),m(20,"translate"),r(21,"sup"),n(22,"*"),e()(),h(23,"input",11),v(24,fe,3,3,"div",12),e()(),r(25,"div",6)(26,"div",7)(27,"label",10),n(28),m(29,"translate"),r(30,"sup"),n(31,"*"),e()(),h(32,"input",13),v(33,Se,3,2,"div",12),e()(),r(34,"div",6)(35,"div",7)(36,"label",10),n(37),m(38,"translate"),r(39,"sup"),n(40,"*"),e()(),h(41,"input",14),v(42,he,2,1,"div",12),v(43,Ce,3,3,"div",12),e()(),r(44,"div",15)(45,"button",16),C("click",function(){return a.changePassword()}),r(46,"mat-icon",17),n(47,"save"),e(),n(48),m(49,"translate"),e(),r(50,"button",18),C("click",function(){return a.onNoClick()}),r(51,"mat-icon",17),n(52,"cancel"),e(),n(53),m(54,"translate"),e()()()()),o&2){let s,f,c;i(4),p(" ",d(5,12,"CHANGE_PASSWORD")," "),i(5),P("formGroup",a.changePasswordForm),i(4),F(d(14,14,"EMAIL")),i(6),p("",d(20,16,"CURRENT_PASSWORD")," "),i(5),_((s=a.changePasswordForm.get("oldPasswordPassword"))!=null&&s.touched&&((s=a.changePasswordForm.get("oldPasswordPassword"))!=null&&s.errors)&&(!((s=a.changePasswordForm.get("oldPasswordPassword"))==null||s.errors==null)&&s.errors.required)?24:-1),i(4),p("",d(29,18,"NEW_PASSWORD")," "),i(5),_((f=a.changePasswordForm.get("password"))!=null&&f.touched&&((f=a.changePasswordForm.get("password"))!=null&&f.errors)?33:-1),i(4),p("",d(38,20,"CONFIRM_PASSWORD")," "),i(5),_((c=a.changePasswordForm.get("confirmPassword"))!=null&&c.touched&&((c=a.changePasswordForm.get("confirmPassword"))!=null&&c.errors)?42:-1),i(),_(a.changePasswordForm.hasError("notSame")?43:-1),i(5),p(" ",d(49,22,"SAVE")," "),i(5),p(" ",d(54,24,"CANCEL")," ")}},dependencies:[V,k,U,A,O,L,j,ee,Z,y,b,R,x,N,q,M],encapsulation:2})};var Pe=()=>["/"];function Ee(t,S){t&1&&(r(0,"div",15),n(1),m(2,"translate"),e()),t&2&&(i(),p(" ",d(2,1,"FIRST_NAME_IS_REQUIRED")," "))}function we(t,S){t&1&&(r(0,"div",15),n(1),m(2,"translate"),e()),t&2&&(i(),p(" ",d(2,1,"LAST_NAME_IS_REQUIRED")," "))}function Ie(t,S){if(t&1&&v(0,we,3,3,"div",15),t&2){let l,o=E();_(!((l=o.userForm.get("lastName"))==null||l.errors==null)&&l.errors.required?0:-1)}}function Fe(t,S){t&1&&(r(0,"div",15),n(1),m(2,"translate"),e()),t&2&&(i(),p(" ",d(2,1,"MOBILE_IS_REQUIRED")," "))}var re=class t extends D{constructor(l,o,a,s,f,c){super();this.router=l;this.fb=o;this.userService=a;this.toastrService=s;this.dialog=f;this.securityService=c}userForm;user;ngOnInit(){this.createUserForm();let l=this.securityService.getUserDetail();l&&(this.user=l,this.userForm.patchValue(this.user))}createUserForm(){this.userForm=this.fb.group({id:[""],firstName:["",[g.required]],lastName:["",[g.required]],email:[{value:"",disabled:!0},"",[g.required,g.email]],phoneNumber:["",[g.required]]})}updateProfile(){if(this.userForm.valid){let l=this.createBuildObject();this.sub$.sink=this.userService.updateUserProfile(l).subscribe({next:o=>{o&&typeof o=="object"&&"firstName"in o&&"lastName"in o&&"phoneNumber"in o?(this.user.firstName=o.firstName??"",this.user.lastName=o.lastName??"",this.user.phoneNumber=o.phoneNumber??"",this.toastrService.success(this.translationService.getValue("PROFILE_UPDATED_SUCCESSFULLY")),this.securityService.setUserDetail(this.user),this.router.navigate(["/"])):this.toastrService.error(this.translationService.getValue("PROFILE_UPDATE_FAILED"))},error:o=>{this.toastrService.error(this.translationService.getValue("PROFILE_UPDATE_FAILED"))}})}else this.toastrService.error(this.translationService.getValue("PLEASE_ENTER_PROPER_DATA"))}createBuildObject(){let l=this.userForm.get("id")?.value??"",o=this.userForm.get("firstName")?.value??"",a=this.userForm.get("lastName")?.value??"",s=this.userForm.get("email")?.value??"",f=this.userForm.get("phoneNumber")?.value??"";return{id:l,firstName:o,lastName:a,email:s,phoneNumber:f,userName:s}}changePassword(){this.dialog.open(Q,{width:"350px",data:Object.assign({},this.user)})}static \u0275fac=function(o){return new(o||t)(u(Y),u(G),u(W),u(B),u(X),u(T))};static \u0275cmp=w({type:t,selectors:[["app-my-profile"]],features:[I],decls:61,vars:30,consts:[[1,"content"],[1,"container-fluid"],[1,"d-flex","mb-2"],[1,"me-auto"],[1,"mb-0","page-title"],[1,"d-flex","justify-content-end"],["matButton","filled",1,"success","me-2",3,"click"],[1,"middle-icon","fs-5","align-middle"],[3,"formGroup"],["appearance","outlined"],[1,"row"],[1,"col-md-6"],[1,"form-group"],[1,"form-label","text-danger"],["formControlName","firstName","type","text",1,"form-control"],[1,"text-danger"],["formControlName","lastName","type","text",1,"form-control"],["formControlName","phoneNumber","type","text",1,"form-control"],[1,"form-label"],["formControlName","email","type","email",1,"form-control"],[1,"col-md-12","mt-4"],["matButton","filled","cdkFocusInitial","",1,"success","me-2",3,"click"],[1,"medium-icon","align-middle"],["type","button","matButton","filled",1,"error",3,"routerLink"]],template:function(o,a){if(o&1&&(r(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),n(5),m(6,"translate"),e()(),r(7,"div",5)(8,"button",6),C("click",function(){return a.changePassword()}),r(9,"mat-icon",7),n(10,"vpn_key"),e(),n(11),m(12,"translate"),e()()(),r(13,"form",8)(14,"mat-card",9)(15,"mat-card-content")(16,"div",10)(17,"div",11)(18,"div",12)(19,"label",13),n(20),m(21,"translate"),r(22,"sup"),n(23,"*"),e()(),h(24,"input",14),v(25,Ee,3,3,"div",15),e()(),r(26,"div",11)(27,"div",12)(28,"label",13),n(29),m(30,"translate"),r(31,"sup"),n(32,"*"),e()(),h(33,"input",16),v(34,Ie,1,1),e()(),r(35,"div",11)(36,"div",12)(37,"label",13),n(38),m(39,"translate"),r(40,"sup"),n(41,"*"),e()(),h(42,"input",17),v(43,Fe,3,3,"div",15),e()(),r(44,"div",11)(45,"div",12)(46,"label",18),n(47),m(48,"translate"),e(),h(49,"input",19),e()(),r(50,"div",20)(51,"button",21),C("click",function(){return a.updateProfile()}),r(52,"mat-icon",22),n(53,"save"),e(),n(54),m(55,"translate"),e(),r(56,"button",23)(57,"mat-icon",22),n(58,"cancel"),e(),n(59),m(60,"translate"),e()()()()()()()()),o&2){let s,f,c;i(5),p("",d(6,13,"PROFILE")," "),i(6),p(" ",d(12,15,"CHANGE_PASSWORD")," "),i(2),P("formGroup",a.userForm),i(7),p("",d(21,17,"FIRST_NAME")," "),i(5),_((s=a.userForm.get("firstName"))!=null&&s.touched&&((s=a.userForm.get("firstName"))!=null&&s.errors)&&(!((s=a.userForm.get("firstName"))==null||s.errors==null)&&s.errors.required)?25:-1),i(4),p("",d(30,19,"LAST_NAME")," "),i(5),_((f=a.userForm.get("lastName"))!=null&&f.touched&&((f=a.userForm.get("lastName"))!=null&&f.errors)?34:-1),i(4),p("",d(39,21,"MOBILE_NUMBER")," "),i(5),_((c=a.userForm.get("phoneNumber"))!=null&&c.touched&&((c=a.userForm.get("phoneNumber"))!=null&&c.errors)&&(!((c=a.userForm.get("phoneNumber"))==null||c.errors==null)&&c.errors.required)?43:-1),i(4),F(d(48,23,"EMAIL")),i(7),p(" ",d(55,25,"SAVE")," "),i(2),P("routerLink",H(29,Pe)),i(3),p(" ",d(60,27,"CANCEL")," ")}},dependencies:[V,k,U,A,O,L,j,z,$,R,y,b,q,te,ie,x,N,M],encapsulation:2})};export{re as MyProfileComponent};
