import{a as G}from"./chunk-UXSVGX5E.js";import{a as Te}from"./chunk-GKWO4BHT.js";import{b as ke,c as we}from"./chunk-DFQZAZAP.js";import{a as se}from"./chunk-OHUA35YV.js";import{a as Se}from"./chunk-YZ5VWOBY.js";import"./chunk-7UZYWCAJ.js";import{a as he,b as ve}from"./chunk-55DV7QCW.js";import"./chunk-PT2JM3JA.js";import"./chunk-4U6IWAJM.js";import"./chunk-NJY6F3LT.js";import{a as _e,c as be}from"./chunk-GYIDN45C.js";import"./chunk-G5E2PA5H.js";import{c as ue}from"./chunk-DXL7FQB3.js";import{b as me}from"./chunk-F2N2VWHU.js";import{a as ge,d as fe}from"./chunk-AHHITDV2.js";import"./chunk-QPRQJRAS.js";import{c as it}from"./chunk-PJSVLHWR.js";import"./chunk-546GNQSA.js";import"./chunk-2DXU6Z77.js";import{b as de}from"./chunk-WC3ZMFX5.js";import"./chunk-UFOTACYY.js";import"./chunk-RKRBEXQJ.js";import{a as le}from"./chunk-C3OPHOKD.js";import{a as tt,b as et,e as ot}from"./chunk-F3ENXN4Q.js";import{B as X,E as J,a as pe,c as H,e as I,h as j,i as z,o as K,r as Y,s as _t,t as bt,u as Z,z as ce}from"./chunk-KYSGX4IW.js";import{a as re}from"./chunk-LCPYESOB.js";import{g as D,h as Zt,k as V}from"./chunk-BFSIXXTJ.js";import{a as U,b as q}from"./chunk-P6E4AR6Q.js";import{B as te,C as ee,O as Et,ea as oe,ma as yt,oa as ie,p as Xt,qa as ne,r as Jt,ra as ft,sa as ae,ta as L,va as P}from"./chunk-GDJX5AXE.js";import{$a as A,A as Ot,Ca as f,Da as _,Db as p,Ea as Pt,Eb as c,Fa as rt,Ga as y,Gb as Kt,Ha as M,I as Gt,Ia as u,Ib as gt,Ja as r,Ka as l,La as S,Pb as W,Pc as $,Rb as Yt,Rc as Q,Sa as F,Ua as v,W as a,Wa as h,Xa as Ut,Ya as qt,Yb as It,Za as lt,_a as mt,_b as N,ab as O,c as Bt,e as At,eb as $t,fb as Qt,g as xt,ga as R,gb as Ct,ha as Wt,i as b,ia as Dt,ja as Vt,jb as s,kb as x,lb as m,ma as Lt,mb as Ht,oa as ct,p as k,q as w,r as pt,sb as jt,vb as T,yb as zt,za as B,zb as ut}from"./chunk-KZMFGXDY.js";import{J as Rt}from"./chunk-W3TJXGK4.js";import{a as st,b as dt}from"./chunk-H5HZ6YB3.js";var xe=(o,e)=>{let t=b(G),n=b(Se),i=o.paramMap.get("id");return i!=="add"?n.getWorkflow(i??"").pipe(se({next:d=>t.setCurrentWorkflow(d),error:d=>t.setError(d)})):(t.setCurrentWorkflowAsEmpty(),Rt(t.currentWorkflow()))};function Oe(o,e){o&1&&(r(0,"span",4),s(1),p(2,"translate"),S(3,"app-page-help-text",15),l()),o&2&&(a(),x(c(2,1,"ADD_WORKFLOW_STEP")))}function Ge(o,e){o&1&&(r(0,"span",4),s(1),p(2,"translate"),S(3,"app-page-help-text",15),l()),o&2&&(a(),x(c(2,1,"EDIT_WORKFLOW_STEP")))}function We(o,e){if(o&1){let t=F();r(0,"div",9)(1,"button",16),v("click",function(){k(t);let i=h();return w(i.addStep(null))}),r(2,"mat-icon",17),s(3,"add"),l(),s(4),p(5,"translate"),l()()}o&2&&(a(4),m(" ",c(5,1,"ADD_ANOTHER_STEP")," "))}function De(o,e){o&1&&(r(0,"div",23),s(1),p(2,"translate"),l()),o&2&&(a(),m(" ",c(2,1,"STEP_NAME_IS_REQUIRED")," "))}function Ve(o,e){o&1&&(r(0,"div",23),s(1),p(2,"translate"),l()),o&2&&(a(),m(" ",c(2,1,"STEP_NAME_MUST_BE_UNIQUE")," "))}function Le(o,e){if(o&1&&(f(0,De,3,3,"div",23),f(1,Ve,3,3,"div",23)),o&2){let t,n,i=h().$implicit;_(!((t=i.get("stepName"))==null||t.errors==null)&&t.errors.required?0:-1),a(),_(!((n=i.get("stepName"))==null||n.errors==null)&&n.errors.notUnique?1:-1)}}function Pe(o,e){if(o&1){let t=F();r(0,"button",26),v("click",function(){k(t);let i=h(2).$index,d=h();return w(d.removeStep(i))}),r(1,"mat-icon",27),s(2,"delete"),l()()}}function Ue(o,e){if(o&1&&(r(0,"div",22)(1,"div",24),f(2,Pe,3,0,"button",25),l()()),o&2){let t=h(2);a(2),_(t.steps.length>2?2:-1)}}function qe(o,e){if(o&1){let t=F();r(0,"div",10)(1,"div",5)(2,"div",18)(3,"div",19)(4,"div",20)(5,"label"),s(6),p(7,"translate"),l(),r(8,"input",21),p(9,"translate"),v("blur",function(){let i=k(t).$index,d=h();return w(d.checkUniqueStepName(i))}),l(),f(10,Le,2,2),l()()(),f(11,Ue,3,1,"div",22),l()()}if(o&2){let t,n=e.$implicit,i=e.$index,d=h();u("formGroupName",i),a(6),m(" ",c(7,6,"STEP_NAME")),a(2),u("placeholder",T(c(9,8,"ENTER_THE_WORKFLOW_STEP_NAME"))),a(2),_((t=n.get("stepName"))!=null&&t.touched&&((t=n.get("stepName"))!=null&&t.errors)?10:-1),a(),_(d.workflowInstances.length==0&&i>1?11:-1)}}var nt=class o{fb=b(X);workflowStore=b(G);toastrService=b(de);translationService=b(re);router=b(D);stepFormGroup;isLoading=!1;currentStep=1;currentWorkflow=this.workflowStore.currentWorkflow();workflowSteps=this.currentWorkflow?.workflowSteps??[];workflowInstances=this.currentWorkflow?.workflowInstances??[];isWorkflowSetup=this.currentWorkflow?.isWorkflowSetup;get steps(){return this.stepFormGroup.get("steps")}constructor(){W(()=>{let e=this.workflowStore.currentStep();e!==this.currentStep&&(this.currentStep=e,e===0?this.onPreviousClick():this.goToWorkflowTransitions())})}ngOnInit(){this.createStepFormGroup(),this.workflowSteps&&this.workflowSteps?.length===0?(this.addStep(null),this.addStep(null)):this.workflowSteps.forEach(e=>{this.addStep(e)})}goToWorkflowTransitions(){this.router.navigate(["/workflow-settings/manage/manage-transitions"])}checkUniqueStepName(e){let t=this.steps.at(e).get("stepName")?.value;if(this.steps.controls.some((i,d)=>d!==e&&i.get("stepName")?.value===t))this.steps.at(e).get("stepName")?.setErrors({notUnique:!0});else{let i=this.steps.at(e).get("stepName")?.errors;i&&(Object.keys(i).length===0?this.steps.at(e).get("stepName")?.setErrors(null):this.steps.at(e).get("stepName")?.setErrors(i))}}createStepFormGroup(){this.stepFormGroup=this.fb.group({steps:this.fb.array([])})}addStep(e){let t=this.fb.group({id:[e?.id],stepName:[{value:e?.stepName,disabled:!1},[I.required]],workflowId:[e?.workflowId]});this.steps.push(t)}removeStep(e){this.steps.removeAt(e)}saveWorkflowSteps(){if(this.stepFormGroup.invalid){this.stepFormGroup.markAllAsTouched();return}if(this.steps.value.length<2){this.toastrService.success(this.translationService.getValue("ADDED_LEAST_TWO_STEP"));return}this.isLoading=!0;let e=this.steps.value.map(t=>dt(st({},t),{workflowId:this.currentWorkflow?.id??""}));this.workflowInstances.length>0?this.workflowStore.updateWorkflowStep(e):this.workflowStore.addWorkflowStep(e)}onPreviousClick(){this.workflowStore.setCurrentStep(0),this.router.navigate(["/workflow-settings/manage",this.currentWorkflow?.id??""])}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=R({type:o,selectors:[["app-manage-step"]],decls:25,vars:11,consts:[[1,"content"],[1,"container-fluid"],[1,"d-flex","mb-2"],[1,"me-auto"],[1,"mb-0","page-title"],[1,"row"],[3,"formGroup"],["appearance","outlined"],["formArrayName","steps"],[1,"d-flex","justify-content-end","mb-2"],[3,"formGroupName"],[1,"col-md-12","mt-2"],["matButton","filled","cdkFocusInitial","",1,"success","me-2",3,"click","disabled"],[1,"medium-icon","fs-3","align-middle"],["type","button","matButton","filled",1,"error",3,"click"],["code","MANAGE_WORKFLOW"],["matButton","filled",1,"primary","me-2",3,"click"],[1,"medium-icon","fs-5","align-middle"],[1,"col-md-3"],[1,"d-flex"],[1,"form-group","w-100"],["formControlName","stepName","type","text",1,"form-control","w-100",3,"blur","placeholder"],[1,"col-md-1"],[1,"text-danger"],[1,"form-group"],["type","button","mat-icon-button","",1,"mt-3"],["type","button","mat-icon-button","",1,"mt-3",3,"click"],[1,"medium-icon","text-danger","fs-4","align-middle"]],template:function(t,n){t&1&&(r(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3),f(4,Oe,4,3,"span",4),f(5,Ge,4,3,"span",4),l()(),r(6,"div",5)(7,"form",6)(8,"mat-card",7)(9,"mat-card-content")(10,"div",8),f(11,We,6,3,"div",9),y(12,qe,12,10,"div",10,Pt),l(),r(14,"div",11)(15,"button",12),v("click",function(){return n.saveWorkflowSteps()}),s(16),p(17,"translate"),r(18,"mat-icon",13),s(19,"arrow_right"),l()(),r(20,"button",14),v("click",function(){return n.onPreviousClick()}),r(21,"mat-icon",13),s(22,"arrow_left"),l(),s(23),p(24,"translate"),l()()()()()()()()),t&2&&(a(4),_(n.workflowSteps.length==0?4:-1),a(),_(n.workflowSteps.length>0?5:-1),a(2),u("formGroup",n.stepFormGroup),a(4),_(n.workflowInstances.length==0?11:-1),a(),M(n.steps.controls),a(3),u("disabled",n.stepFormGroup.invalid||n.steps.length<2),a(),m(" ",c(17,7,"NEXT")," "),a(7),m(" ",c(24,9,"PREVIOUS")," "))},dependencies:[V,J,K,H,j,z,Y,Z,_t,bt,Q,q,U,Te,it,ot,tt,et,P,L,ft,$],encapsulation:2})};function Mt(){return o=>{let e=o.get("fromStepId")?.value,t=o.get("toStepId")?.value;return e&&t&&e===t?{sameStep:!0}:null}}var vt=class o{transform(e,t,n){if(n===0||t.length>0&&t[0]?.id)return e;let i=[];return t.forEach((d,g)=>{n>g&&(d.fromStepId&&!i?.find(C=>C===d.fromStepId)&&i.push(d.fromStepId),d.toStepId&&!i?.find(C=>C===d.toStepId)&&i.push(d.toStepId))}),e.filter(d=>i?.find(g=>g===d.id))}static \u0275fac=function(t){return new(t||o)};static \u0275pipe=Vt({name:"filter_workflow_step",type:o,pure:!0})};function Ft(){return o=>{let e=o.get("roleIds")?.value,t=o.get("userIds")?.value;return(!e||e?.length===0)&&(!t||t?.length===0)?{atLeastOneRequired:!0}:null}}var Ye=["button"],Ze=["*"];function Xe(o,e){if(o&1&&(r(0,"div",2),S(1,"mat-pseudo-checkbox",6),l()),o&2){let t=h();a(),u("disabled",t.disabled)}}var Ne=new xt("MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS",{providedIn:"root",factory:Je});function Je(){return{hideSingleSelectionIndicator:!1,hideMultipleSelectionIndicator:!1,disabledInteractive:!1}}var Re=new xt("MatButtonToggleGroup"),to={provide:pe,useExisting:Bt(()=>Nt),multi:!0},St=class{source;value;constructor(e,t){this.source=e,this.value=t}},Nt=(()=>{class o{_changeDetector=b(It);_dir=b(ee,{optional:!0});_multiple=!1;_disabled=!1;_disabledInteractive=!1;_selectionModel;_rawValue;_controlValueAccessorChangeFn=()=>{};_onTouched=()=>{};_buttonToggles;appearance;get name(){return this._name}set name(t){this._name=t,this._markButtonsForCheck()}_name=b(Et).getId("mat-button-toggle-group-");vertical;get value(){let t=this._selectionModel?this._selectionModel.selected:[];return this.multiple?t.map(n=>n.value):t[0]?t[0].value:void 0}set value(t){this._setSelectionByValue(t),this.valueChange.emit(this.value)}valueChange=new ct;get selected(){let t=this._selectionModel?this._selectionModel.selected:[];return this.multiple?t:t[0]||null}get multiple(){return this._multiple}set multiple(t){this._multiple=t,this._markButtonsForCheck()}get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._markButtonsForCheck()}get disabledInteractive(){return this._disabledInteractive}set disabledInteractive(t){this._disabledInteractive=t,this._markButtonsForCheck()}get dir(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}change=new ct;get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(t){this._hideSingleSelectionIndicator=t,this._markButtonsForCheck()}_hideSingleSelectionIndicator;get hideMultipleSelectionIndicator(){return this._hideMultipleSelectionIndicator}set hideMultipleSelectionIndicator(t){this._hideMultipleSelectionIndicator=t,this._markButtonsForCheck()}_hideMultipleSelectionIndicator;constructor(){let t=b(Ne,{optional:!0});this.appearance=t&&t.appearance?t.appearance:"standard",this.hideSingleSelectionIndicator=t?.hideSingleSelectionIndicator??!1,this.hideMultipleSelectionIndicator=t?.hideMultipleSelectionIndicator??!1}ngOnInit(){this._selectionModel=new ue(this.multiple,void 0,!1)}ngAfterContentInit(){this._selectionModel.select(...this._buttonToggles.filter(t=>t.checked)),this.multiple||this._initializeTabIndex()}writeValue(t){this.value=t,this._changeDetector.markForCheck()}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t}_keydown(t){if(this.multiple||this.disabled||te(t))return;let i=t.target.id,d=this._buttonToggles.toArray().findIndex(C=>C.buttonId===i),g=null;switch(t.keyCode){case 32:case 13:g=this._buttonToggles.get(d)||null;break;case 38:g=this._getNextButton(d,-1);break;case 37:g=this._getNextButton(d,this.dir==="ltr"?-1:1);break;case 40:g=this._getNextButton(d,1);break;case 39:g=this._getNextButton(d,this.dir==="ltr"?1:-1);break;default:return}g&&(t.preventDefault(),g._onButtonClick(),g.focus())}_emitChangeEvent(t){let n=new St(t,this.value);this._rawValue=n.value,this._controlValueAccessorChangeFn(n.value),this.change.emit(n)}_syncButtonToggle(t,n,i=!1,d=!1){!this.multiple&&this.selected&&!t.checked&&(this.selected.checked=!1),this._selectionModel?n?this._selectionModel.select(t):this._selectionModel.deselect(t):d=!0,d?Promise.resolve().then(()=>this._updateModelValue(t,i)):this._updateModelValue(t,i)}_isSelected(t){return this._selectionModel&&this._selectionModel.isSelected(t)}_isPrechecked(t){return typeof this._rawValue>"u"?!1:this.multiple&&Array.isArray(this._rawValue)?this._rawValue.some(n=>t.value!=null&&n===t.value):t.value===this._rawValue}_initializeTabIndex(){if(this._buttonToggles.forEach(t=>{t.tabIndex=-1}),this.selected)this.selected.tabIndex=0;else for(let t=0;t<this._buttonToggles.length;t++){let n=this._buttonToggles.get(t);if(!n.disabled){n.tabIndex=0;break}}}_getNextButton(t,n){let i=this._buttonToggles;for(let d=1;d<=i.length;d++){let g=(t+n*d+i.length)%i.length,C=i.get(g);if(C&&!C.disabled)return C}return null}_setSelectionByValue(t){if(this._rawValue=t,!this._buttonToggles)return;let n=this._buttonToggles.toArray();if(this.multiple&&t?(Array.isArray(t),this._clearSelection(),t.forEach(i=>this._selectValue(i,n))):(this._clearSelection(),this._selectValue(t,n)),!this.multiple&&n.every(i=>i.tabIndex===-1)){for(let i of n)if(!i.disabled){i.tabIndex=0;break}}}_clearSelection(){this._selectionModel.clear(),this._buttonToggles.forEach(t=>{t.checked=!1,this.multiple||(t.tabIndex=-1)})}_selectValue(t,n){for(let i of n)if(i.value===t){i.checked=!0,this._selectionModel.select(i),this.multiple||(i.tabIndex=0);break}}_updateModelValue(t,n){n&&this._emitChangeEvent(t),this.valueChange.emit(this.value)}_markButtonsForCheck(){this._buttonToggles?.forEach(t=>t._markForCheck())}static \u0275fac=function(n){return new(n||o)};static \u0275dir=Dt({type:o,selectors:[["mat-button-toggle-group"]],contentQueries:function(n,i,d){if(n&1&&lt(d,kt,5),n&2){let g;A(g=O())&&(i._buttonToggles=g)}},hostAttrs:[1,"mat-button-toggle-group"],hostVars:6,hostBindings:function(n,i){n&1&&v("keydown",function(g){return i._keydown(g)}),n&2&&(B("role",i.multiple?"group":"radiogroup")("aria-disabled",i.disabled),Ct("mat-button-toggle-vertical",i.vertical)("mat-button-toggle-group-appearance-standard",i.appearance==="standard"))},inputs:{appearance:"appearance",name:"name",vertical:[2,"vertical","vertical",N],value:"value",multiple:[2,"multiple","multiple",N],disabled:[2,"disabled","disabled",N],disabledInteractive:[2,"disabledInteractive","disabledInteractive",N],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",N],hideMultipleSelectionIndicator:[2,"hideMultipleSelectionIndicator","hideMultipleSelectionIndicator",N]},outputs:{valueChange:"valueChange",change:"change"},exportAs:["matButtonToggleGroup"],features:[zt([to,{provide:Re,useExisting:o}])]})}return o})(),kt=(()=>{class o{_changeDetectorRef=b(It);_elementRef=b(Gt);_focusMonitor=b(Xt);_idGenerator=b(Et);_animationDisabled=oe();_checked=!1;ariaLabel;ariaLabelledby=null;_buttonElement;buttonToggleGroup;get buttonId(){return`${this.id}-button`}id;name;value;get tabIndex(){return this._tabIndex()}set tabIndex(t){this._tabIndex.set(t)}_tabIndex;disableRipple;get appearance(){return this.buttonToggleGroup?this.buttonToggleGroup.appearance:this._appearance}set appearance(t){this._appearance=t}_appearance;get checked(){return this.buttonToggleGroup?this.buttonToggleGroup._isSelected(this):this._checked}set checked(t){t!==this._checked&&(this._checked=t,this.buttonToggleGroup&&this.buttonToggleGroup._syncButtonToggle(this,this._checked),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled||this.buttonToggleGroup&&this.buttonToggleGroup.disabled}set disabled(t){this._disabled=t}_disabled=!1;get disabledInteractive(){return this._disabledInteractive||this.buttonToggleGroup!==null&&this.buttonToggleGroup.disabledInteractive}set disabledInteractive(t){this._disabledInteractive=t}_disabledInteractive;change=new ct;constructor(){b(Jt).load(ne);let t=b(Re,{optional:!0}),n=b(new Yt("tabindex"),{optional:!0})||"",i=b(Ne,{optional:!0});this._tabIndex=Ot(parseInt(n)||0),this.buttonToggleGroup=t,this.appearance=i&&i.appearance?i.appearance:"standard",this.disabledInteractive=i?.disabledInteractive??!1}ngOnInit(){let t=this.buttonToggleGroup;this.id=this.id||this._idGenerator.getId("mat-button-toggle-"),t&&(t._isPrechecked(this)?this.checked=!0:t._isSelected(this)!==this._checked&&t._syncButtonToggle(this,this._checked))}ngAfterViewInit(){this._animationDisabled||this._elementRef.nativeElement.classList.add("mat-button-toggle-animations-enabled"),this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){let t=this.buttonToggleGroup;this._focusMonitor.stopMonitoring(this._elementRef),t&&t._isSelected(this)&&t._syncButtonToggle(this,!1,!1,!0)}focus(t){this._buttonElement.nativeElement.focus(t)}_onButtonClick(){if(this.disabled)return;let t=this.isSingleSelector()?!0:!this._checked;if(t!==this._checked&&(this._checked=t,this.buttonToggleGroup&&(this.buttonToggleGroup._syncButtonToggle(this,this._checked,!0),this.buttonToggleGroup._onTouched())),this.isSingleSelector()){let n=this.buttonToggleGroup._buttonToggles.find(i=>i.tabIndex===0);n&&(n.tabIndex=-1),this.tabIndex=0}this.change.emit(new St(this,this.value))}_markForCheck(){this._changeDetectorRef.markForCheck()}_getButtonName(){return this.isSingleSelector()?this.buttonToggleGroup.name:this.name||null}isSingleSelector(){return this.buttonToggleGroup&&!this.buttonToggleGroup.multiple}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=R({type:o,selectors:[["mat-button-toggle"]],viewQuery:function(n,i){if(n&1&&mt(Ye,5),n&2){let d;A(d=O())&&(i._buttonElement=d.first)}},hostAttrs:["role","presentation",1,"mat-button-toggle"],hostVars:14,hostBindings:function(n,i){n&1&&v("focus",function(){return i.focus()}),n&2&&(B("aria-label",null)("aria-labelledby",null)("id",i.id)("name",null),Ct("mat-button-toggle-standalone",!i.buttonToggleGroup)("mat-button-toggle-checked",i.checked)("mat-button-toggle-disabled",i.disabled)("mat-button-toggle-disabled-interactive",i.disabledInteractive)("mat-button-toggle-appearance-standard",i.appearance==="standard"))},inputs:{ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],id:"id",name:"name",value:"value",tabIndex:"tabIndex",disableRipple:[2,"disableRipple","disableRipple",N],appearance:"appearance",checked:[2,"checked","checked",N],disabled:[2,"disabled","disabled",N],disabledInteractive:[2,"disabledInteractive","disabledInteractive",N]},outputs:{change:"change"},exportAs:["matButtonToggle"],ngContentSelectors:Ze,decls:7,vars:13,consts:[["button",""],["type","button",1,"mat-button-toggle-button","mat-focus-indicator",3,"click","id","disabled"],[1,"mat-button-toggle-checkbox-wrapper"],[1,"mat-button-toggle-label-content"],[1,"mat-button-toggle-focus-overlay"],["matRipple","",1,"mat-button-toggle-ripple",3,"matRippleTrigger","matRippleDisabled"],["state","checked","aria-hidden","true","appearance","minimal",3,"disabled"]],template:function(n,i){if(n&1){let d=F();Ut(),r(0,"button",1,0),v("click",function(){return k(d),w(i._onButtonClick())}),f(2,Xe,2,1,"div",2),r(3,"span",3),qt(4),l()(),S(5,"span",4)(6,"span",5)}if(n&2){let d=$t(1);u("id",i.buttonId)("disabled",i.disabled&&!i.disabledInteractive||null),B("role",i.isSingleSelector()?"radio":"button")("tabindex",i.disabled&&!i.disabledInteractive?-1:i.tabIndex)("aria-pressed",i.isSingleSelector()?null:i.checked)("aria-checked",i.isSingleSelector()?i.checked:null)("name",i._getButtonName())("aria-label",i.ariaLabel)("aria-labelledby",i.ariaLabelledby)("aria-disabled",i.disabled&&i.disabledInteractive?"true":null),a(2),_(i.buttonToggleGroup&&(!i.buttonToggleGroup.multiple&&!i.buttonToggleGroup.hideSingleSelectionIndicator||i.buttonToggleGroup.multiple&&!i.buttonToggleGroup.hideMultipleSelectionIndicator)?2:-1),a(4),u("matRippleTrigger",d)("matRippleDisabled",i.disableRipple||i.disabled)}},dependencies:[ie,ge],styles:[`.mat-button-toggle-standalone,.mat-button-toggle-group{position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;-webkit-tap-highlight-color:rgba(0,0,0,0);border-radius:var(--mat-button-toggle-legacy-shape);transform:translateZ(0)}.mat-button-toggle-standalone:not([class*=mat-elevation-z]),.mat-button-toggle-group:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}@media(forced-colors: active){.mat-button-toggle-standalone,.mat-button-toggle-group{outline:solid 1px}}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{border-radius:var(--mat-button-toggle-shape, var(--mat-sys-corner-extra-large));border:solid 1px var(--mat-button-toggle-divider-color, var(--mat-sys-outline))}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard .mat-pseudo-checkbox,.mat-button-toggle-group-appearance-standard .mat-pseudo-checkbox{--mat-pseudo-checkbox-minimal-selected-checkmark-color: var(--mat-button-toggle-selected-state-text-color, var(--mat-sys-on-secondary-container))}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard:not([class*=mat-elevation-z]),.mat-button-toggle-group-appearance-standard:not([class*=mat-elevation-z]){box-shadow:none}@media(forced-colors: active){.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{outline:0}}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative;color:var(--mat-button-toggle-legacy-text-color);font-family:var(--mat-button-toggle-legacy-label-text-font);font-size:var(--mat-button-toggle-legacy-label-text-size);line-height:var(--mat-button-toggle-legacy-label-text-line-height);font-weight:var(--mat-button-toggle-legacy-label-text-weight);letter-spacing:var(--mat-button-toggle-legacy-label-text-tracking);--mat-pseudo-checkbox-minimal-selected-checkmark-color: var(--mat-button-toggle-legacy-selected-state-text-color)}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:var(--mat-button-toggle-legacy-focus-state-layer-opacity)}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle-checkbox-wrapper{display:inline-block;justify-content:flex-start;align-items:center;width:0;height:18px;line-height:18px;overflow:hidden;box-sizing:border-box;position:absolute;top:50%;left:16px;transform:translate3d(0, -50%, 0)}[dir=rtl] .mat-button-toggle-checkbox-wrapper{left:auto;right:16px}.mat-button-toggle-appearance-standard .mat-button-toggle-checkbox-wrapper{left:12px}[dir=rtl] .mat-button-toggle-appearance-standard .mat-button-toggle-checkbox-wrapper{left:auto;right:12px}.mat-button-toggle-checked .mat-button-toggle-checkbox-wrapper{width:18px}.mat-button-toggle-animations-enabled .mat-button-toggle-checkbox-wrapper{transition:width 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-button-toggle-vertical .mat-button-toggle-checkbox-wrapper{transition:none}.mat-button-toggle-checked{color:var(--mat-button-toggle-legacy-selected-state-text-color);background-color:var(--mat-button-toggle-legacy-selected-state-background-color)}.mat-button-toggle-disabled{pointer-events:none;color:var(--mat-button-toggle-legacy-disabled-state-text-color);background-color:var(--mat-button-toggle-legacy-disabled-state-background-color);--mat-pseudo-checkbox-minimal-disabled-selected-checkmark-color: var(--mat-button-toggle-legacy-disabled-state-text-color)}.mat-button-toggle-disabled.mat-button-toggle-checked{background-color:var(--mat-button-toggle-legacy-disabled-selected-state-background-color)}.mat-button-toggle-disabled-interactive{pointer-events:auto}.mat-button-toggle-appearance-standard{color:var(--mat-button-toggle-text-color, var(--mat-sys-on-surface));background-color:var(--mat-button-toggle-background-color, transparent);font-family:var(--mat-button-toggle-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-toggle-label-text-size, var(--mat-sys-label-large-size));line-height:var(--mat-button-toggle-label-text-line-height, var(--mat-sys-label-large-line-height));font-weight:var(--mat-button-toggle-label-text-weight, var(--mat-sys-label-large-weight));letter-spacing:var(--mat-button-toggle-label-text-tracking, var(--mat-sys-label-large-tracking))}.mat-button-toggle-group-appearance-standard .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:solid 1px var(--mat-button-toggle-divider-color, var(--mat-sys-outline))}[dir=rtl] .mat-button-toggle-group-appearance-standard .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:none;border-right:solid 1px var(--mat-button-toggle-divider-color, var(--mat-sys-outline))}.mat-button-toggle-group-appearance-standard.mat-button-toggle-vertical .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:none;border-right:none;border-top:solid 1px var(--mat-button-toggle-divider-color, var(--mat-sys-outline))}.mat-button-toggle-appearance-standard.mat-button-toggle-checked{color:var(--mat-button-toggle-selected-state-text-color, var(--mat-sys-on-secondary-container));background-color:var(--mat-button-toggle-selected-state-background-color, var(--mat-sys-secondary-container))}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled{color:var(--mat-button-toggle-disabled-state-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-button-toggle-disabled-state-background-color, transparent)}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled .mat-pseudo-checkbox{--mat-pseudo-checkbox-minimal-disabled-selected-checkmark-color: var(--mat-button-toggle-disabled-selected-state-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled.mat-button-toggle-checked{color:var(--mat-button-toggle-disabled-selected-state-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-button-toggle-disabled-selected-state-background-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{background-color:var(--mat-button-toggle-state-layer-color, var(--mat-sys-on-surface))}.mat-button-toggle-appearance-standard:hover .mat-button-toggle-focus-overlay{opacity:var(--mat-button-toggle-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-button-toggle-appearance-standard.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:var(--mat-button-toggle-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}@media(hover: none){.mat-button-toggle-appearance-standard:hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;user-select:none;display:inline-block;padding:0 16px;line-height:var(--mat-button-toggle-legacy-height);position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px;line-height:var(--mat-button-toggle-height, 40px)}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;pointer-events:none;opacity:0;background-color:var(--mat-button-toggle-legacy-state-layer-color)}@media(forced-colors: active){.mat-button-toggle-checked .mat-button-toggle-focus-overlay{border-bottom:solid 500px;opacity:.5;height:0}.mat-button-toggle-checked:hover .mat-button-toggle-focus-overlay{opacity:.6}.mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-animations-enabled .mat-button-toggle-button{transition:padding 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-button-toggle-vertical .mat-button-toggle-button{transition:none}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}.mat-button-toggle-checked .mat-button-toggle-button:has(.mat-button-toggle-checkbox-wrapper){padding-left:30px}[dir=rtl] .mat-button-toggle-checked .mat-button-toggle-button:has(.mat-button-toggle-checkbox-wrapper){padding-left:0;padding-right:30px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard{--mat-focus-indicator-border-radius: var(--mat-button-toggle-shape, var(--mat-sys-corner-extra-large))}.mat-button-toggle-group-appearance-standard:not(.mat-button-toggle-vertical) .mat-button-toggle:last-of-type .mat-button-toggle-button::before{border-top-right-radius:var(--mat-button-toggle-shape, var(--mat-sys-corner-extra-large));border-bottom-right-radius:var(--mat-button-toggle-shape, var(--mat-sys-corner-extra-large))}.mat-button-toggle-group-appearance-standard:not(.mat-button-toggle-vertical) .mat-button-toggle:first-of-type .mat-button-toggle-button::before{border-top-left-radius:var(--mat-button-toggle-shape, var(--mat-sys-corner-extra-large));border-bottom-left-radius:var(--mat-button-toggle-shape, var(--mat-sys-corner-extra-large))}.mat-button-toggle-group-appearance-standard.mat-button-toggle-vertical .mat-button-toggle:last-of-type .mat-button-toggle-button::before{border-bottom-right-radius:var(--mat-button-toggle-shape, var(--mat-sys-corner-extra-large));border-bottom-left-radius:var(--mat-button-toggle-shape, var(--mat-sys-corner-extra-large))}.mat-button-toggle-group-appearance-standard.mat-button-toggle-vertical .mat-button-toggle:first-of-type .mat-button-toggle-button::before{border-top-right-radius:var(--mat-button-toggle-shape, var(--mat-sys-corner-extra-large));border-top-left-radius:var(--mat-button-toggle-shape, var(--mat-sys-corner-extra-large))}
`],encapsulation:2,changeDetection:0})}return o})(),Be=(()=>{class o{static \u0275fac=function(n){return new(n||o)};static \u0275mod=Wt({type:o});static \u0275inj=At({imports:[yt,ae,kt,yt]})}return o})();var oo=["graph"],io=()=>({orientation:"TB"}),wt=(o,e)=>e.id;function no(o,e){o&1&&(r(0,"span",8),s(1),p(2,"translate"),S(3,"app-page-help-text",19),l()),o&2&&(a(),x(c(2,1,"ADD_WORKFLOW_TRANSITIONS")))}function ao(o,e){o&1&&(r(0,"span",8),s(1),p(2,"translate"),S(3,"app-page-help-text",19),l()),o&2&&(a(),x(c(2,1,"EDIT_WORKFLOW_TRANSITIONS")))}function ro(o,e){if(o&1){let t=F();r(0,"div",14)(1,"button",20),v("click",function(){k(t);let i=h();return w(i.addTransition())}),r(2,"mat-icon",21),s(3,"add"),l(),s(4),p(5,"translate"),l()()}o&2&&(a(4),m(" ",c(5,1,"ADD_ANOTHER_TRANSITION")," "))}function lo(o,e){o&1&&(r(0,"div",33),s(1),p(2,"translate"),l()),o&2&&(a(),m(" ",c(2,1,"TRANSITION_NAME_REQUIRED")," "))}function so(o,e){o&1&&(r(0,"div",33),s(1),p(2,"translate"),l()),o&2&&(a(),m(" ",c(2,1,"TRANSITION_NAME_MUST_BE_UNIQUE")," "))}function po(o,e){if(o&1&&(r(0,"div"),f(1,lo,3,3,"div",33),f(2,so,3,3,"div",33),l()),o&2){let t,n,i=h().$implicit;a(),_(!((t=i.get("name"))==null||t.errors==null)&&t.errors.required?1:-1),a(),_(!((n=i.get("name"))==null||n.errors==null)&&n.errors.notUnique?2:-1)}}function co(o,e){if(o&1&&(r(0,"mat-option",28),s(1),l()),o&2){let t=e.$implicit;u("value",t.id),a(),m(" ",t.stepName," ")}}function mo(o,e){o&1&&(r(0,"div",33),s(1),p(2,"translate"),l()),o&2&&(a(),m(" ",c(2,1,"FROM_STEP_REQUIRED")," "))}function uo(o,e){o&1&&(r(0,"mat-error"),s(1),p(2,"translate"),l()),o&2&&(a(),m(" ",c(2,1,"FROM_TO_STEP_NOT_SAME")," "))}function go(o,e){if(o&1&&(r(0,"div"),f(1,mo,3,3,"div",33),f(2,uo,3,3,"mat-error"),l()),o&2){let t,n=h().$implicit;a(),_(!((t=n.get("fromStepId"))==null||t.errors==null)&&t.errors.required?1:-1),a(),_(n!=null&&n.hasError("sameStep")?2:-1)}}function fo(o,e){if(o&1&&(r(0,"mat-option",28),s(1),l()),o&2){let t=e.$implicit;u("value",t.id),a(),m(" ",t.stepName," ")}}function _o(o,e){o&1&&(r(0,"div",33),s(1),p(2,"translate"),l()),o&2&&(a(),m(" ",c(2,1,"TO_STEP_REQUIRED")," "))}function bo(o,e){o&1&&(r(0,"div",33),s(1),p(2,"translate"),l()),o&2&&(a(),m(" ",c(2,1,"FROM_TO_STEP_NOT_SAME")," "))}function ho(o,e){if(o&1&&(r(0,"div"),f(1,_o,3,3,"div",33),f(2,bo,3,3,"div",33),l()),o&2){let t,n=h().$implicit;a(),_(!((t=n.get("toStepId"))==null||t.errors==null)&&t.errors.required?1:-1),a(),_(!(n==null||n.errors==null)&&n.errors.sameStep?2:-1)}}function vo(o,e){if(o&1&&(r(0,"mat-option",28),s(1),l()),o&2){let t=e.$implicit;u("value",t.id),a(),m(" ",t.name," ")}}function So(o,e){o&1&&(r(0,"mat-error",33),s(1),p(2,"translate"),l()),o&2&&(a(),m(" ",c(2,1,"AT_LEAST_ONE_REQUIRED")," "))}function ko(o,e){if(o&1&&(r(0,"mat-option",28),s(1),l()),o&2){let t=e.$implicit;u("value",t.id),a(),Ht(" ",t.firstName," \xA0\xA0 ",t.lastName," ")}}function wo(o,e){if(o&1&&(r(0,"mat-option",28),s(1),l()),o&2){let t=e.$implicit;u("value",t),a(),m(" ",t," ")}}function To(o,e){if(o&1&&(r(0,"mat-option",28),s(1),l()),o&2){let t=e.$implicit;u("value",t),a(),m(" ",t," ")}}function xo(o,e){if(o&1&&(r(0,"mat-option",28),s(1),l()),o&2){let t=e.$implicit;u("value",t),a(),m(" ",t," ")}}function Co(o,e){if(o&1){let t=F();r(0,"button",61),v("click",function(){k(t);let i=h().$index,d=h();return w(d.removeTransition(i))}),r(1,"mat-icon",33),s(2,"delete"),l()()}}function Io(o,e){if(o&1){let t=F();r(0,"button",20),v("click",function(){k(t);let i=h(2);return w(i.addTransition())}),r(1,"mat-icon",21),s(2,"add"),l(),s(3),p(4,"translate"),l()}o&2&&(a(3),m(" ",c(4,1,"ADD_ANOTHER_TRANSITION")," "))}function Eo(o,e){if(o&1){let t=F();r(0,"div",16)(1,"mat-card",22)(2,"mat-card-content")(3,"div",9)(4,"div",23)(5,"div",24)(6,"label",25),s(7),p(8,"translate"),r(9,"sup"),s(10,"*"),l()(),r(11,"input",26),p(12,"translate"),v("blur",function(){k(t);let i=h();return w(i.onTransitionChange())})("blur",function(){let i=k(t).$index,d=h();return w(d.checkUniqueTransitionName(i))}),l(),f(13,po,3,2,"div"),l()(),r(14,"div",23)(15,"div",24),jt(16),p(17,"filter_workflow_step"),r(18,"label",25),s(19),p(20,"translate"),r(21,"sup"),s(22,"*"),l()(),r(23,"mat-select",27),p(24,"translate"),v("selectionChange",function(){let i=k(t).$index,d=h();return w(d.filterSteps(i))}),y(25,co,2,2,"mat-option",28,wt),l(),f(27,go,3,2,"div"),l()(),r(28,"div",23)(29,"div",24)(30,"label",25),s(31),p(32,"translate"),r(33,"sup"),s(34,"*"),l()(),r(35,"mat-select",29),p(36,"translate"),v("selectionChange",function(){let i=k(t).$index,d=h();return w(d.filterSteps(i))}),y(37,fo,2,2,"mat-option",28,wt),l(),f(39,ho,3,2,"div"),l()()(),r(40,"div",9)(41,"div",30)(42,"div",24)(43,"label",31),s(44),p(45,"translate"),l(),r(46,"mat-select",32),p(47,"translate"),y(48,vo,2,2,"mat-option",28,wt),l(),f(50,So,3,3,"mat-error",33),l()(),r(51,"div",30)(52,"div",24)(53,"label"),s(54),p(55,"translate"),l(),r(56,"mat-select",34),p(57,"translate"),y(58,ko,2,3,"mat-option",28,wt),l()()()(),r(60,"div",9)(61,"div",35)(62,"div",36)(63,"label"),s(64),p(65,"translate"),l(),r(66,"mat-button-toggle-group",37)(67,"mat-button-toggle",38),s(68),p(69,"translate"),l(),r(70,"mat-button-toggle",39),s(71),p(72,"translate"),l(),r(73,"mat-button-toggle",40),s(74),p(75,"translate"),l(),r(76,"mat-button-toggle",41),s(77),p(78,"translate"),l(),r(79,"mat-button-toggle",42),s(80),p(81,"translate"),l(),r(82,"mat-button-toggle",43),s(83),p(84,"translate"),l(),r(85,"mat-button-toggle",44),s(86),p(87,"translate"),l(),r(88,"mat-button-toggle",45),s(89),p(90,"translate"),l()()()()(),r(91,"div",9)(92,"div",30)(93,"div",46)(94,"mat-checkbox",47),s(95),p(96,"translate"),l()()(),r(97,"div",30)(98,"div",24)(99,"mat-checkbox",48),s(100),p(101,"translate"),l()()()(),r(102,"div",9)(103,"div",49)(104,"label"),s(105),p(106,"translate"),l()()(),r(107,"div",9)(108,"div",30)(109,"div",24)(110,"label"),s(111),p(112,"translate"),l(),r(113,"mat-select",50),p(114,"translate"),y(115,wo,2,2,"mat-option",28,rt),l()()(),r(117,"div",51)(118,"div",24)(119,"label"),s(120),p(121,"translate"),l(),r(122,"mat-select",52),p(123,"translate"),y(124,To,2,2,"mat-option",28,rt),l()()(),r(126,"div",51)(127,"div",24)(128,"label"),s(129),p(130,"translate"),l(),r(131,"mat-select",53),p(132,"translate"),y(133,xo,2,2,"mat-option",28,rt),l()()()(),r(135,"div",9)(136,"div",35)(137,"div",24),f(138,Co,3,0,"button",54),l()()(),r(139,"div",55),f(140,Io,5,3,"button",56),r(141,"button",57),v("click",function(){k(t);let i=h();return w(i.saveTransition())}),r(142,"mat-icon",58),s(143,"save"),l(),s(144),p(145,"translate"),l(),r(146,"button",59),v("click",function(){k(t);let i=h();return w(i.onPreviousClick())}),r(147,"mat-icon",60),s(148,"arrow_left"),l(),s(149),p(150,"translate"),l()()()()()}if(o&2){let t,n,i,d,g=e.$implicit,C=e.$index,E=h();u("formGroupName",C),a(7),m(" ",c(8,46,"TRANSITION_NAME")," "),a(4),u("placeholder",T(c(12,48,"ENTER_THE_WORKFLOW_TRANSITION_NAME"))),a(2),_((t=g.get("name"))!=null&&t.touched&&((t=g.get("name"))!=null&&t.errors)?13:-1);let Ae=Kt(17,50,E.workflowSteps,E.transitions.value,C);a(6),m("",c(20,54,"FROM_STEP")," "),a(4),u("placeholder",T(c(24,56,"SELECT_FROM_STEP"))),a(2),M(Ae),a(2),_((n=g.get("fromStepId"))!=null&&n.touched&&((n=g.get("fromStepId"))!=null&&n.errors)?27:-1),a(4),m("",c(32,58,"TO_STEP")," "),a(4),u("placeholder",T(c(36,60,"SELECT_TO_STEP"))),a(2),M(E.workflowSteps),a(2),_((i=g.get("toStepId"))!=null&&i.touched&&((i=g.get("toStepId"))!=null&&i.errors||g.errors)?39:-1),a(5),m(" ",c(45,62,"ROLES")," "),a(2),u("placeholder",T(c(47,64,"SELECT_ROLES"))),a(2),M(E.workflowStore.roles()),a(2),_(((d=g.get("roleIds"))!=null&&d.touched||(d=g.get("userIds"))!=null&&d.touched)&&(g!=null&&g.hasError("atLeastOneRequired"))?50:-1),a(4),m(" ",c(55,66,"USERS")),a(2),u("placeholder",T(c(57,68,"SELECT_USERS"))),a(2),M(E.workflowStore.users()),a(6),m(" ",c(65,70,"COLOR_OF_TRANSITON_BUTTON")),a(4),m("",c(69,72,"APPROVED")," "),a(3),m("",c(72,74,"REJECTED")," "),a(3),m("",c(75,76,"PENDING")," "),a(3),m("",c(78,78,"INPROGRESS")," "),a(3),m("",c(81,80,"ONHOLD")," "),a(3),m("",c(84,82,"CANCELLED")," "),a(3),m("",c(87,84,"ESCALATED")," "),a(3),m("",c(90,86,"COMPLETED")," "),a(6),m(" ",c(96,88,"IS_SIGNATURE_REQUIRED")," "),a(5),m(" ",c(101,90,"UPLOAD_DOC_VER_REQUIRED")," "),a(5),x(c(106,92,"REMINDER_DAYS")),a(6),x(c(112,94,"DAYS")),a(2),u("placeholder",T(c(114,96,"DAYS"))),a(2),M(E.getDays()),a(5),x(c(121,98,"REMINDER_HOURS")),a(2),u("placeholder",T(c(123,100,"REMINDER_HOURS"))),a(2),M(E.getHours()),a(5),x(c(130,102,"REMINDER_MINUTES")),a(2),u("placeholder",T(c(132,104,"REMINDER_MINUTES"))),a(2),M(E.getMinutes()),a(5),_(E.workflowInstances.length==0?138:-1),a(2),_(E.workflowInstances.length==0?140:-1),a(),u("disabled",E.transitionFormGroup.invalid),a(3),m(" ",c(145,106,"SAVE")," "),a(5),m(" ",c(150,108,"PREVIOUS")," ")}}function yo(o,e){o&1&&(pt(),r(0,"marker",62),S(1,"path",63),l())}function Mo(o,e){if(o&1&&(pt(),r(0,"g",64),S(1,"rect"),r(2,"text",65),s(3),l()()),o&2){let t=e.$implicit;a(),B("width",t.dimension.width)("height",t.dimension.height)("fill",t.data.color),a(),B("x",10)("y",t.dimension.height/2),a(),m(" ",t.label," ")}}function Fo(o,e){if(o&1&&(pt(),r(0,"g",66),S(1,"path",67),r(2,"text",68)(3,"textPath",69),s(4),l()()()),o&2){let t=e.$implicit;a(3),Qt("dominant-baseline",t.dominantBaseline),B("href","#"+t.id),a(),m(" ",t.label," ")}}var at=class o{fb=b(X);workflowStore=b(G);clonerService=b(le);router=b(D);transitionFormGroup;isLoading=!1;currentStep=2;nodes=[];links=[];currentWorkflow=this.workflowStore.currentWorkflow();workflowSteps=this.currentWorkflow?.workflowSteps??[];workflowTransitions=this.currentWorkflow?.workflowTransitions??[];workflowInstances=this.currentWorkflow?.workflowInstances??[];graph;constructor(){W(()=>{let e=this.workflowStore.currentStep();e!==this.currentStep&&(this.currentStep=e,e===1?this.onPreviousClick():this.goToWorkflow())})}get transitions(){return this.transitionFormGroup.get("transitions")}goToWorkflow(){this.router.navigate(["/workflow-settings"])}ngOnInit(){if(this.nodes=this.workflowSteps?.map(e=>({id:e.id??"",label:e.stepName,data:e})),this.transitionFormGroup=this.fb.group({transitions:this.fb.array([])}),this.workflowTransitions&&this.workflowTransitions?.length===0)this.initialTransition();else{for(let e=0;e<this.workflowTransitions.length;e++)this.addTransition(this.workflowTransitions[e]);this.addAllLink()}}ngAfterViewInit(){setTimeout(()=>{this.graph&&this.graph?.zoomToFit()})}checkUniqueTransitionName(e){let t=this.transitions.at(e).get("name")?.value;if(this.transitions.controls.some((i,d)=>d!==e&&i.get("name")?.value===t))this.transitions.at(e).get("name")?.setErrors({notUnique:!0});else{let i=this.transitions.at(e).get("name")?.errors;i&&(Object.keys(i).length===0?this.transitions.at(e).get("name")?.setErrors(null):this.transitions.at(e).get("name")?.setErrors(i))}}filterSteps(e){this.removeFormItem(e),this.addAllLink()}removeFormItem(e){if(e==this.transitions.length-1)return;let t=this.transitions.length;for(let n=e+1;n<t;n++)this.transitions.removeAt(e+1)}addAllLink(){let e=this.transitions.getRawValue().filter(t=>t.fromStepId&&t.toStepId&&t.name);e.length>0&&(this.links=this.clonerService.deepClone(e.map(t=>({source:t.fromStepId,target:t.toStepId,label:t.name}))))}initialTransition(){this.transitions.push(this.fb.group({id:[null],name:["",I.required],fromStepId:["",I.required],toStepId:["",I.required],isFirstTransaction:[!0],isUploadDocumentVersion:[!1],isSignatureRequired:[!1],workflowId:[null],color:["inprogress"],days:[0],hours:[0],minutes:[0],roleIds:[null],userIds:[null],orderNo:[0]},{validators:[Mt(),Ft()]}))}onTransitionChange(){this.addAllLink()}getDays(){return Array.from({length:32},(e,t)=>t)}getHours(){return Array.from({length:24},(e,t)=>t)}getMinutes(){return Array.from({length:60},(e,t)=>t)}addTransition(e){this.transitions.valid?this.transitions.push(this.fb.group({id:[e?.id||null],name:[e?.name||"",I.required],fromStepId:[{value:e?.fromStepId||"",disabled:!!e?.id},[I.required]],toStepId:[{value:e?.toStepId||"",disabled:!!e?.id},[I.required]],isFirstTransaction:[e?.isFirstTransaction||!1],isUploadDocumentVersion:[e?.isUploadDocumentVersion||!1],isSignatureRequired:[e?.isSignatureRequired||!1],workflowId:[this.currentWorkflow?.id||null],days:[e?.days||0],hours:[e?.hours||0],minutes:[e?.minutes||0],color:[e?.color||"inprogress"],orderNo:[e?.orderNo||0],roleIds:[e?.workflowTransitionRoles?.map(t=>t.roleId)||null],userIds:[e?.workflowTransitionUsers?.map(t=>t.userId)||null]},{validators:[Mt(),Ft()]})):this.transitionFormGroup.markAllAsTouched()}removeTransition(e){this.removeFormItem(e),this.transitions.removeAt(e),this.transitions.length===0&&this.initialTransition(),this.addAllLink()}saveTransition(){if(this.transitionFormGroup.invalid){this.transitionFormGroup.markAllAsTouched();return}this.isLoading=!0;let e=this.transitions.getRawValue().map(t=>dt(st({},t),{workflowId:this.currentWorkflow?.id??""}));e[0].id?(e[0].isFirstTransaction=!0,this.workflowStore.updateWorkflowTransition(e)):this.workflowStore.addWorkflowTransition(e)}onPreviousClick(){this.workflowStore.setCurrentStep(1),this.router.navigate(["/workflow-settings/manage/manage-steps"])}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=R({type:o,selectors:[["app-manage-transition"]],viewQuery:function(t,n){if(t&1&&mt(oo,5),t&2){let i;A(i=O())&&(n.graph=i.first)}},decls:27,vars:12,consts:[["graph",""],["defsTemplate",""],["nodeTemplate",""],["linkTemplate",""],[1,"content"],[1,"container-fluid"],[1,"d-flex","mb-2"],[1,"me-auto"],[1,"mb-0","page-title"],[1,"row"],[1,"col-sm-9"],[3,"formGroup"],["appearance","outlined"],["formArrayName","transitions"],[1,"d-flex","justify-content-end","mb-2"],[1,"col-sm-12"],[3,"formGroupName"],[1,"col-sm-3"],[1,"chart-container",3,"layoutSettings","links","nodes","layout","panOnZoom","autoCenter","autoZoom"],["code","MANAGE_WORKFLOW"],["type","button","matButton","filled",1,"primary","me-2",3,"click"],[1,"medium-icon","fs-5","align-middle"],["appearance","outlined",1,"mb-3"],[1,"col-md-4"],[1,"form-group"],[1,"form-lable","text-danger"],["formControlName","name","type","text",1,"form-control",3,"blur","placeholder"],["panelClass","mat-select-control","formControlName","fromStepId",1,"form-control",3,"selectionChange","placeholder"],[3,"value"],["panelClass","mat-select-control","formControlName","toStepId",1,"form-control",3,"selectionChange","placeholder"],[1,"col-md-6"],[1,"form-lable"],["panelClass","mat-select-control","multiple","","formControlName","roleIds","name","role",1,"form-control",3,"placeholder"],[1,"text-danger"],["panelClass","mat-select-control","multiple","","formControlName","userIds","name","user",1,"form-control",3,"placeholder"],[1,"col-md-12"],[1,"d-flex","flex-column"],["appearance","standard","formControlName","color",1,"custom-toggle-group"],["value","approved",1,"approved"],["value","rejected",1,"rejected"],["value","pending",1,"pending"],["value","inprogress",1,"inprogress"],["value","onhold",1,"onhold"],["value","cancelled",1,"cancelled"],["value","escalated",1,"escalated"],["value","completed",1,"completed"],[1,"form-group","mt-3"],["color","primary","formControlName","isSignatureRequired",1,"example-margin"],["color","primary","formControlName","isUploadDocumentVersion",1,"pt-3"],[1,"col-sm"],["panelClass","mat-select-control","formControlName","days",1,"form-control",3,"placeholder"],[1,"col-md-3"],["panelClass","mat-select-control","formControlName","hours",1,"form-control",3,"placeholder"],["panelClass","mat-select-control","formControlName","minutes",1,"form-control",3,"placeholder"],["type","button","mat-icon-button","","color","warn"],[1,"d-flex","gap-1","mt-4"],["type","button","matButton","filled",1,"primary","me-2"],["matButton","filled","cdkFocusInitial","",1,"success","me-2",3,"click","disabled"],[1,"medium-icon","align-middle"],["type","button","matButton","filled",1,"error",3,"click"],[1,"medium-icon","fs-3","align-middle"],["type","button","mat-icon-button","","color","warn",3,"click"],["id","arrow","viewBox","0 -5 10 10","refX","8","refY","0","markerWidth","4","markerHeight","4","orient","auto"],["d","M0,-5L10,0L0,5",1,"arrow-head"],[1,"node"],["alignment-baseline","central"],[1,"edge"],["stroke-width","2","marker-end","url(#arrow)",1,"line"],["text-anchor","middle",1,"edge-label"],["startOffset","50%",1,"text-path"]],template:function(t,n){t&1&&(r(0,"section",4)(1,"div",5)(2,"div",6)(3,"div",7),f(4,no,4,3,"span",8),f(5,ao,4,3,"span",8),l()(),r(6,"div",9)(7,"div",10)(8,"form",11)(9,"mat-card",12)(10,"mat-card-content")(11,"div",13),f(12,ro,6,3,"div",14),r(13,"div",9)(14,"div",15),y(15,Eo,151,110,"div",16,rt),l()()()()()()(),r(17,"div",17)(18,"ngx-graph",18,0),s(20,` [layout]="'dagreCluster'"> `),Lt(21,yo,2,0,"ng-template",null,1,gt)(23,Mo,4,6,"ng-template",null,2,gt)(25,Fo,5,4,"ng-template",null,3,gt),l()()()()()),t&2&&(a(4),_(n.workflowTransitions.length==0?4:-1),a(),_(n.workflowTransitions.length>0?5:-1),a(3),u("formGroup",n.transitionFormGroup),a(4),_(n.workflowInstances.length==0?12:-1),a(3),M(n.transitions.controls),a(3),u("layoutSettings",ut(11,io))("links",n.links)("nodes",n.nodes)("layout","dagre")("panOnZoom",!0)("autoCenter",!0)("autoZoom",!0))},dependencies:[V,J,K,H,j,z,Y,Z,_t,bt,Q,P,L,ft,q,U,be,me,_e,fe,we,ke,ve,he,Be,Nt,kt,it,ot,tt,et,$,vt],styles:[".mat-button-toggle.approved{color:#28a745!important;background-color:#28a745!important}  .mat-button-toggle.rejected{color:#dc3545!important;background-color:#dc3545!important}  .mat-button-toggle.pending{color:#ffc107!important;background-color:#ffc107!important}  .mat-button-toggle.inprogress{color:#4252b1!important;background-color:#4252b1!important}  .mat-button-toggle.onhold{color:#6c757d!important;background-color:#6c757d!important}  .mat-button-toggle.cancelled{color:#343a40!important;background-color:#343a40!important}  .mat-button-toggle.escalated{color:#fd7e14!important;background-color:#fd7e14!important}  .mat-button-toggle.completed{color:#198754!important;background-color:#198754!important}  .custom-toggle-group mat-button-toggle{min-width:60px;height:30px;font-size:8px}  .mat-button-toggle .mat-pseudo-checkbox{margin-top:-20px!important}"]})};var No=()=>["/workflow-settings"];function Ro(o,e){o&1&&(r(0,"span",4),s(1),p(2,"translate"),S(3,"app-page-help-text",20),l()),o&2&&(a(),m(" ",c(2,1,"ADD_WORKFLOW")," "))}function Bo(o,e){o&1&&(r(0,"span",4),s(1),p(2,"translate"),S(3,"app-page-help-text",20),l()),o&2&&(a(),m(" ",c(2,1,"EDIT_WORKFLOW")," "))}function Ao(o,e){o&1&&(r(0,"div",12),s(1),p(2,"translate"),l()),o&2&&(a(),m(" ",c(2,1,"NAME_IS_REQUIRED")," "))}function Oo(o,e){o&1&&(r(0,"div",12),s(1),p(2,"translate"),l()),o&2&&(a(),m(" ",c(2,1,"DESCRIPTION_IS_REQUIRED")," "))}var Tt=class o{fb=b(X);workflowStore=b(G);router=b(D);workFormGroup;isLoading=!1;currentWorkflow=this.workflowStore.currentWorkflow();currentStep=0;manageStepComponent;manageTransitionComponent;constructor(){W(()=>{let e=this.workflowStore.currentStep();e!==this.currentStep&&(this.currentStep=e,this.goToWorkflowStep())})}ngOnInit(){this.createFirstFormGroup(),this.currentWorkflow&&this.workFormGroup.patchValue(this.currentWorkflow)}createFirstFormGroup(){this.workFormGroup=this.fb.group({id:[""],name:["",I.required],description:["",I.required]})}goToWorkflowStep(){this.router.navigate(["/workflow-settings/manage/manage-steps"])}saveWorkflow(){if(this.workFormGroup.invalid){this.workFormGroup.markAllAsTouched();return}let e=this.createWorkflowBuildObject();e.id?this.workflowStore.updateWorkflow(e):this.workflowStore.addWorkflow(e)}createWorkflowBuildObject(){return{id:this.workFormGroup.get("id")?.value,name:this.workFormGroup.get("name")?.value,description:this.workFormGroup.get("description")?.value,isWorkflowSetup:!1,workflowSteps:[],workflowTransitions:[],workflowInstances:[]}}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=R({type:o,selectors:[["app-create-workflow"]],contentQueries:function(t,n,i){if(t&1&&(lt(i,nt,5),lt(i,at,5)),t&2){let d;A(d=O())&&(n.manageStepComponent=d.first),A(d=O())&&(n.manageTransitionComponent=d.first)}},decls:37,vars:27,consts:[[1,"content"],[1,"container-fluid"],[1,"d-flex","mb-2"],[1,"me-auto"],[1,"mb-0","page-title"],[3,"formGroup"],["appearance","outlined"],[1,"row"],[1,"col-md-6"],[1,"form-group"],["for","name",1,"form-label"],["formControlName","name","type","text","required","",1,"form-control",3,"placeholder"],[1,"text-danger"],["for","description",1,"form-label"],["formControlName","description","type","text","required","",1,"form-control",3,"placeholder"],[1,"col-md-12","mt-2"],["matButton","filled","cdkFocusInitial","",1,"success","me-2",3,"click"],[1,"medium-icon","fs-5","align-middle"],["type","button","matButton","filled",1,"error",3,"routerLink"],[1,"medium-icon","align-middle"],["code","MANAGE_WORKFLOW"]],template:function(t,n){if(t&1&&(r(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3),f(4,Ro,4,3,"span",4),f(5,Bo,4,3,"span",4),l()(),r(6,"form",5)(7,"mat-card",6)(8,"mat-card-content")(9,"div",7)(10,"div",8)(11,"div",9)(12,"label",10),s(13),p(14,"translate"),l(),S(15,"input",11),p(16,"translate"),f(17,Ao,3,3,"div",12),l()(),r(18,"div",8)(19,"div",9)(20,"label",13),s(21),p(22,"translate"),l(),S(23,"input",14),p(24,"translate"),f(25,Oo,3,3,"div",12),l()()(),r(26,"div",15)(27,"button",16),v("click",function(){return n.saveWorkflow()}),r(28,"mat-icon",17),s(29,"arrow_forward"),l(),s(30),p(31,"translate"),l(),r(32,"button",18)(33,"mat-icon",19),s(34,"cancel"),l(),s(35),p(36,"translate"),l()()()()()()()),t&2){let i,d;a(4),_(n.currentWorkflow!=null&&n.currentWorkflow.id?-1:4),a(),_(n.currentWorkflow!=null&&n.currentWorkflow.id?5:-1),a(),u("formGroup",n.workFormGroup),a(7),x(c(14,14,"NAME")),a(2),u("placeholder",T(c(16,16,"ENTER_THE_WORKFLOW_NAME"))),a(2),_((i=n.workFormGroup.get("name"))!=null&&i.touched&&(!((i=n.workFormGroup.get("name"))==null||i.errors==null)&&i.errors.required)?17:-1),a(4),x(c(22,18,"DESCRIPTION")),a(2),u("placeholder",T(c(24,20,"ENTER_THE_WORKFLOW_DESCRIPTION"))),a(2),_((d=n.workFormGroup.get("description"))!=null&&d.touched&&(!((d=n.workFormGroup.get("description"))==null||d.errors==null)&&d.errors.required)?25:-1),a(5),m(" ",c(31,22,"NEXT")," "),a(2),u("routerLink",ut(26,No)),a(3),m(" ",c(36,24,"CANCEL")," ")}},dependencies:[V,Zt,J,K,H,j,z,ce,Y,Z,Q,it,q,U,P,L,ot,tt,et,$],encapsulation:2})};var Mn=[{path:"manage-steps",component:nt},{path:"manage-transitions",component:at},{path:":id",resolve:{workflow:xe},component:Tt}];export{Mn as WORKFLOW_ROUTES};
