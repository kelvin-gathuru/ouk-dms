import{c as I}from"./chunk-I43MH25B.js";import{a as l,b as o,c as x,d as R,e as k,f as O,g as B,h as d}from"./chunk-OHUA35YV.js";import{a as P}from"./chunk-APWCXNU6.js";import{b as _}from"./chunk-WC3ZMFX5.js";import{b as v}from"./chunk-UFOTACYY.js";import{a as D}from"./chunk-RKRBEXQJ.js";import{a as U}from"./chunk-LCPYESOB.js";import{Gc as V,Ob as C,d as w,h as M,i as s}from"./chunk-KZMFGXDY.js";import{Ja as N,Pa as L,Ub as c,Ya as T,_b as g,h as m}from"./chunk-W3TJXGK4.js";import{a as u,b as f}from"./chunk-H5HZ6YB3.js";var y=class e{constructor(r){this.httpClient=r}getTableSettings(r){let a=`tableSettings/${r}`;return this.httpClient.get(a)}saveTableSettings(r){return this.httpClient.post("TableSettings",r)}static \u0275fac=function(a){return new(a||e)(M(V))};static \u0275prov=w({token:e,factory:e.\u0275fac,providedIn:"root"})};var h=[{key:"select",header:"select",width:50,type:"text",isVisible:!0,orderNumber:1,allowSort:!1},{key:"action",header:"ACTION",width:50,type:"text",isVisible:!0,orderNumber:2,allowSort:!1},{key:"documentNumber",header:"DOCUMENT_NO",width:150,type:"text",isVisible:!0,orderNumber:3,allowSort:!0},{key:"currentWorkflow",header:"WORKFLOW",width:150,type:"text",isVisible:!0,orderNumber:4,allowSort:!1},{key:"name",header:"NAME",width:200,type:"text",isVisible:!0,orderNumber:5,allowSort:!0},{key:"categoryName",header:"CATEGORY",width:150,type:"text",isVisible:!0,orderNumber:6,allowSort:!0},{key:"createdDate",header:"CREATED_DATE",width:150,type:"datetime",isVisible:!0,orderNumber:7,allowSort:!0},{key:"createdBy",header:"CREATED_BY",width:150,type:"text",isVisible:!0,orderNumber:8,allowSort:!0},{key:"documentStatus",header:"STATUS",width:150,type:"text",isVisible:!0,orderNumber:9,allowSort:!0},{key:"isSigned",header:"ISSIGN",width:150,type:"bool",isVisible:!0,orderNumber:10,allowSort:!1},{key:"signByDate",header:"SIGNDATE",width:150,type:"datetime",isVisible:!0,orderNumber:11,allowSort:!1},{key:"storageType",header:"STORAGE",width:150,type:"text",isVisible:!0,orderNumber:12,allowSort:!0},{key:"client",header:"CLIENT",width:150,type:"text",isVisible:!0,orderNumber:13,allowSort:!1}];var Y={documents:[],isLoading:!1,loadList:!1,isAddUpdate:!1,documentResourceParameter:{id:"",createdBy:"",categoryId:"",documentStatusId:"",storageSettingId:"",clientId:"",createDate:void 0,fields:"",orderBy:"CreatedDate desc",searchQuery:"",pageSize:20,skip:0,name:"",totalCount:0,metaTags:"",metaTagsTypeId:"",documentNumber:""},commonError:null,matTableSetting:null,isTableSettingAdded:!1},ne=x({providedIn:"root"},B(Y),R(({matTableSetting:e})=>({tableSettingsVisible:C(()=>{let r=e();return r&&r.settings&&Array.isArray(r.settings)&&r.settings.length>0?r.settings.filter(a=>a.isVisible):[...h]}),visibleTableKeys:C(()=>{let r=e();return r&&r.settings&&Array.isArray(r.settings)&&r.settings.length>0?[...r.settings.filter(p=>p.isVisible).map(p=>p.key)]:[...h.map(a=>a.key)]})})),O((e,r=s(P),a=s(_),p=s(v),H=s(D),A=s(y),S=s(U))=>({loadByQuery:d(m(L(300),g(()=>o(e,{isLoading:!0})),c(i=>H.hasClaim("ALL_VIEW_DOCUMENTS")?r.getDocuments(i).pipe(l({next:t=>{let n=JSON.parse(t.headers.get("X-Pagination")??"{}"),b=f(u({},i),{totalCount:n.totalCount,pageSize:n.pageSize,skip:n.skip});o(e,{documents:[...t.body??[]],isLoading:!1,commonError:null,loadList:!1,isAddUpdate:!1,documentResourceParameter:u({},b)})},error:t=>{o(e,{commonError:t,isLoading:!1}),console.error(t)}})):(o(e,{isLoading:!1,documents:[]}),import("./chunk-BLYBSNHM.js").then(t=>t.EMPTY))))),archiveById:d(m(T(),g(()=>o(e,{isLoading:!0})),c(i=>r.archiveDocument(i).pipe(l({next:()=>{a.success(S.getValue("DOCUMENT_ARCHIVE_SUCCESSFULLY")),o(e,{isLoading:!1,loadList:!0})},error:t=>{o(e,{commonError:t,isLoading:!1})}}))))),addUpdateDocument:d(m(T(),g(()=>o(e,{isLoading:!0})),c(i=>i.id?r.updateDocument(i).pipe(l({next:()=>{a.success(S.getValue("DOCUMENT_SAVE_SUCCESSFULLY")),o(e,{isLoading:!1,loadList:!0,isAddUpdate:!0})},error:t=>{o(e,{commonError:t,isLoading:!1})}})):r.addDocument(i).pipe(l({next:()=>{a.success(S.getValue("DOCUMENT_SAVE_SUCCESSFULLY")),o(e,{isLoading:!1,loadList:!0,isAddUpdate:!0})},error:t=>{o(e,{commonError:t,isLoading:!1})}}))))),loadTableSettingsByQuery:d(m(L(300),g(()=>o(e,{isLoading:!0})),c(i=>A.getTableSettings(i).pipe(l({next:t=>{if(t.screenName){let n=t.settings.sort((b,E)=>b.orderNumber-E.orderNumber);o(e,{matTableSetting:f(u({},t),{settings:[...n]}),isLoading:!1,commonError:null})}else{let n={id:0,screenName:i,settings:[...h]};o(e,{matTableSetting:u({},n),isLoading:!1,commonError:null})}},error:t=>{o(e,{commonError:t,isLoading:!1}),console.error(t)}}))))),addDocumentAudit:d(m(N(i=>p.addDocumentAuditTrail(i).pipe(l({next:t=>{},error:t=>{console.error(t)}}))))),loadDocuments(){this.loadByQuery(e.documentResourceParameter())},loadTableSettingByScreenName(i){this.loadTableSettingsByQuery(i)},updateTableSettingAdded(){o(e,{isTableSettingAdded:!1})},setLoadingFlag(i){o(e,{isLoading:i})},saveTableSettings:d(m(T(),g(()=>o(e,{isLoading:!0})),c(i=>A.saveTableSettings(i).pipe(l({next:t=>{a.success(S.getValue("TABLESETTINGS_SAVE_SUCCESSFULLY"));let n=t.settings.sort((b,E)=>b.orderNumber-E.orderNumber);o(e,{matTableSetting:f(u({},t),{settings:[...n]}),isLoading:!1,commonError:null,isTableSettingAdded:!0})},error:t=>{o(e,{commonError:t,isLoading:!1})}})))))})),k({onInit(e,r=s(D)){I(e.loadList).subscribe(a=>{a&&e.loadByQuery(e.documentResourceParameter())}),r.isUserAuthenticate()&&r.hasClaim("ALL_VIEW_DOCUMENTS")&&e.loadByQuery(e.documentResourceParameter())}}));export{y as a,ne as b};
