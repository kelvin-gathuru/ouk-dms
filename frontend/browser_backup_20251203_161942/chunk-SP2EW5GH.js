import{a as lt}from"./chunk-Q64ABPSN.js";import{a as We,b as Ye}from"./chunk-XA5EPKK2.js";import{a as qe,b as Qe,c as ze,d as Je,e as Ke,f as Xe,g as Ze,h as et,i as tt,j as it,k as nt,l as ot,m as rt,n as at,o as st,p as mt,q as Ie}from"./chunk-O4QTDGQI.js";import{a as ve,b as Se}from"./chunk-6QK67EK5.js";import{a as he,b as ge,c as Ee}from"./chunk-NAYIGTW2.js";import{a as ct}from"./chunk-LTSUZ232.js";import{a as He}from"./chunk-6GBRFDEJ.js";import{a as q}from"./chunk-ZXWR2MAY.js";import{a as fe,b as Ce,c as De}from"./chunk-FWRBVAV4.js";import{b as ue}from"./chunk-2FSKRITI.js";import{d as _e}from"./chunk-TQCCWZBZ.js";import{c as Ge}from"./chunk-756DJ4VK.js";import{a as $e}from"./chunk-JYYDN77K.js";import{b as F,c as O,d as Be,e as B,f as V}from"./chunk-BQ4MMRNN.js";import{b as Q}from"./chunk-JSAPTJHL.js";import{b as z}from"./chunk-UFOTACYY.js";import{e as K}from"./chunk-THB5JDTQ.js";import{a as $,b as G}from"./chunk-4E37NPLR.js";import{ta as H,ua as Ve,va as j}from"./chunk-56QOWAU7.js";import{C as pe,E as de,c as re,e as J,h as ae,i as se,m as w,o as me,r as le,u as ce}from"./chunk-KYSGX4IW.js";import{e as Oe}from"./chunk-BFSIXXTJ.js";import{a as je}from"./chunk-DGFNMOMG.js";import{$ as D,$a as ye,Ca as f,Da as C,Db as l,Eb as c,Fa as Z,Fb as Re,Ga as ee,Gc as Fe,Ha as te,Ia as v,Ja as o,Ka as n,La as P,Pa as x,Pc as W,Qa as T,Rc as Y,Sa as U,Ua as S,W as i,Wa as h,_a as Ae,ab as Ne,d as ke,eb as I,ga as A,h as Te,i as Le,jb as a,ka as y,kb as M,lb as d,ma as b,mb as N,nb as Me,p as g,pb as ie,q as E,qb as ne,rb as oe,vb as R,zb as be}from"./chunk-KZMFGXDY.js";import{Da as L,b as X}from"./chunk-W3TJXGK4.js";var k=class e{constructor(s,t){this.httpClient=s;this.commonHttpErrorService=t}getDoucmentPermission(s){let t=`DocumentRolePermission/${s}`;return this.httpClient.get(t)}deleteDocumentUserPermission(s){let t=`DocumentUserPermission/${s}`;return this.httpClient.delete(t).pipe(L(this.commonHttpErrorService.handleError))}deleteDocumentRolePermission(s){let t=`DocumentRolePermission/${s}`;return this.httpClient.delete(t).pipe(L(this.commonHttpErrorService.handleError))}addDocumentUserPermission(s){return this.httpClient.post("DocumentUserPermission",{documentUserPermissions:s}).pipe(L(this.commonHttpErrorService.handleError))}addDocumentRolePermission(s){return this.httpClient.post("DocumentRolePermission",{documentRolePermissions:s}).pipe(L(this.commonHttpErrorService.handleError))}multipleDocumentsToUsersAndRoles(s){return this.httpClient.post("DocumentRolePermission/multiple",s).pipe(L(this.commonHttpErrorService.handleError))}getSharePermission(s,t){let m=`DocumentRolePermission/${s}/sharepermission/${t}`;return this.httpClient.get(m)}static \u0275fac=function(t){return new(t||e)(Te(Fe),Te(je))};static \u0275prov=ke({token:e,factory:e.\u0275fac,providedIn:"root"})};function xt(e,s){if(e&1&&(o(0,"span"),a(1),n()),e&2){let t=h();i(),d(" ",t.selectedRoles[0].name," ")}}function Tt(e,s){if(e&1&&(o(0,"span",12),a(1),n()),e&2){let t=h();i(),N(" (+",t.selectedRoles.length-1," ",t.selectedRoles.length===2?"other":"others",") ")}}function Mt(e,s){if(e&1&&(o(0,"mat-option",13),a(1),n()),e&2){let t=s.$implicit;v("value",t),i(),d(" ",t.name," ")}}function bt(e,s){e&1&&(o(0,"mat-error"),a(1),l(2,"translate"),n()),e&2&&(i(),d(" ",c(2,1,"START_DATE_IS_REQURED")," "))}function Rt(e,s){e&1&&(o(0,"mat-error"),a(1),l(2,"translate"),n()),e&2&&(i(),d(" ",c(2,1,"END_DATE_IS_REQURED")," "))}function It(e,s){if(e&1){let t=U();o(0,"div",8)(1,"div",23)(2,"label",10),a(3),l(4,"translate"),n(),o(5,"div",24),P(6,"input",25),l(7,"translate"),o(8,"div",26)(9,"button",27),S("click",function(){g(t);let r=I(13);return E(r.open())}),o(10,"mat-icon",28),a(11,"calendar_today"),n()()(),P(12,"mat-datepicker",null,0),n(),f(14,bt,3,3,"mat-error"),n(),o(15,"div",23)(16,"label",10),a(17),l(18,"translate"),n(),o(19,"div",24),P(20,"input",29),l(21,"translate"),o(22,"div",26)(23,"button",27),S("click",function(){g(t);let r=I(27);return E(r.open())}),o(24,"mat-icon",28),a(25,"calendar_today"),n()()(),P(26,"mat-datepicker",null,1),n(),f(28,Rt,3,3,"mat-error"),n()()}if(e&2){let t,m,r,p=I(13),u=I(27),_=h();i(3),M(c(4,12,"CHOOSE_A_START_DATE")),i(3),v("placeholder",R(c(7,14,"START_DATE")))("min",_.minDate)("matDatepicker",p),i(8),C((t=_.permissionForm.get("startDate"))!=null&&t.touched&&(!((t=_.permissionForm.get("startDate"))==null||t.errors==null)&&t.errors.required)?14:-1),i(3),M(c(18,16,"CHOOSE_A_END_DATE")),i(3),v("placeholder",R(c(21,18,"END_DATE")))("min",(m=_.permissionForm.get("startDate"))==null?null:m.value)("matDatepicker",u),i(8),C((r=_.permissionForm.get("startDate"))!=null&&r.touched&&(!((r=_.permissionForm.get("endDate"))==null||r.errors==null)&&r.errors.required)?28:-1)}}function Ut(e,s){e&1&&(o(0,"div",18),a(1),l(2,"translate"),n()),e&2&&(i(),d(" ",c(2,1,"PLEASE_CONFIGURE_EMAIL_SMTP_SETTINGS")," "))}var Pe=class e extends q{constructor(t,m,r,p,u,_){super();this.documentPermissionService=t;this.toastrService=m;this.data=r;this.dialogRef=p;this.fb=u;this.commonService=_;this.minDate=new Date}selectedRoles=[];minDate;permissionForm;subscriptions=new X;smtpConfigured;ngOnInit(){this.createUserPermissionForm(),this.subscriptions.add(this.commonService.IsSmtpConfigured.subscribe(t=>{if(t==null){this.checkEmailSMTPSettings();return}this.smtpConfigured=t}))}checkEmailSMTPSettings(){this.sub$.sink=this.commonService.checkEmailSMTPSetting().subscribe({next:t=>{t&&t?.data},error:t=>{this.toastrService.error(this.translationService.getValue("SMTP_SETTINGS_ERROR"))}})}createUserPermissionForm(){this.permissionForm=this.fb.group({isTimeBound:new w(!1),startDate:[""],endDate:[""],isAllowDownload:new w(!1),isAllowEmailNotification:new w(!1)})}timeBoundChange(t){t.checked?(this.permissionForm.get("startDate")?.setValidators([J.required]),this.permissionForm.get("endDate")?.setValidators([J.required])):(this.permissionForm.get("startDate")?.clearValidators(),this.permissionForm.get("startDate")?.updateValueAndValidity(),this.permissionForm.get("endDate")?.clearValidators(),this.permissionForm.get("endDate")?.updateValueAndValidity())}saveDocumentRolePermission(){if(!this.permissionForm.valid){this.permissionForm.markAllAsTouched();return}if(this.selectedRoles.length==0){this.toastrService.error(this.translationService.getValue("PLEASE_SELECT_ATLEAST_ONE_ROLE"));return}let t=this.selectedRoles.map(m=>Object.assign({},{id:"",documentId:this.data.documentId,roleId:m.id},this.permissionForm.value));this.sub$.sink=this.documentPermissionService.addDocumentRolePermission(t).subscribe(()=>{this.toastrService.success(this.translationService.getValue("PERMISSION_ADDED_SUCCESSFULLY")),this.dialogRef.close(!0)})}onNoClick(){this.dialogRef.close()}static \u0275fac=function(m){return new(m||e)(D(k),D(Q),D(O),D(F),D(pe),D(z))};static \u0275cmp=A({type:e,selectors:[["app-manage-role-permission"]],features:[y],decls:47,vars:31,consts:[["startDatePicker",""],["endDatePicker",""],[1,"d-flex"],[1,"me-auto","p-2"],[1,"mb-3","page-title"],[1,"d-flex","justify-content-end","mb-2"],[1,"close-icon","text-danger","cursor-pointer",3,"click"],[3,"formGroup"],[1,"row"],[1,"form-group","col-md-12"],[1,"form-label"],["panelClass","mat-select-control","multiple","",1,"form-control",3,"valueChange","placeholder","value"],[1,"example-additional-selection"],[3,"value"],["color","primary","formControlName","isTimeBound",3,"change"],["color","primary","formControlName","isAllowDownload"],[1,"col-md-12"],["color","primary","formControlName","isAllowEmailNotification"],[1,"alert","alert-warning","mt-2"],[1,"col-md-12","mt-2"],["matButton","filled","cdkFocusInitial","",1,"success","me-2",3,"click"],[1,"medium-icon"],["matButton","filled",1,"error",3,"click"],[1,"form-group","col-md-6"],[1,"input-group"],["formControlName","startDate",1,"form-control",3,"placeholder","min","matDatepicker"],[1,"input-group-append"],["type","button",1,"btn","btn-primary","calendar-button",3,"click"],[1,"medium-icon","fs-6","align-middle"],["formControlName","endDate",1,"form-control",3,"placeholder","min","matDatepicker"]],template:function(m,r){if(m&1&&(o(0,"mat-dialog-content")(1,"div",2)(2,"div",3)(3,"span",4),a(4),l(5,"translate"),n()(),o(6,"div",5)(7,"mat-icon",6),S("click",function(){return r.onNoClick()}),a(8,"cancel"),n()()(),o(9,"form",7)(10,"div",8)(11,"div",9)(12,"label",10),a(13),l(14,"translate"),n(),o(15,"mat-select",11),l(16,"translate"),oe("valueChange",function(u){return ne(r.selectedRoles,u)||(r.selectedRoles=u),u}),o(17,"mat-select-trigger"),f(18,xt,2,1,"span"),f(19,Tt,2,2,"span",12),n(),ee(20,Mt,2,2,"mat-option",13,Z),n()()(),o(22,"div",8)(23,"mat-checkbox",14),S("change",function(u){return r.timeBoundChange(u)}),a(24),l(25,"translate"),n()(),f(26,It,29,20,"div",8),o(27,"div",8)(28,"mat-checkbox",15),a(29),l(30,"translate"),n()(),o(31,"div",16)(32,"mat-checkbox",17),a(33),l(34,"translate"),n()(),f(35,Ut,3,3,"div",18),o(36,"div",19)(37,"button",20),S("click",function(){return r.saveDocumentRolePermission()}),o(38,"mat-icon",21),a(39,"save"),n(),a(40),l(41,"translate"),n(),o(42,"button",22),S("click",function(){return r.onNoClick()}),o(43,"mat-icon",21),a(44,"cancel"),n(),a(45),l(46,"translate"),n()()()()),m&2){let p,u;i(4),d(" ",c(5,15,"ROLE_PERMISSION")," "),i(5),v("formGroup",r.permissionForm),i(4),M(c(14,17,"ROLES")),i(2),v("placeholder",R(c(16,19,"SELECT_ROLES"))),ie("value",r.selectedRoles),i(3),C(r.selectedRoles.length>0?18:-1),i(),C(r.selectedRoles.length>1?19:-1),i(),te(r.data.roles),i(4),d(" ",c(25,21,"SPACIFY_THE_PERIOD")),i(2),C((p=r.permissionForm.get("isTimeBound"))!=null&&p.value?26:-1),i(3),M(c(30,23,"ALLOW_DOWNLOAD")),i(4),M(c(34,25,"IS_ALLOW_NOTIFICATION")),i(2),C((u=r.permissionForm.get("isAllowEmailNotification"))!=null&&u.value&&!r.smtpConfigured?35:-1),i(5),d(" ",c(41,27,"SAVE")," "),i(5),d(" ",c(46,29,"CANCEL")," ")}},dependencies:[Se,ve,V,B,de,me,re,ae,se,le,ce,De,ue,fe,Ce,_e,Y,Ee,he,ge,K,G,$,j,H,W],encapsulation:2})};function wt(e,s){if(e&1&&(o(0,"span"),a(1),n()),e&2){let t=h();i(),Me(" ",t.selectedUsers[0].firstName," ",t.selectedUsers[0].lastName," (",t.selectedUsers[0].userName,") ")}}function kt(e,s){if(e&1&&(o(0,"span",13),a(1),n()),e&2){let t=h();i(),N(" (+",t.selectedUsers.length-1," ",t.selectedUsers.length===2?"other":"others",") ")}}function Lt(e,s){if(e&1&&(o(0,"mat-option",15),a(1),n()),e&2){let t=s.$implicit;v("value",t),i(),Me(" ",t.firstName," ",t.lastName," (",t.userName,") ")}}function At(e,s){e&1&&(o(0,"mat-error"),a(1),l(2,"translate"),n()),e&2&&(i(),d(" ",c(2,1,"START_DATE_IS_REQURED")," "))}function yt(e,s){e&1&&(o(0,"mat-error"),a(1),l(2,"translate"),n()),e&2&&(i(),d(" ",c(2,1,"END_DATE_IS_REQURED")," "))}function Nt(e,s){if(e&1){let t=U();o(0,"div",9)(1,"div",25)(2,"label",11),a(3),l(4,"translate"),n(),o(5,"div",26),P(6,"input",27),l(7,"translate"),o(8,"div",28)(9,"button",29),S("click",function(){g(t);let r=I(13);return E(r.open())}),o(10,"mat-icon",30),a(11,"calendar_today"),n()()(),P(12,"mat-datepicker",null,1),n(),f(14,At,3,3,"mat-error"),n(),o(15,"div",25)(16,"label",11),a(17),l(18,"translate"),n(),o(19,"div",26),P(20,"input",31),l(21,"translate"),o(22,"div",28)(23,"button",29),S("click",function(){g(t);let r=I(27);return E(r.open())}),o(24,"mat-icon",30),a(25,"calendar_today"),n()()(),P(26,"mat-datepicker",null,2),n(),f(28,yt,3,3,"mat-error"),n()()}if(e&2){let t,m,r,p=I(13),u=I(27),_=h();i(3),M(c(4,12,"CHOOSE_A_START_DATE")),i(3),v("placeholder",R(c(7,14,"START_DATE")))("min",_.minDate)("matDatepicker",p),i(8),C((t=_.permissionForm.get("startDate"))!=null&&t.touched&&(!((t=_.permissionForm.get("startDate"))==null||t.errors==null)&&t.errors.required)?14:-1),i(3),M(c(18,16,"CHOOSE_A_END_DATE")),i(3),v("placeholder",R(c(21,18,"END_DATE")))("min",(m=_.permissionForm.get("startDate"))==null?null:m.value)("matDatepicker",u),i(8),C((r=_.permissionForm.get("startDate"))!=null&&r.touched&&(!((r=_.permissionForm.get("endDate"))==null||r.errors==null)&&r.errors.required)?28:-1)}}function Ft(e,s){e&1&&(o(0,"div",20),a(1),l(2,"translate"),n()),e&2&&(i(),d(" ",c(2,1,"PLEASE_CONFIGURE_EMAIL_SMTP_SETTINGS")," "))}var xe=class e extends q{constructor(t,m,r,p,u,_){super();this.documentPermissionService=t;this.toastrService=m;this.data=r;this.dialogRef=p;this.fb=u;this.commonService=_;this.minDate=new Date}selectedUsers=[];minDate;subscriptions=new X;smtpConfigured;permissionForm;filteredUsers=[];searchTerm="";users=[];ngOnInit(){this.filteredUsers=[...this.data.users],this.createUserPermissionForm(),this.subscriptions.add(this.commonService.IsSmtpConfigured.subscribe(t=>{if(t==null){this.checkEmailSMTPSettings();return}this.smtpConfigured=t}))}filteredOptions(){return this.data.users.filter(t=>{t.firstName?.toLowerCase().includes(this.searchTerm.toLowerCase())})}filterUsers(t){let m=t.target?.value.trim().toLowerCase();if(!m){this.filteredUsers=[...this.data.users];return}this.filteredUsers=this.data.users.filter(r=>r.firstName?.toLowerCase().includes(m)||r.lastName?.toLowerCase().includes(m)||r.email?.toLowerCase().includes(m)||r.userName?.toLowerCase().includes(m)),this.filteredUsers=Array.from(new Set([...this.selectedUsers,...this.filteredUsers]))}compareUsers=(t,m)=>t&&m&&t.id===m.id;checkEmailSMTPSettings(){this.sub$.sink=this.commonService.checkEmailSMTPSetting().subscribe({next:t=>{t&&t?.data},error:t=>{this.toastrService.error(this.translationService.getValue("SMTP_SETTINGS_ERROR"))}})}createUserPermissionForm(){this.permissionForm=this.fb.group({isTimeBound:new w(!1),startDate:[""],endDate:[""],isAllowDownload:new w(!1),isAllowEmailNotification:new w(!1)})}timeBoundChange(t){t.checked?(this.permissionForm.get("startDate")?.setValidators([J.required]),this.permissionForm.get("endDate")?.setValidators([J.required])):(this.permissionForm.get("startDate")?.clearValidators(),this.permissionForm.get("startDate")?.updateValueAndValidity(),this.permissionForm.get("endDate")?.clearValidators(),this.permissionForm.get("endDate")?.updateValueAndValidity())}saveDocumentUserPermission(){if(!this.permissionForm.valid){this.permissionForm.markAllAsTouched();return}if(this.selectedUsers.length==0){this.toastrService.error(this.translationService.getValue("PLEASE_SELECT_ATLEAST_ONE_USER"));return}let t=this.selectedUsers.map(m=>Object.assign({},{id:"",documentId:this.data.documentId,userId:m.id},this.permissionForm.value));this.sub$.sink=this.documentPermissionService.addDocumentUserPermission(t).subscribe(()=>{this.toastrService.success(this.translationService.getValue("PERMISSION_ADDED_SUCCESSFULLY")),this.dialogRef.close(!0)})}onNoClick(){this.dialogRef.close()}static \u0275fac=function(m){return new(m||e)(D(k),D(Q),D(O),D(F),D(pe),D(z))};static \u0275cmp=A({type:e,selectors:[["app-manage-user-permission"]],features:[y],decls:50,vars:35,consts:[["input1",""],["startDatePicker",""],["endDatePicker",""],[1,"d-flex"],[1,"me-auto","p-2"],[1,"mb-3","page-title"],[1,"d-flex","justify-content-end","mb-2"],[1,"close-icon","text-danger","cursor-pointer",3,"click"],[1,"form-group",3,"formGroup"],[1,"row"],[1,"form-group","col-md-12"],[1,"form-label"],["panelClass","mat-select-control","multiple","",1,"form-control",3,"valueChange","placeholder","value"],[1,"example-additional-selection"],[1,"form-control",3,"keyup","placeholder"],["color","primary",3,"value"],["color","primary","formControlName","isTimeBound",3,"change"],["color","primary","formControlName","isAllowDownload"],[1,"col-md-12"],["color","primary","formControlName","isAllowEmailNotification"],[1,"alert","alert-warning","mt-2"],[1,"col-12","mt-2"],["matButton","filled","cdkFocusInitial","",1,"success","me-2",3,"click"],[1,"medium-icon"],["matButton","filled",1,"error",3,"click"],[1,"form-group","col-md-6"],[1,"input-group"],["formControlName","startDate",1,"form-control",3,"placeholder","min","matDatepicker"],[1,"input-group-append"],["type","button",1,"btn","btn-primary","calendar-button",3,"click"],[1,"medium-icon","fs-6","align-middle"],["formControlName","endDate",1,"form-control",3,"placeholder","min","matDatepicker"]],template:function(m,r){if(m&1){let p=U();o(0,"mat-dialog-content")(1,"div",3)(2,"div",4)(3,"span",5),a(4),l(5,"translate"),n()(),o(6,"div",6)(7,"mat-icon",7),S("click",function(){return g(p),E(r.onNoClick())}),a(8,"cancel"),n()()(),o(9,"form",8)(10,"div",9)(11,"div",10)(12,"label",11),a(13),l(14,"translate"),n(),o(15,"mat-select",12),l(16,"translate"),oe("valueChange",function(_){return g(p),ne(r.selectedUsers,_)||(r.selectedUsers=_),E(_)}),o(17,"mat-select-trigger"),f(18,wt,2,3,"span"),f(19,kt,2,2,"span",13),n(),o(20,"input",14,0),l(22,"translate"),S("keyup",function(_){return g(p),E(r.filterUsers(_))}),n(),ee(23,Lt,2,4,"mat-option",15,Z),n()()(),o(25,"div",9)(26,"mat-checkbox",16),S("change",function(_){return g(p),E(r.timeBoundChange(_))}),a(27),l(28,"translate"),n()(),f(29,Nt,29,20,"div",9),o(30,"div",9)(31,"mat-checkbox",17),a(32),l(33,"translate"),n()(),o(34,"div",18)(35,"mat-checkbox",19),a(36),l(37,"translate"),n()(),f(38,Ft,3,3,"div",20),o(39,"div",21)(40,"button",22),S("click",function(){return g(p),E(r.saveDocumentUserPermission())}),o(41,"mat-icon",23),a(42,"save"),n(),a(43),l(44,"translate"),n(),o(45,"button",24),S("click",function(){return g(p),E(r.onNoClick())}),o(46,"mat-icon",23),a(47,"cancel"),n(),a(48),l(49,"translate"),n()()()()}if(m&2){let p,u;i(4),d(" ",c(5,17,"USER_PERMISSION")," "),i(5),v("formGroup",r.permissionForm),i(4),M(c(14,19,"USERS")),i(2),v("placeholder",R(c(16,21,"SELECT_USERS"))),ie("value",r.selectedUsers),i(3),C(r.selectedUsers.length>0?18:-1),i(),C(r.selectedUsers.length>1?19:-1),i(),v("placeholder",R(c(22,23,"SEARCH_BY_USER_ROLE_NAME_AND_EMAIL"))),i(3),te(r.filteredUsers),i(4),d(" ",c(28,25,"SPACIFY_THE_PERIOD")),i(2),C((p=r.permissionForm.get("isTimeBound"))!=null&&p.value?29:-1),i(3),M(c(33,27,"ALLOW_DOWNLOAD")),i(4),M(c(37,29,"IS_ALLOW_NOTIFICATION")),i(2),C((u=r.permissionForm.get("isAllowEmailNotification"))!=null&&u.value&&!r.smtpConfigured?38:-1),i(5),d(" ",c(44,31,"SAVE")," "),i(5),d(" ",c(49,33,"CANCEL")," ")}},dependencies:[Se,ve,V,B,de,me,re,ae,se,le,ce,De,ue,fe,Ce,_e,Y,Ee,he,ge,K,G,$,j,H,W],encapsulation:2})};var Ot=["userPermissionsPaginator"],Bt=()=>["ASSIGNED_REMOVE_SHARE_DOCUMENT","ALL_REMOVE_SHARE_DOCUMENT"],Vt=()=>[10,20,50,100];function Ht(e,s){if(e&1&&(o(0,"div",36)(1,"p",35)(2,"b"),a(3),l(4,"translate"),n(),a(5),n()()),e&2){let t=h(2);i(3),d("",c(4,2,"DESCRIPTION"),":"),i(2),d(" ",t.document.description," ")}}function jt(e,s){if(e&1&&(o(0,"div",8)(1,"div",34)(2,"p",35)(3,"b"),a(4),l(5,"translate"),n(),a(6),n()(),f(7,Ht,6,4,"div",36),n()),e&2){let t=h();i(4),d("",c(5,3,"DOCUMENT_NAME"),":"),i(2),d(" ",t.document.name," "),i(),C(t.document.description?7:-1)}}function $t(e,s){e&1&&(o(0,"th",37),a(1),l(2,"translate"),n()),e&2&&(i(),d(" ",c(2,1,"ACTION")," "))}function Gt(e,s){if(e&1){let t=U();o(0,"button",41),S("click",function(){g(t);let r=h(2).$implicit,p=h();return E(p.deleteDocumentUserPermission(r))}),o(1,"mat-icon"),a(2,"delete"),n()()}}function Wt(e,s){if(e&1){let t=U();o(0,"button",41),S("click",function(){g(t);let r=h(2).$implicit,p=h();return E(p.deleteDocumentRolePermission(r))}),o(1,"mat-icon"),a(2,"delete"),n()()}}function Yt(e,s){if(e&1&&(x(0),f(1,Gt,3,0,"button",40),f(2,Wt,3,0,"button",40),T()),e&2){let t=h().$implicit;i(),C(t.type=="User"?1:-1),i(),C(t.type=="Role"?2:-1)}}function qt(e,s){e&1&&(o(0,"td",38),b(1,Yt,3,2,"ng-container",39),n()),e&2&&(i(),v("hasClaim",be(1,Bt)))}function Qt(e,s){e&1&&(o(0,"th",42),a(1),l(2,"translate"),n()),e&2&&(i(),d(" ",c(2,1,"ALLOW_DOWNLOAD")," "))}function zt(e,s){e&1&&(x(0),a(1),l(2,"translate"),T()),e&2&&(i(),d(" ",c(2,1,"YES")," "))}function Jt(e,s){e&1&&(x(0),a(1),l(2,"translate"),T()),e&2&&(i(),d(" ",c(2,1,"NO")," "))}function Kt(e,s){if(e&1&&(o(0,"td",43),f(1,zt,3,3,"ng-container")(2,Jt,3,3,"ng-container"),n()),e&2){let t=s.$implicit;i(),C(t.isAllowDownload?1:2)}}function Xt(e,s){e&1&&(o(0,"th",42),a(1),l(2,"translate"),n()),e&2&&(i(),M(c(2,1,"TYPE")))}function Zt(e,s){if(e&1&&(o(0,"td",43),a(1),n()),e&2){let t=s.$implicit;i(),d(" ",t.type," ")}}function ei(e,s){e&1&&(o(0,"th",42),a(1),l(2,"translate"),n()),e&2&&(i(),d(" ",c(2,1,"USER_ROLE_NAME")," "))}function ti(e,s){if(e&1&&(o(0,"span"),a(1),n()),e&2){let t=h().$implicit;i(),N(" ",t.user.firstName," ",t.user.lastName," ")}}function ii(e,s){if(e&1&&(o(0,"span"),a(1),n()),e&2){let t=h().$implicit;i(),d(" ",t.role.name," ")}}function ni(e,s){if(e&1&&(o(0,"td",43),f(1,ti,2,2,"span"),f(2,ii,2,1,"span"),n()),e&2){let t=s.$implicit;i(),C(t.type=="User"?1:-1),i(),C(t.type=="Role"?2:-1)}}function oi(e,s){e&1&&(o(0,"th",42),a(1),l(2,"translate"),n()),e&2&&(i(),M(c(2,1,"EMAIL")))}function ri(e,s){if(e&1&&(o(0,"span"),a(1),n()),e&2){let t=h().$implicit;i(),d(" ",t.user.email," ")}}function ai(e,s){e&1&&(o(0,"span"),a(1," -- "),n())}function si(e,s){if(e&1&&(o(0,"td",43),f(1,ri,2,1,"span"),f(2,ai,2,0,"span"),n()),e&2){let t=s.$implicit;i(),C(t.type=="User"?1:-1),i(),C(t.type=="Role"?2:-1)}}function mi(e,s){e&1&&(o(0,"th",42),a(1),l(2,"translate"),n()),e&2&&(i(),d(" ",c(2,1,"START_DATE")," "))}function li(e,s){if(e&1&&(x(0),a(1),l(2,"utcToLocalTime"),T()),e&2){let t=h().$implicit;i(),d(" ",Re(2,1,t.startDate,"shortDate")," ")}}function ci(e,s){e&1&&(x(0),a(1," -- "),T())}function pi(e,s){if(e&1&&(o(0,"td",43),f(1,li,3,4,"ng-container")(2,ci,2,0,"ng-container"),n()),e&2){let t=s.$implicit;i(),C(t.isTimeBound?1:2)}}function di(e,s){e&1&&(o(0,"th",42),a(1),l(2,"translate"),n()),e&2&&(i(),d(" ",c(2,1,"END_DATE")," "))}function ui(e,s){if(e&1&&(x(0),a(1),l(2,"utcToLocalTime"),T()),e&2){let t=h().$implicit;i(),d(" ",Re(2,1,t.endDate,"shortDate")," ")}}function _i(e,s){e&1&&(x(0),a(1," -- "),T())}function fi(e,s){if(e&1&&(o(0,"td",43),f(1,ui,3,4,"ng-container")(2,_i,2,0,"ng-container"),n()),e&2){let t=s.$implicit;i(),C(t.isTimeBound?1:2)}}function Ci(e,s){e&1&&(o(0,"td",44),P(1,"mat-paginator",45,1),n()),e&2&&(i(),v("pageSizeOptions",be(1,Vt)))}function Di(e,s){e&1&&(o(0,"tr")(1,"td",46)(2,"div",47)(3,"b"),a(4),l(5,"translate"),n()()()()),e&2&&(i(4),d(" ",c(5,1,"NO_DATA_FOUND")))}function vi(e,s){e&1&&P(0,"tr",48)}function Si(e,s){e&1&&P(0,"tr",49)}function hi(e,s){e&1&&P(0,"tr",50)}var vt=class e extends q{constructor(t,m,r,p,u,_,St,gi){super();this.documentPermissionService=t;this.route=m;this.commonDialogService=r;this.toastrService=p;this.dialog=u;this.commonService=_;this.data=St;this.dialogRef=gi;this.document=St}documentPermissions=[];document;isDocumentUpdate=!1;footerToDisplayed=["footer"];userStore=Le(lt);roles=[];documentPermissionsColumns=["action","type","isAllowDownload","name","email","startDate","endDate"];permissionsDataSource;userPermissionsPaginator;ngOnInit(){this.sub$.sink=this.route.params.subscribe(t=>{this.getDocumentPrmission(),this.getRoles()})}getDocumentPrmission(){this.sub$.sink=this.documentPermissionService.getDoucmentPermission(this.document.id??"").subscribe(t=>{this.documentPermissions=t,this.permissionsDataSource=new Ie(this.documentPermissions),this.permissionsDataSource.paginator=this.userPermissionsPaginator})}getRoles(){this.sub$.sink=this.commonService.getRoles().subscribe(t=>this.roles=t)}deleteDocumentUserPermission(t){this.sub$.sink=this.commonDialogService.deleteConfirmtionDialog(`${this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")}?`).subscribe(m=>{m&&(this.sub$.sink=this.documentPermissionService.deleteDocumentUserPermission(t.id??"").subscribe(()=>{this.toastrService.success(this.translationService.getValue("PERMISSION_DELETED_SUCCESSFULLY")),this.isDocumentUpdate=!0,this.getDocumentPrmission()}))})}deleteDocumentRolePermission(t){this.sub$.sink=this.commonDialogService.deleteConfirmtionDialog(`${this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")}?`).subscribe(m=>{m&&(this.sub$.sink=this.documentPermissionService.deleteDocumentRolePermission(t.id??"").subscribe(()=>{this.toastrService.success(this.translationService.getValue("PERMISSION_DELETED_SUCCESSFULLY")),this.isDocumentUpdate=!0,this.getDocumentPrmission()}))})}addDocumentUserPermission(){let t=this.dialog.open(xe,{width:"600px",data:Object.assign({users:this.userStore.users(),documentId:this.document.id})});this.sub$.sink=t.afterClosed().subscribe(m=>{m&&(this.isDocumentUpdate=!0,this.getDocumentPrmission())})}addDocumentRolePermission(){let t=this.dialog.open(Pe,{width:"600px",data:Object.assign({roles:this.roles,documentId:this.document.id})});this.sub$.sink=t.afterClosed().subscribe(m=>{m&&(this.isDocumentUpdate=!0,this.getDocumentPrmission())})}applyPermissionFilter(t){let m=t.target?.value.trim().toLocaleLowerCase();var r=this.documentPermissions.filter(p=>p.type=="User"&&(p.user?.firstName?.toLocaleLowerCase().includes(m)||p.user?.lastName?.toLocaleLowerCase().includes(m)||p.user?.email?.toLocaleLowerCase().includes(m))||p.type=="Role"&&p.role?.name?.toLocaleLowerCase().includes(m));this.permissionsDataSource=new Ie(r),this.permissionsDataSource.paginator=this.userPermissionsPaginator}closeDialog(){if(this.isDocumentUpdate){this.dialogRef.close("loaded");return}this.dialogRef.close()}static \u0275fac=function(m){return new(m||e)(D(k),D(Oe),D(ct),D(Q),D(Be),D(z),D(O),D(F))};static \u0275cmp=A({type:e,selectors:[["app-document-permission-list"]],viewQuery:function(m,r){if(m&1&&Ae(Ot,5),m&2){let p;ye(p=Ne())&&(r.userPermissionsPaginator=p.first)}},features:[y],decls:58,vars:24,consts:[["input1",""],["userPermissionsPaginator",""],[1,"d-flex"],[1,"me-auto","p-2"],[1,"mb-3","page-title"],[3,"code"],[1,"d-flex","justify-content-end","mb-2"],[1,"close-icon","text-danger","cursor-pointer",3,"click"],[1,"row"],[1,"d-flex","flex-wrap","gap-2","mb-3"],["matButton","filled","type","button",1,"success",3,"click"],[1,"medium-icon","fs-5","align-middle"],["matButton","filled","type","button",1,"error",3,"click"],[1,"col-md-12","form-group","mt-2","mb-2"],[1,"form-control",3,"keyup","placeholder"],[1,"table-responsive"],["mat-table","",2,"display","table !important",3,"dataSource"],["matColumnDef","action"],["style","width: 20%","mat-header-cell","",4,"matHeaderCellDef"],["style","width: 20%","mat-cell","",4,"matCellDef"],["matColumnDef","isAllowDownload"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","name"],["matColumnDef","email"],["matColumnDef","startDate"],["matColumnDef","endDate"],["matColumnDef","footer"],["mat-footer-cell","","colspan","7",4,"matFooterCellDef"],[4,"matNoDataRow"],["class","grid-header-color","mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef","matFooterRowDefSticky"],[1,"col-12","col-sm-6","col-md-4","mb-2"],[1,"mb-0"],[1,"col-12","col-sm-6","col-md-8","mb-2"],["mat-header-cell","",2,"width","20%"],["mat-cell","",2,"width","20%"],[4,"hasClaim"],["matMiniFab","",1,"error"],["matMiniFab","",1,"error",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-footer-cell","","colspan","7"],[3,"pageSizeOptions"],["colspan","5"],[1,"m-2"],["mat-header-row","",1,"grid-header-color"],["mat-row",""],["mat-footer-row",""]],template:function(m,r){if(m&1){let p=U();o(0,"mat-dialog-content")(1,"div",2)(2,"div",3)(3,"span",4),a(4),l(5,"translate"),P(6,"app-page-help-text",5),n()(),o(7,"div",6)(8,"mat-icon",7),S("click",function(){return g(p),E(r.closeDialog())}),a(9,"cancel"),n()()(),f(10,jt,8,5,"div",8),o(11,"div",9)(12,"button",10),S("click",function(){return g(p),E(r.addDocumentUserPermission())}),o(13,"mat-icon",11),a(14,"add"),n(),a(15),l(16,"translate"),n(),o(17,"button",12),S("click",function(){return g(p),E(r.addDocumentRolePermission())}),o(18,"mat-icon",11),a(19,"add"),n(),a(20),l(21,"translate"),n()(),o(22,"div",13)(23,"label"),a(24),l(25,"translate"),n(),o(26,"input",14,0),l(28,"translate"),S("keyup",function(_){return g(p),E(r.applyPermissionFilter(_))}),n()(),o(29,"div",15)(30,"table",16),x(31,17),b(32,$t,3,3,"th",18)(33,qt,2,2,"td",19),T(),x(34,20),b(35,Qt,3,3,"th",21)(36,Kt,3,1,"td",22),T(),x(37,23),b(38,Xt,3,3,"th",21)(39,Zt,2,1,"td",22),T(),x(40,24),b(41,ei,3,3,"th",21)(42,ni,3,2,"td",22),T(),x(43,25),b(44,oi,3,3,"th",21)(45,si,3,2,"td",22),T(),x(46,26),b(47,mi,3,3,"th",21)(48,pi,3,1,"td",22),T(),x(49,27),b(50,di,3,3,"th",21)(51,fi,3,1,"td",22),T(),x(52,28),b(53,Ci,3,2,"td",29),T(),b(54,Di,6,3,"tr",30)(55,vi,1,0,"tr",31)(56,Si,1,0,"tr",32)(57,hi,1,0,"tr",33),n()()()}m&2&&(i(4),d(" ",c(5,14,"SHARE_DOCUMENT")," "),i(2),v("code","SHARE_DOCUMENT"),i(4),C(r.document?10:-1),i(5),d(" ",c(16,16,"ASSIGN_USERS")," "),i(5),d(" ",c(21,18,"ASSIGN_ROLES")," "),i(4),M(c(25,20,"FILTER")),i(2),v("placeholder",R(c(28,22,"SEARCH_BY_USER_ROLE_NAME_AND_EMAIL"))),i(4),v("dataSource",r.permissionsDataSource),i(25),v("matHeaderRowDef",r.documentPermissionsColumns)("matHeaderRowDefSticky",!0),i(),v("matRowDefColumns",r.documentPermissionsColumns),i(),v("matFooterRowDef",r.footerToDisplayed)("matFooterRowDefSticky",!0))},dependencies:[mt,qe,ze,tt,Ke,Qe,nt,Je,it,Xe,et,Ze,ot,at,rt,st,Ye,We,V,B,Ge,Y,$e,K,G,$,j,H,Ve,W,He],encapsulation:2})};export{k as a,Pe as b,xe as c,vt as d};
