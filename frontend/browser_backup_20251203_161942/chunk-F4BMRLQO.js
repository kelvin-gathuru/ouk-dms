import{a as ue,b as _e,c as ke,d as fe}from"./chunk-KBYUC6BL.js";import{a as le,b as ce}from"./chunk-6QK67EK5.js";import{a as se,b as me,c as de}from"./chunk-NAYIGTW2.js";import{a as pe}from"./chunk-LTSUZ232.js";import{a as he}from"./chunk-DBWWD6JI.js";import{a as ae}from"./chunk-TC5US2P6.js";import{b as re}from"./chunk-WFK47GYZ.js";import{a as W}from"./chunk-6MWAWDLF.js";import{a as $,b as Q}from"./chunk-GE3TJVIQ.js";import{a as G}from"./chunk-ZXWR2MAY.js";import{c as oe}from"./chunk-756DJ4VK.js";import{b as A,c as R,e as O,f as V}from"./chunk-BQ4MMRNN.js";import{b as H}from"./chunk-JSAPTJHL.js";import{e as ne}from"./chunk-THB5JDTQ.js";import{a as U,b as j}from"./chunk-4E37NPLR.js";import{ta as P,va as B}from"./chunk-56QOWAU7.js";import{C as te,E as ie,c as X,h as q,i as Z,o as z,r as J,u as ee}from"./chunk-KYSGX4IW.js";import{$ as D,Ca as p,Da as u,Db as c,Eb as s,Ia as E,Ja as n,Ka as r,La as d,Pa as F,Pc as Y,Qa as N,Rc as K,Sa as L,Ua as f,W as a,Wa as x,e as b,eb as y,ga as I,ha as w,jb as l,ka as M,kb as S,lb as h,p as g,q as v,vb as T}from"./chunk-KZMFGXDY.js";var Ce=(()=>{class i{static \u0275fac=function(o){return new(o||i)};static \u0275mod=w({type:i});static \u0275inj=b({})}return i})();function Ee(i,_){if(i&1){let e=L();n(0,"div",9)(1,"div",13)(2,"div",14)(3,"label",15),l(4),c(5,"translate"),r()(),n(6,"div",16)(7,"button",17),f("click",function(){g(e);let t=x();return v(t.deleteDocumentLink())}),n(8,"mat-icon",18),l(9,"delete"),r()(),n(10,"button",19),f("click",function(){g(e);let t=x();return v(t.openLinkSettings())}),n(11,"mat-icon",18),l(12,"settings"),r()()()(),n(13,"div",20)(14,"div",21)(15,"div",22),d(16,"input",23),n(17,"button",24),f("click",function(){let t;g(e);let k=x();return v(k.copyToClipboard((t=k.documentLinkForm.get("linkCode"))==null?null:t.value))}),n(18,"mat-icon",25),l(19,"content_copy"),r(),l(20),c(21,"translate"),r()()()()()}i&2&&(a(4),S(s(5,2,"LINK_SHARING_IS_ON")),a(16),h(" ",s(21,4,"COPY")," "))}function Se(i,_){if(i&1){let e=L();F(0),n(1,"div",35),d(2,"input",36),c(3,"translate"),n(4,"div",37)(5,"button",38),f("click",function(){g(e);let t=y(9);return v(t.open())}),n(6,"mat-icon",39),l(7,"calendar_today"),r()()(),d(8,"mat-datepicker",null,0),r(),n(10,"div",35),d(11,"input",40),c(12,"translate"),n(13,"div",37)(14,"button",41),f("click",function(){g(e);let t=y(18);return v(t.open())}),n(15,"mat-icon",39),l(16,"access_time"),r()()(),d(17,"ngx-material-timepicker",null,1),r(),N()}if(i&2){let e=y(9),o=y(18),t=x(2);a(2),E("placeholder",T(s(3,9,"MM_DD_YYYY")))("matDatepicker",e)("min",t.minDate),a(9),E("placeholder",T(s(12,11,"EXPIRY_TIME")))("format",24)("ngxTimepicker",o)("disableClick",!0)}}function Le(i,_){i&1&&(n(0,"div",29),l(1),c(2,"translate"),r()),i&2&&(a(),h(" ",s(2,1,"EXPIRY_DATE_AND_TIME_ARE_REQUIRED")," "))}function ye(i,_){i&1&&(n(0,"div",29),l(1),c(2,"translate"),r()),i&2&&(a(),h(" ",s(2,1,"EXPIRY_TIME_ARE_REQUIRED")," "))}function Te(i,_){if(i&1&&(n(0,"div"),p(1,ye,3,3,"div",29),r()),i&2){let e,o=x(2);a(),u(!((e=o.documentLinkForm.get("linkExpiryTime"))==null||e.errors==null)&&e.errors.required?1:-1)}}function be(i,_){i&1&&(d(0,"input",32),c(1,"translate")),i&2&&E("placeholder",T(s(1,2,"ENTER_PASSWORD")))}function Ie(i,_){i&1&&(n(0,"div",29),l(1),c(2,"translate"),r()),i&2&&(a(),h(" ",s(2,1,"PASSWORD_IS_REQUIRED")," "))}function we(i,_){if(i&1&&(n(0,"div",10)(1,"div")(2,"section")(3,"label",26),l(4),c(5,"translate"),r(),n(6,"p"),d(7,"mat-checkbox",27),n(8,"label",28),l(9),c(10,"translate"),r()(),p(11,Se,19,13,"ng-container"),p(12,Le,3,3,"div",29),p(13,Te,2,1,"div"),r(),d(14,"hr"),n(15,"section")(16,"span"),l(17),c(18,"translate"),r(),n(19,"p"),d(20,"mat-checkbox",30),n(21,"label",31),l(22),c(23,"translate"),r()(),p(24,be,2,4,"input",32),p(25,Ie,3,3,"div",29),r(),d(26,"hr"),n(27,"section")(28,"span"),l(29),c(30,"translate"),r(),n(31,"p"),d(32,"mat-checkbox",33),n(33,"label",34),l(34),c(35,"translate"),r()()()()()),i&2){let e,o,t,k,C,m=x();a(4),S(s(5,11,"LINK_EXPIRATION")),a(5),S(s(10,13,"IS_LINK_VALID_UNTIL")),a(2),u((e=m.documentLinkForm.get("isLinkExpiryTime"))!=null&&e.value?11:-1),a(),u((o=m.documentLinkForm.get("isLinkExpiryTime"))!=null&&o.touched&&m.documentLinkForm.hasError("linkExpiryDateValidator")?12:-1),a(),u((t=m.documentLinkForm.get("linkExpiryTime"))!=null&&t.hasError("required")&&((t=m.documentLinkForm.get("linkExpiryDate"))!=null&&t.touched)?13:-1),a(4),h(" ",s(18,15,"PASSWORD_PROTECTION")),a(5),S(s(23,17,"IS_PASSWORD_REQUIRED")),a(2),u((k=m.documentLinkForm.get("isPassword"))!=null&&k.value?24:-1),a(),u((C=m.documentLinkForm.get("isPassword"))!=null&&C.touched&&m.documentLinkForm.hasError("passwordValidator")?25:-1),a(4),h(" ",s(30,19,"ALLOW_DOWNLOAD")),a(5),S(s(35,21,"USERS_WITH_LINK_CAN_DOWNLOAD_THIS_ITEM"))}}function Me(i,_){if(i&1){let e=L();n(0,"button",42),f("click",function(){g(e);let t=x();return v(t.createLink())}),n(1,"mat-icon",43),l(2,"save"),r(),l(3),c(4,"translate"),r()}i&2&&(a(3),h(" ",s(4,1,"CREATE_LINK")," "))}function Fe(i,_){if(i&1){let e=L();n(0,"button",42),f("click",function(){g(e);let t=x();return v(t.createLink())}),n(1,"mat-icon",43),l(2,"save"),r(),l(3),c(4,"translate"),r()}i&2&&(a(3),h(" ",s(4,1,"UPDATE_LINK")," "))}function Ne(i,_){i&1&&(n(0,"div",12),d(1,"mat-progress-spinner",44),r())}var xe=class i extends G{constructor(e,o,t,k,C,m){super();this.dialogRef=e;this.data=o;this.fb=t;this.documentService=k;this.toastrService=C;this.commonDialogService=m}documentLinkForm;isEditMode=!1;isResetLink=!1;minDate=new Date;isLoading=!1;baseUrl=`${window.location.protocol}//${window.location.host}/preview/`;ngOnInit(){this.createDocumentLinkForm(),this.data.link&&this.data.link.id&&(this.isEditMode=!0,this.pathValue())}timeValidator(e){let o=e.get("linkExpiryTime")?.value;return e.get("linkExpiryDate")?.value&&!o&&e.get("isLinkExpiryTime")?.value?e.get("linkExpiryTime")?.setErrors({required:!0}):e.get("linkExpiryDate")?.setErrors(null),null}pathValue(){if(this.documentLinkForm.patchValue(this.data.link),this.documentLinkForm.get("linkCode")?.setValue(`${this.baseUrl}${this.data.link.linkCode}`),this.data.link.linkExpiryTime){let e=new Date(this.data.link.linkExpiryTime),o=e.getHours().toString().padStart(2,"0"),t=e.getMinutes().toString().padStart(2,"0");this.documentLinkForm.get("linkExpiryDate")?.setValue(e),this.documentLinkForm.get("linkExpiryTime")?.setValue(`${o}:${t}`),this.documentLinkForm.get("isLinkExpiryTime")?.setValue(!0)}this.data.link.password&&this.documentLinkForm.get("isPassword")?.setValue(!0)}copyToClipboard(e){navigator.clipboard.writeText(e).then(()=>{this.toastrService.success(this.translationService.getValue("LINK_COPIED_TO_CLIPBOARD"))}).catch(()=>{this.toastrService.error(this.translationService.getValue("FAILED_TO_COPY_LINK"))})}createDocumentLinkForm(){var e=new Date;this.documentLinkForm=this.fb.group({id:[""],isLinkExpiryTime:[!1],linkExpiryDate:[e],linkExpiryTime:["12:00"],isPassword:[!1],password:[""],linkCode:[""],isAllowDownload:[!1]},{validators:[this.checkData,this.timeValidator]})}checkData(e){let o=e.get("isLinkExpiryTime")?.value,t=e.get("linkExpiryDate")?.value,k=e.get("isPassword")?.value,C=e.get("password")?.value,m={};return o&&!t&&(m.linkExpiryDateValidator=!0),k&&!C&&(m.passwordValidator=!0),m}openLinkSettings(){this.isResetLink=!this.isResetLink}createLink(){if(!this.documentLinkForm.valid){this.documentLinkForm.markAllAsTouched();return}let e=this.createBuildObject();this.isLoading=!0,this.sub$.sink=this.documentService.createDocumentShareableLink(e).subscribe({next:o=>{this.toastrService.success(this.translationService.getValue("LINK_GENERATED_SUCCESSFULLY")),this.data.link=o,this.isEditMode=!0,this.isResetLink=!1,this.isLoading=!1,this.pathValue()},error:o=>this.isLoading=!1})}deleteDocumentLink(){this.sub$.sink=this.commonDialogService.deleteConfirmtionDialog(this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")).subscribe(e=>{e&&(this.isLoading=!0,this.sub$.sink=this.documentService.deleteDocumentShareableLInk(this.data.link.id??"").subscribe({next:()=>{this.isLoading=!1,this.toastrService.success(this.translationService.getValue("DOCUMENT_LINK_DELETED_SUCCESSFULLY")),this.dialogRef.close()},error:()=>this.isLoading=!1}))})}closeDialog(){this.dialogRef.close()}createBuildObject(){let e=this.documentLinkForm.get("id")?.value,o=this.documentLinkForm.get("linkCode")?.value;o&&(o=o.replace(this.baseUrl,""));let t=null;if(this.documentLinkForm.get("isLinkExpiryTime")?.value){let C=new Date(this.documentLinkForm.get("linkExpiryDate")?.value),m=this.documentLinkForm.get("isLinkExpiryTime")?.value?this.documentLinkForm.get("linkExpiryTime")?.value:"";if(m&&typeof m=="string"){let[ge,ve]=m.split(":").map(Number);t=new Date(C.getFullYear(),C.getMonth(),C.getDate(),ge,ve)}}return{id:e,documentId:this.data.document.id??"",isAllowDownload:this.documentLinkForm.get("isAllowDownload")?.value,password:this.documentLinkForm.get("isPassword")?.value?this.documentLinkForm.get("password")?.value:"",linkExpiryTime:t??void 0,linkCode:o}}static \u0275fac=function(o){return new(o||i)(D(A),D(R),D(te),D(W),D(H),D(pe))};static \u0275cmp=I({type:i,selectors:[["ng-component"]],features:[M],decls:16,vars:10,consts:[["linkExpiryDatePicker",""],["timePicker",""],[1,"d-flex"],[1,"me-auto","p-2"],[1,"mb-3","page-title"],[3,"code"],[1,"d-flex","justify-content-end","mb-2"],[1,"close-icon","text-danger","cursor-pointer",3,"click"],[1,"form-group",3,"formGroup"],[1,"mb-3"],[1,"mb-2"],["type","submit","matButton","filled",1,"success","me-2"],[1,"spinner-container"],[1,"row","align-items-center","justify-content-between"],[1,"col-md","col"],["for","link",1,"form-label"],[1,"col-auto","col-m-auto"],[1,"text-danger","btn",3,"click"],[1,"fs-4","align-middle"],[1,"text-success","btn",3,"click"],[1,"row","mt-2"],[1,"col-md-12"],[1,"input-group"],["formControlName","linkCode","type","text","id","link","readonly","",1,"form-control","form-control-sm"],["type","button","matButton","filled","matTooltip","Copy",1,"success",3,"click"],[1,"medium-icon","fs-5","align-middle","me-1"],["for","isLinkExpiryTime",1,"form-label"],["color","primary","formControlName","isLinkExpiryTime"],["for","isLinkExpiryTime"],[1,"text-danger"],["color","primary","formControlName","isPassword"],["for","isPassword"],["autocomplete","new-password","type","password","formControlName","password",1,"form-control",3,"placeholder"],["formControlName","isAllowDownload","color","primary"],["for","isAllowDownload"],[1,"input-group","mb-3"],["matInput","","formControlName","linkExpiryDate",1,"form-control",3,"placeholder","matDatepicker","min"],[1,"input-group-append"],["type","button",1,"btn","btn-primary","calendar-button",3,"click"],[1,"medium-icon","fs-5","align-middle"],["formControlName","linkExpiryTime","readonly","",1,"form-control","timepicker-input",3,"format","placeholder","ngxTimepicker","disableClick"],["ngxMaterialTimepickerToggleIcon","","type","button",1,"btn","btn-primary","calendar-button",3,"click"],["type","submit","matButton","filled",1,"success","me-2",3,"click"],[1,"medium-icon"],["mode","indeterminate","diameter","60","strokeWidth","5"]],template:function(o,t){o&1&&(n(0,"mat-dialog-content")(1,"div",2)(2,"div",3)(3,"span",4),l(4),c(5,"translate"),d(6,"app-page-help-text",5),r()(),n(7,"div",6)(8,"mat-icon",7),f("click",function(){return t.closeDialog()}),l(9,"cancel"),r()()(),n(10,"form",8),p(11,Ee,22,6,"div",9),p(12,we,36,23,"div",10),p(13,Me,5,3,"button",11),p(14,Fe,5,3,"button",11),r(),p(15,Ne,2,0,"div",12),r()),o&2&&(a(4),h(" ",s(5,8,"SHAREABLE_LINK")," "),a(2),E("code","SHAREABLE_LINK"),a(4),E("formGroup",t.documentLinkForm),a(),u(t.isEditMode?11:-1),a(),u(!t.isEditMode||t.isResetLink?12:-1),a(),u(t.isEditMode?-1:13),a(),u(t.isEditMode&&t.isResetLink?14:-1),a(),u(t.isLoading?15:-1))},dependencies:[ie,z,X,q,Z,J,ee,he,ce,le,de,se,me,fe,ue,ke,_e,Ce,ae,re,V,O,B,P,oe,K,ne,j,U,Q,$,Y],encapsulation:2})};export{xe as a};
