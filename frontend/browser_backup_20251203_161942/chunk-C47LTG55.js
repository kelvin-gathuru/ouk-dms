import{a as ae,b as le,c as re}from"./chunk-DFQZAZAP.js";import{a as de}from"./chunk-TBG6OJJS.js";import{a as oe}from"./chunk-MHTWOIH5.js";import"./chunk-7UZYWCAJ.js";import"./chunk-PT2JM3JA.js";import{a as ne}from"./chunk-D6HICPES.js";import{c as te}from"./chunk-BBTJI4ZO.js";import"./chunk-L52YSXRC.js";import{a as ee}from"./chunk-6MWAWDLF.js";import{a as H}from"./chunk-6GBRFDEJ.js";import{b as $,c as j,e as U,f as Q}from"./chunk-BQ4MMRNN.js";import{e as ie}from"./chunk-THB5JDTQ.js";import{a as q,b as K}from"./chunk-4E37NPLR.js";import{va as Z}from"./chunk-56QOWAU7.js";import{a as J}from"./chunk-C3OPHOKD.js";import"./chunk-DGFNMOMG.js";import{$ as x,$a as A,Ab as O,Bb as L,Ca as c,Da as m,Db as p,Ea as b,Eb as s,Fb as g,Ga as M,Ha as P,Ia as C,Ib as S,Ja as a,Ka as i,La as k,Pc as X,Rc as Y,Sa as G,Ua as V,W as n,Wa as u,_a as N,ab as B,fb as F,ga as D,jb as o,kb as f,kc as z,lb as d,ma as y,mb as W,p as I,q as T,r as w,za as h,zb as R}from"./chunk-KZMFGXDY.js";import"./chunk-W3TJXGK4.js";import{p as E}from"./chunk-H5HZ6YB3.js";var me=["graph"],se=()=>({orientation:"TB"}),ce=t=>({"col-md-12":t}),ue=(t,l)=>({"bg-success":t,"bg-danger":l});function fe(t,l){t&1&&(w(),a(0,"marker",24),k(1,"path",25),i())}function _e(t,l){if(t&1&&(w(),a(0,"g",26),k(1,"rect"),a(2,"text",27),o(3),i()()),t&2){let e=l.$implicit;n(),h("width",(e.dimension==null?null:e.dimension.width)||100)("height",(e.dimension==null?null:e.dimension.height)||50)("fill",(e.data==null?null:e.data.color)||"#ccc"),n(),h("fill","#fff")("x",10)("y",((e.dimension==null?null:e.dimension.height)||50)/2),n(),d(" ",e.label," ")}}function xe(t,l){if(t&1&&(w(),a(0,"g",28),k(1,"path",29),a(2,"text",30)(3,"textPath",31),o(4),i()()()),t&2){let e=u().$implicit;n(3),F("dominant-baseline",e.dominantBaseline),h("fill",e.status===1?"green":"black")("href","#"+e.id),n(),d(" ",e.label," ")}}function ge(t,l){if(t&1&&c(0,xe,5,5,":svg:g",28),t&2){let e=l.$implicit;m(e.source&&e.target?0:-1)}}function Ce(t,l){if(t&1&&(a(0,"p",21)(1,"strong"),o(2),p(3,"translate"),i(),o(4),i()),t&2){let e=u();n(2),d("",s(3,2,"DESCRIPTION"),":"),n(2),d(" ",e.data.workflowDescription)}}function ve(t,l){if(t&1&&(a(0,"p",21)(1,"strong"),o(2,"Assigned To Roles:"),i(),o(3),i()),t&2){let e=u().$implicit;n(3),d(" ",e.assignRoles," ")}}function we(t,l){if(t&1&&(a(0,"p",21)(1,"strong"),o(2,"Assigned To Users:"),i(),o(3),i()),t&2){let e=u().$implicit;n(3),d(" ",e.assignUsers," ")}}function he(t,l){if(t&1&&(a(0,"div",15)(1,"div",16)(2,"mat-icon",33),o(3,"schedule"),i(),a(4,"div")(5,"span",34),o(6),i(),a(7,"small",35),o(8),p(9,"translate"),i()()(),a(10,"div",19)(11,"div",36)(12,"div",37)(13,"span",38),o(14),i()(),a(15,"div",39)(16,"mat-icon",40),o(17,"arrow_right_alt"),i(),a(18,"small",41),o(19),p(20,"translate"),i()(),a(21,"div",42)(22,"span",38),o(23),i()()(),c(24,ve,4,1,"p",21),c(25,we,4,1,"p",21),i()()),t&2){let e=l.$implicit;n(6),f(e.name),n(2),d(" ",s(9,7,"PENDING")),n(6),f(e.fromStepName),n(5),f(s(20,9,"PENDING")),n(4),f(e.toStepName),n(),m(e!=null&&e.assignRoles?24:-1),n(),m(e!=null&&e.assignUsers?25:-1)}}function ke(t,l){if(t&1&&(a(0,"div",23)(1,"div",9)(2,"div",14)(3,"span",32),o(4),p(5,"translate"),i()()(),M(6,he,26,11,"div",15,b),i()),t&2){let e=u();C("ngClass",O(4,ce,(e.data.completedWorkflowTransitionInstances==null?null:e.data.completedWorkflowTransitionInstances.length)==0)),n(4),f(s(5,2,"PENDING_TRANSITIONS")),n(2),P(e.data.pendingWorkflowTransitions)}}function Se(t,l){t&1&&(a(0,"mat-icon",44),o(1,"check_circle"),i())}function Ee(t,l){t&1&&(a(0,"mat-icon",33),o(1,"schedule"),i())}function Ie(t,l){t&1&&(a(0,"mat-icon",46),o(1,"arrow_right_alt"),i())}function Te(t,l){t&1&&(a(0,"mat-icon",47),o(1,"arrow_right_alt"),i())}function be(t,l){t&1&&(a(0,"small",48),o(1,"Completed"),i())}function Me(t,l){if(t&1&&(a(0,"p",21)(1,"strong"),o(2,"Created Date:"),i(),o(3),p(4,"utcToLocalTime"),i()),t&2){let e=u().$implicit;n(3),d(" ",g(4,1,e.createdAt,"full"))}}function Pe(t,l){if(t&1&&(a(0,"p",21)(1,"strong"),o(2,"Completed Date:"),i(),o(3),p(4,"utcToLocalTime"),i()),t&2){let e=u().$implicit;n(3),d(" ",g(4,1,e.completedAt,"full"))}}function Ve(t,l){if(t&1&&(a(0,"p",21)(1,"strong"),o(2,"Perform By:"),i(),o(3),i()),t&2){let e=u().$implicit;n(3),W(" ",e==null||e.user==null?null:e.user.lastName,"\xA0\xA0",e.user==null?null:e.user.firstName)}}function We(t,l){if(t&1&&(a(0,"p",21)(1,"strong"),o(2,"Comment:"),i(),o(3),i()),t&2){let e=u().$implicit;n(3),d(" ",e==null?null:e.comment)}}function Oe(t,l){if(t&1&&(a(0,"div",15)(1,"div",16),c(2,Se,2,0,"mat-icon",44),c(3,Ee,2,0,"mat-icon",33),a(4,"div")(5,"span",18),o(6),i(),a(7,"small",45),o(8),i()()(),a(9,"div",19)(10,"div",36)(11,"div",37)(12,"span",38),o(13),i()(),a(14,"div",39),c(15,Ie,2,0,"mat-icon",46),c(16,Te,2,0,"mat-icon",47),c(17,be,2,0,"small",48),i(),a(18,"div",42)(19,"span",38),o(20),i()()(),c(21,Me,5,4,"p",21),c(22,Pe,5,4,"p",21),c(23,Ve,4,2,"p",21),c(24,We,4,1,"p",21),i()()),t&2){let e=l.$implicit;n(2),m(e.status==1?2:-1),n(),m(e.status==0?3:-1),n(3),f(e.name),n(),C("ngClass",L(14,ue,e.status==1,e.status==0)),n(),d(" ",e.status==1?"Completed":"Initiated"," "),n(5),f(e.fromStepName),n(2),m(e.status==1?15:-1),n(),m(e.status==0?16:-1),n(),m(e.status==1?17:-1),n(3),f(e.toStepName),n(),m(e.createdAt?21:-1),n(),m(e.completedAt&&e.status==1?22:-1),n(),m(e!=null&&e.user?23:-1),n(),m(e!=null&&e.comment?24:-1)}}function De(t,l){if(t&1&&(a(0,"div",23)(1,"div",9)(2,"div",14)(3,"span",43),o(4),p(5,"translate"),i()()(),M(6,Oe,25,17,"div",15,b),i()),t&2){let e=u();C("ngClass",O(4,ce,(e.data.pendingWorkflowTransitions==null?null:e.data.pendingWorkflowTransitions.length)==0)),n(4),f(s(5,2,"COMPLETED_TRANSTIONS")),n(2),P(e.data.completedWorkflowTransitionInstances)}}var pe=class t{constructor(l,e,r,_,v){this.dialogRef=l;this.data=e;this.clonerService=r;this.documentService=_;this.overlay=v;this.nodes=this.clonerService.deepClone(e.nodes),this.links=this.clonerService.deepClone(e.links),this.customColors=this.clonerService.deepClone(e.customColors)}nodes=[];links=[];curve=ae;customColors=[];graph;WORKFLOW_INSTANCE_STATUS=oe;onDocumentCancel(){this.dialogRef.close()}onDocumentView(){return E(this,null,function*(){this.documentService.getDocument(this.data.documentId).subscribe(l=>E(this,null,function*(){let r=(l.url?.split(".")??[])[1],_={documentId:l.id,name:l.name,url:l.url,extension:r,isVersion:!1,isFromPublicPreview:!1,isPreviewDownloadEnabled:!1,isFileRequestDocument:!1,isSignatureExists:l.isSignatureExists,documentNumber:l.documentNumber},{BasePreviewComponent:v}=yield import("./chunk-JJBHCVNV.js");this.overlay.open(v,{position:"center",origin:"global",panelClass:["file-preview-overlay-container","white-background"],data:_})}))})}ngAfterViewInit(){setTimeout(()=>{this.graph})}static \u0275fac=function(e){return new(e||t)(x($),x(j),x(J),x(ee),x(te))};static \u0275cmp=D({type:t,selectors:[["app-visual-workflow-graph"]],viewQuery:function(e,r){if(e&1&&N(me,5),e&2){let _;A(_=B())&&(r.graph=_.first)}},decls:72,vars:52,consts:[["graph",""],["defsTemplate",""],["nodeTemplate",""],["linkTemplate",""],[1,"d-flex"],[1,"me-auto","p-2"],[1,"mb-3","page-title"],[1,"d-flex","justify-content-end","mb-2"],[1,"close-icon","text-danger","cursor-pointer",3,"click"],[1,"row"],[1,"col-sm-3"],[1,"ngx-graph-height"],[1,"chart-container",3,"layoutSettings","links","nodes","layout","curve","panOnZoom","autoCenter","autoZoom"],[1,"col-sm-9"],[1,"col"],[1,"card","shadow","mt-2"],[1,"card-header","d-flex","align-items-center"],[1,"medium-icon","fs-5","align-middle"],[1,"px-2","h5","font-weight-bold","mb-0"],[1,"card-body"],[1,"col-6"],[1,"h6"],[1,"doc-link",3,"click"],[1,"col-md-6","col-sm-12",3,"ngClass"],["id","arrow","viewBox","0 -5 10 10","refX","8","refY","0","markerWidth","4","markerHeight","4","orient","auto"],["d","M0,-5L10,0L0,5",1,"arrow-head"],[1,"node"],["alignment-baseline","central"],[1,"edge"],["stroke-width","2","marker-end","url(#arrow)",1,"line"],["text-anchor","middle",1,"edge-label"],["startOffset","50%",1,"text-path"],[1,"px-2","h5","font-weight-bold","mb-0","text-danger"],[1,"text-danger","medium-icon","fs-5","align-middle"],[1,"px-2","h6","font-weight-bold","mb-0"],[1,"badge","bg-danger"],[1,"d-flex","align-items-center","justify-content-left"],[1,"text-center","me-3"],[1,"h6","mb-1"],[1,"text-center","me-3","pt-3"],[1,"text-danger","medium-icon"],[1,"d-block","text-danger","font-size-7"],[1,"text-center"],[1,"px-2","h5","font-weight-bold","mb-0","text-success"],[1,"text-success","medium-icon","fs-5","align-middle"],[1,"badge",3,"ngClass"],[1,"text-success","medium-icon","fs-4","align-middle"],[1,"text-danger","medium-icon","fs-4","align-middle"],[1,"d-block","font-size-7","text-success"]],template:function(e,r){if(e&1){let _=G();a(0,"mat-dialog-content")(1,"div",4)(2,"div",5)(3,"span",6),o(4),p(5,"limitTo"),i()(),a(6,"div",7)(7,"mat-icon",8),V("click",function(){return I(_),T(r.onDocumentCancel())}),o(8,"cancel"),i()()(),a(9,"div",9)(10,"div",10)(11,"div",11)(12,"ngx-graph",12,0),y(14,fe,2,0,"ng-template",null,1,S)(16,_e,4,7,"ng-template",null,2,S)(18,ge,1,1,"ng-template",null,3,S),i()()(),a(20,"div",13)(21,"div",9)(22,"div",14)(23,"div",15)(24,"div",16)(25,"mat-icon",17),o(26,"info"),i(),a(27,"span",18),o(28),p(29,"translate"),i()(),a(30,"div",19)(31,"div",9)(32,"div",20)(33,"p",21)(34,"strong"),o(35),p(36,"translate"),i(),o(37),i(),c(38,Ce,5,4,"p",21),a(39,"p",21)(40,"strong"),o(41),p(42,"translate"),i(),o(43),p(44,"workflowInstanceStatus"),i()(),a(45,"div",20)(46,"p",21)(47,"strong"),o(48),p(49,"translate"),i(),a(50,"a",22),V("click",function(){return I(_),T(r.onDocumentView())}),o(51),i()(),a(52,"p",21)(53,"strong"),o(54),p(55,"translate"),i(),o(56),p(57,"utcToLocalTime"),i(),a(58,"p",21)(59,"strong"),o(60),p(61,"translate"),i(),o(62),p(63,"utcToLocalTime"),i(),a(64,"p",21)(65,"strong"),o(66),p(67,"translate"),i(),o(68),i()()()()()()(),a(69,"div",9),c(70,ke,8,6,"div",23),c(71,De,8,6,"div",23),i()()()()}e&2&&(n(4),d("",g(5,26,r.data.workflowName,"100")," "),n(8),C("layoutSettings",R(51,se))("links",r.links)("nodes",r.nodes)("layout","dagre")("curve",r.curve)("panOnZoom",!0)("autoCenter",!1)("autoZoom",!0),n(16),f(s(29,29,"WORKFLOW_DETAILS")),n(7),d("",s(36,31,"NAME"),":"),n(2),d(" ",r.data.workflowName),n(),m(r.data.workflowDescription?38:-1),n(3),d("",s(42,33,"STATUS"),":"),n(2),d(" ",s(44,35,r.data.workflowInstanceStatus)),n(5),d("",s(49,37,"DOCUMENT"),":"),n(3),W("",r.data.documentNumber,"-",r.data.documentName),n(3),d("",s(55,39,"CREATED_DATE"),":"),n(2),d(" ",g(57,41,r.data.createdAt,"full")," "),n(4),d("",s(61,44,"UPDATED_DATE"),":"),n(2),d(" ",g(63,46,r.data.updatedAt,"full")," "),n(4),d("",s(67,49,"INITIATED_BY"),":"),n(2),d(" ",r.data.initiatedBy," "),n(2),m(r.data&&r.data.pendingWorkflowTransitions&&r.data.pendingWorkflowTransitions.length>0?70:-1),n(),m(r.data&&r.data.completedWorkflowTransitionInstances&&r.data.completedWorkflowTransitionInstances.length>0?71:-1))},dependencies:[re,le,Z,K,q,Q,U,Y,z,ie,X,de,H,ne],styles:[".node-details[_ngcontent-%COMP%]{background:#f9f9f9;border:1px solid #ddd;border-radius:8px;padding:8px;text-align:center;box-shadow:0 2px 4px #0000001a}.node-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;font-size:16px}.node-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#555}.text-path-green[_ngcontent-%COMP%]{fill:none;stroke:#0f0;stroke-width:2px}.text-path-red[_ngcontent-%COMP%]{fill:none;stroke:red;stroke-width:2px}.workflow-timeline[_ngcontent-%COMP%]{padding:16px;font-family:Arial,sans-serif}.workflow-timeline[_ngcontent-%COMP%]   .timeline-step[_ngcontent-%COMP%]{border:1px solid #ddd;border-radius:8px;padding:12px;margin-bottom:16px;background:#f9f9f9;box-shadow:0 2px 4px #0000001a}.workflow-timeline[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;color:#333}.workflow-timeline[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;font-size:14px;color:#555}.workflow-timeline[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#000}.workflow[_ngcontent-%COMP%]{display:flex;align-items:center}.step[_ngcontent-%COMP%]{padding:5px;background-color:#f0f0f0;border:1px solid #ccc;border-radius:5px}.arrow[_ngcontent-%COMP%]{margin:0 10px;font-size:1.5em}.step-box[_ngcontent-%COMP%]{border-radius:2px;font-size:14px;background-color:#f8f9fa;border:1px solid #dee2e6}.step-box.complete[_ngcontent-%COMP%]{background-color:#d4edda;border-color:#c3e6cb;color:#155724}.font-size-8[_ngcontent-%COMP%]{font-size:8px}.ngx-graph-height[_ngcontent-%COMP%]{width:100%;height:1024px}@media (max-width: 768px){.graph-container[_ngcontent-%COMP%]{width:100%;overflow:auto}.dialog-title[_ngcontent-%COMP%]{font-size:1rem;word-break:break-word}.edge-label[_ngcontent-%COMP%]{font-size:12px}.ngx-graph-container[_ngcontent-%COMP%]{display:flex;justify-content:center}.ngx-graph-height[_ngcontent-%COMP%]{width:100%;height:500px}}"]})};export{pe as VisualWorkflowGraphComponent};
