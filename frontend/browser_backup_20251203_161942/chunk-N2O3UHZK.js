import{a as ne}from"./chunk-6PMQMASS.js";import{a as ie}from"./chunk-LTSUZ232.js";import{a as $}from"./chunk-6GBRFDEJ.js";import{a as P}from"./chunk-ZXWR2MAY.js";import{c as te}from"./chunk-756DJ4VK.js";import{a as Y}from"./chunk-JYYDN77K.js";import{b as O,c as U,e as B,f as R}from"./chunk-BQ4MMRNN.js";import{e as ee}from"./chunk-THB5JDTQ.js";import{a as w,b as L}from"./chunk-4E37NPLR.js";import{va as V}from"./chunk-56QOWAU7.js";import{C as X,E as Z,c as q,e as H,h as Q,i as W,o as z,r as J,u as K}from"./chunk-KYSGX4IW.js";import{$ as d,Ca as h,Da as x,Db as s,Eb as u,Fa as I,Fb as A,Ga as y,Ha as N,Ia as C,Ja as n,Ka as o,La as b,Pc as G,Rc as j,Sa as E,Ua as f,W as i,Wa as _,ga as T,jb as r,ka as M,lb as l,ma as g,mb as k,p as D,q as v,za as F,zb as S}from"./chunk-KZMFGXDY.js";var me=()=>["ALL_ADD_COMMENT","ASSIGNED_ADD_COMMENT"],re=()=>["ALL_DELETE_COMMENT","ASSIGNED_DELETE_COMMENT"];function ae(t,p){if(t&1){let e=E();n(0,"span",20),f("click",function(){D(e);let a=_().$implicit,c=_();return v(c.onDelete(a.id??""))}),n(1,"mat-icon",21),r(2,"delete"),o()()}}function ce(t,p){if(t&1&&(n(0,"div",9)(1,"span",15),g(2,ae,3,0,"span",16),r(3),o(),n(4,"div",17)(5,"small",18),r(6),s(7,"translate"),n(8,"small",19),r(9),o(),r(10),s(11,"translate"),s(12,"utcToLocalTime"),o()()()),t&2){let e=p.$implicit;F("aria-current",!0),i(2),C("hasClaim",S(14,re)),i(),l(" ",e.comment," "),i(3),l(" ",u(7,7,"BY")," "),i(3),l("",e==null?null:e.createdBy," "),i(),k(" ",u(11,9,"AT")," ",A(12,11,e.createdDate,"shortDate")," ")}}function le(t,p){t&1&&(n(0,"div",22),r(1),s(2,"translate"),o()),t&2&&(i(),l(" ",u(2,1,"COMMENT_IS_REQUIRED")," "))}function se(t,p){if(t&1&&(n(0,"div"),h(1,le,3,3,"div",22),o()),t&2){let e,m=_();i(),x(!((e=m.commentForm.get("comment"))==null||e.errors==null)&&e.errors.required?1:-1)}}function pe(t,p){if(t&1){let e=E();n(0,"button",23),f("click",function(){D(e);let a=_();return v(a.addComment())}),n(1,"mat-icon",24),r(2,"message"),o(),r(3),s(4,"translate"),o()}t&2&&(i(3),l(" ",u(4,1,"ADD_COMMENT")," "))}var oe=class t extends P{constructor(e,m,a,c,de){super();this.fb=e;this.data=m;this.documentCommentService=a;this.dialogRef=c;this.commonDialogService=de}commentForm;documentComments=[];isCommentUpdate=!1;ngOnInit(){this.createForm(),this.getDocumentComment()}closeDialog(){if(this.isCommentUpdate){this.dialogRef.close("loaded");return}this.dialogRef.close()}createForm(){this.commentForm=this.fb.group({comment:["",[H.required]]})}getDocumentComment(){this.sub$.sink=this.documentCommentService.getDocumentComment(this.data.id).subscribe(e=>{this.documentComments=e})}patchComment(e){this.commentForm.patchValue({comment:e})}addComment(){if(this.commentForm.invalid){this.commentForm.markAllAsTouched();return}let e={documentId:this.data.id,comment:this.commentForm.get("comment")?.value};this.sub$.sink=this.documentCommentService.saveDocumentComment(e).subscribe(m=>{this.patchComment(""),this.isCommentUpdate=!0,this.commentForm.markAsUntouched(),this.getDocumentComment()})}onDelete(e){this.sub$.sink=this.commonDialogService.deleteConfirmtionDialog(`${this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")}?`).subscribe(m=>{m&&(this.sub$.sink=this.documentCommentService.deleteDocumentComment(e).subscribe(()=>{this.isCommentUpdate=!0,this.getDocumentComment()}))})}static \u0275fac=function(m){return new(m||t)(d(X),d(U),d(ne),d(O),d(ie))};static \u0275cmp=T({type:t,selectors:[["app-document-comment"]],features:[M],decls:23,vars:8,consts:[[1,"d-flex"],[1,"me-auto","p-2"],[1,"mb-3","page-title"],[3,"code"],[1,"d-flex","justify-content-end","mb-2"],[1,"close-icon","text-danger","cursor-pointer",3,"click"],[1,"row"],[1,"col-sm-12"],[1,"list-group"],[1,"list-group-item","list-group-item-action"],[1,"mt-3",3,"formGroup"],[1,"form-group"],["formControlName","comment","rows","3",1,"form-control"],[1,"col-md-12","mt-2"],["type","submit","class","btn btn-success",3,"click",4,"hasClaim"],[1,"mb-1"],["role","button","class","badge",3,"click",4,"hasClaim"],[1,"w-100"],[1,"mr-2"],[1,"text-primary"],["role","button",1,"badge",3,"click"],[1,"medium-icon","text-danger"],[1,"text-danger"],["type","submit",1,"btn","btn-success",3,"click"],[1,"medium-icon","fs-5","align-middle"]],template:function(m,a){if(m&1&&(n(0,"mat-dialog-content")(1,"div",0)(2,"div",1)(3,"span",2),r(4),s(5,"translate"),b(6,"app-page-help-text",3),o()(),n(7,"div",4)(8,"mat-icon",5),f("click",function(){return a.closeDialog()}),r(9,"cancel"),o()()(),n(10,"div",6)(11,"div",7)(12,"div",8),y(13,ce,13,15,"div",9,I),o()()(),n(15,"div",6)(16,"div",7)(17,"form",10)(18,"div",11),b(19,"textarea",12),h(20,se,2,1,"div"),o(),n(21,"div",13),g(22,pe,5,3,"button",14),o()()()()()),m&2){let c;i(4),l(" ",u(5,5,"COMMENT")," "),i(2),C("code","DOCUMENT_COMMENTS"),i(7),N(a.documentComments),i(4),C("formGroup",a.commentForm),i(3),x((c=a.commentForm.get("comment"))!=null&&c.touched&&((c=a.commentForm.get("comment"))!=null&&c.errors)?20:-1),i(2),C("hasClaim",S(7,me))}},dependencies:[te,Y,Z,z,q,Q,W,J,K,R,B,j,L,w,ee,V,G,$],encapsulation:2})};export{oe as a};
