import{a as St}from"./chunk-2EZE64U4.js";import"./chunk-GVGC473E.js";import{a as A}from"./chunk-PM3ZOWUF.js";import{a as H}from"./chunk-XA5EPKK2.js";import{a as ht,b as bt,c as gt,d as xt,e as Rt,f as wt,g as Dt,h as It,i as Nt,j as Et,k as Tt,l as Mt,m as yt,n as Ot,o as Lt,p as kt}from"./chunk-O4QTDGQI.js";import{a as rt}from"./chunk-QNGW2BG4.js";import{a as pt}from"./chunk-UCAGIDEK.js";import"./chunk-TC5US2P6.js";import"./chunk-WFK47GYZ.js";import{c as dt}from"./chunk-BBTJI4ZO.js";import"./chunk-L52YSXRC.js";import{a as st}from"./chunk-6MWAWDLF.js";import{a as nt}from"./chunk-6GBRFDEJ.js";import{a as lt,b as mt}from"./chunk-GE3TJVIQ.js";import{a as at}from"./chunk-ZXWR2MAY.js";import"./chunk-G4LST2RF.js";import{a as Ht}from"./chunk-34GVGY2U.js";import"./chunk-FWRBVAV4.js";import"./chunk-NH2LHIRZ.js";import"./chunk-DTECNCC4.js";import"./chunk-2FSKRITI.js";import"./chunk-TQCCWZBZ.js";import"./chunk-QPRQJRAS.js";import{c as Ct}from"./chunk-756DJ4VK.js";import"./chunk-JYYDN77K.js";import{d as Z}from"./chunk-BQ4MMRNN.js";import{b as ct}from"./chunk-JSAPTJHL.js";import"./chunk-UFOTACYY.js";import{a as ft,b as ut,c as _t,e as vt}from"./chunk-THB5JDTQ.js";import{a as tt,b as et}from"./chunk-4E37NPLR.js";import{ua as J,va as X}from"./chunk-56QOWAU7.js";import"./chunk-77WXBMFN.js";import"./chunk-XFBX5CPU.js";import"./chunk-C3OPHOKD.js";import"./chunk-KYSGX4IW.js";import"./chunk-LCPYESOB.js";import"./chunk-BFSIXXTJ.js";import"./chunk-DGFNMOMG.js";import{$ as S,$a as D,Ca as d,Da as f,Db as u,Eb as _,Fb as Y,Ia as v,Ja as r,Ka as s,La as C,Pa as b,Pc as it,Qa as g,Rc as ot,Sa as O,Ua as L,W as i,Wa as p,_a as w,ab as I,ga as W,jb as a,ka as z,kb as Q,lb as l,ma as h,mb as G,p as M,q as y,rc as K,vb as q,zb as k}from"./chunk-KZMFGXDY.js";import{Pa as B,Ya as P,_b as T,fa as U,gb as $,la as j,o as R}from"./chunk-W3TJXGK4.js";import{p as x}from"./chunk-H5HZ6YB3.js";var N=class{constructor(o){this.notificationService=o}notificationsSubject=new R([]);responseHeaderSubject=new R({});loadingSubject=new R(!1);loading$=this.loadingSubject.asObservable();_count=0;get count(){return this._count}responseHeaderSubject$=this.responseHeaderSubject.asObservable();connect(o){return this.notificationsSubject.asObservable()}disconnect(o){this.notificationsSubject.complete(),this.loadingSubject.complete()}loadNotifications(o){this.loadingSubject.next(!0),this.notificationService.getNotifications(o).pipe($(()=>this.loadingSubject.next(!1))).subscribe(e=>{let n=JSON.parse(e.headers.get("X-Pagination")??"{}");this.responseHeaderSubject.next(n);let c=[...e.body??[]];this._count=c.length,this.notificationsSubject.next(c)})}};var At=["input"],Vt=()=>["footer"],Ft=()=>[10,20,30];function Ut(t,o){t&1&&(r(0,"th",29),a(1),u(2,"translate"),s()),t&2&&(i(),l(" ",_(2,1,"ACTION")," "))}function jt(t,o){if(t&1){let e=O();r(0,"button",32),L("click",function(){M(e);let c=p().$implicit,m=p();return y(m.viewDocument(c))}),r(1,"mat-icon",33),a(2,"description"),s()(),a(3,"\xA0\xA0 ")}}function Bt(t,o){if(t&1){let e=O();r(0,"button",34),L("click",function(){M(e);let c=p().$implicit,m=p();return y(m.viewVisualWorkflow(c))}),r(1,"mat-icon",33),a(2,"device_hub"),s()()}}function Pt(t,o){if(t&1&&(r(0,"td",30),d(1,jt,4,0),d(2,Bt,3,0,"button",31),s()),t&2){let e=o.$implicit;i(),f(e.documentId?1:-1),i(),f(e.workflowInstanceId?2:-1)}}function $t(t,o){t&1&&(r(0,"th",35),a(1),u(2,"translate"),s()),t&2&&(i(),l(" ",_(2,1,"DATE")," "))}function Wt(t,o){if(t&1&&(r(0,"td",36),a(1),u(2,"utcToLocalTime"),s()),t&2){let e=o.$implicit;i(),l(" ",Y(2,1,e.createdDate,"full")," ")}}function zt(t,o){t&1&&(r(0,"th",37),a(1),u(2,"translate"),s()),t&2&&(i(),l(" ",_(2,1,"MESSAGE")," "))}function Qt(t,o){t&1&&(r(0,"span",39),a(1,"new"),s())}function Gt(t,o){if(t&1&&(r(0,"b"),a(1),s(),a(2),u(3,"translate")),t&2){let e=p().$implicit;i(),l(" ",e.documentName),i(),l(" ",_(3,2,"DOCUMENT_PERMISSION_GRANTED_TO_YOU")," ")}}function qt(t,o){if(t&1&&(r(0,"b"),a(1),u(2,"translate"),s(),a(3)),t&2){let e=p(2).$implicit;i(),l(" ",_(2,3,"DOCUMENT_NAME")),i(2),G(" : ",e.documentNumber,"-",e.documentName," :: ")}}function Yt(t,o){if(t&1&&(r(0,"b"),a(1),u(2,"translate"),s(),a(3," :: "),d(4,qt,4,5),a(5)),t&2){let e=p().$implicit;i(),Q(_(2,3,"REMINDER")),i(3),f(e!=null&&e.documentId?4:-1),i(),l(" ",e.message," ")}}function Kt(t,o){if(t&1&&a(0),t&2){let e=p().$implicit;l(" ",e.message," ")}}function Zt(t,o){if(t&1&&a(0),t&2){let e=p().$implicit;l(" ",e.message," ")}}function Jt(t,o){if(t&1&&a(0),t&2){let e=p().$implicit;l(" ",e.message," ")}}function Xt(t,o){if(t&1&&a(0),t&2){let e=p().$implicit;l(" ",e.message," ")}}function te(t,o){if(t&1&&(r(0,"td",38),d(1,Qt,2,0,"span",39),d(2,Gt,4,4),d(3,Yt,6,5),d(4,Kt,1,1),d(5,Zt,1,1),d(6,Jt,1,1),d(7,Xt,1,1),s()),t&2){let e=o.$implicit;i(),f(e.isRead?-1:1),i(),f(e.notificationsType==1?2:-1),i(),f(e.notificationsType==0?3:-1),i(),f(e.notificationsType==2?4:-1),i(),f(e.notificationsType==3?5:-1),i(),f(e.notificationsType==4?6:-1),i(),f(e.notificationsType==7?7:-1)}}function ee(t,o){if(t&1&&(r(0,"td",40),C(1,"mat-paginator",41),s()),t&2){let e=p();i(),v("length",e.notificationResource.totalCount)("pageSize",e.notificationResource.pageSize)("pageSizeOptions",k(3,Ft))}}function ie(t,o){t&1&&C(0,"tr",42)}function oe(t,o){t&1&&C(0,"tr",43)}function ne(t,o){t&1&&C(0,"tr",44)}function ae(t,o){t&1&&(r(0,"tr")(1,"td",45)(2,"div",46)(3,"b"),a(4),u(5,"translate"),s()()()()),t&2&&(i(4),l(" ",_(5,1,"NO_DATA_FOUND")))}function re(t,o){t&1&&(r(0,"div",28),C(1,"mat-progress-spinner",47),s())}var E=class t extends at{constructor(e,n,c,m,V,F){super();this.notificationService=e;this.toastrService=n;this.overlay=c;this.workflowInstanceService=m;this.dialog=V;this.documentService=F;this.notificationResource=new St,this.notificationResource.pageSize=10,this.notificationResource.orderBy="createdDate desc"}dataSource;notifications=[];displayedColumns=["action","createdDate","message"];isLoadingResults=!1;notificationResource;loading$;paginator;sort;input;footerToDisplayed=["footer"];ngOnInit(){this.dataSource=new N(this.notificationService),this.dataSource.loadNotifications(this.notificationResource),this.getResourceParameter()}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),this.sub$.sink=j(this.sort.sortChange,this.paginator.page).pipe(T(()=>{this.notificationResource.skip=this.paginator.pageIndex*this.paginator.pageSize,this.notificationResource.pageSize=this.paginator.pageSize,this.notificationResource.orderBy=this.sort.active+" "+this.sort.direction,this.dataSource.loadNotifications(this.notificationResource)})).subscribe(),this.sub$.sink=U(this.input.nativeElement,"keyup").pipe(B(1e3),P(),T(()=>{this.paginator.pageIndex=0,this.notificationResource.skip=0,this.notificationResource.name=this.input.nativeElement.value,this.dataSource.loadNotifications(this.notificationResource)})).subscribe()}getResourceParameter(){this.sub$.sink=this.dataSource.responseHeaderSubject$.subscribe(e=>{e&&(this.notificationResource.pageSize=e.pageSize,this.notificationResource.skip=e.skip,this.notificationResource.totalCount=e.totalCount)})}viewDocument(e){e.notificationsType===0?this.notificationService.checkReminderByDocumentId(e.documentId??"").subscribe(n=>{n.data?this.previewDocument(e):this.toastrService.error(this.translationService.getValue("YOU_ARE_NOT_AUTHORIZED_TO_VIEW_THIS_REMINDER"))}):e.notificationsType===1?this.notificationService.checkShareUserByDocumentId(e.documentId??"").subscribe(n=>{n.data?this.previewDocument(e):this.toastrService.error(this.translationService.getValue("YOU_ARE_NOT_AUTHORIZED_TO_VIEW_THIS_DOCUMENT"))}):e.notificationsType===2&&this.previewDocument(e)}previewDocument(e){return x(this,null,function*(){this.documentService.getDocument(e.documentId??"").subscribe(n=>x(this,null,function*(){this.isLoadingResults=!0;try{let m=(n.url?.split(".")??[])[1],V={documentId:n.id,name:n.name,url:n.url,extension:m,isVersion:!1,isFromPublicPreview:!1,isPreviewDownloadEnabled:!1,isFileRequestDocument:!1,isSignatureExists:n.isSignatureExists,documentNumber:n.documentNumber},{BasePreviewComponent:F}=yield import("./chunk-JJBHCVNV.js");this.overlay.open(F,{position:"center",origin:"global",panelClass:["file-preview-overlay-container","white-background"],data:V})}finally{this.isLoadingResults=!1}}))})}viewVisualWorkflow(e){this.workflowInstanceService.getvisualWorkflowInstance(e.workflowInstanceId??"").subscribe({next:n=>x(this,null,function*(){this.isLoadingResults=!0;try{let{VisualWorkflowGraphComponent:c}=yield import("./chunk-C47LTG55.js"),m=this.dialog.open(c,{width:"100%",maxWidth:"70vw",data:Object.assign({},n)})}finally{this.isLoadingResults=!1}}),error:n=>{}})}static \u0275fac=function(n){return new(n||t)(S(rt),S(ct),S(dt),S(Ht),S(Z),S(st))};static \u0275cmp=W({type:t,selectors:[["app-notification-list"]],viewQuery:function(n,c){if(n&1&&(w(H,5),w(A,5),w(At,5)),n&2){let m;D(m=I())&&(c.paginator=m.first),D(m=I())&&(c.sort=m.first),D(m=I())&&(c.input=m.first)}},features:[z],decls:35,vars:18,consts:[["input",""],[1,"content"],[1,"container-fluid"],[1,"d-flex","mb-2"],[1,"me-auto"],[1,"mb-0","page-title"],[3,"code"],["appearance","outlined"],[1,"col-md-4"],[1,"form-control",3,"placeholder"],[1,"table-responsive","mt-2"],[1,"grid-height-medium"],["mat-table","","matSort","","matSortActive","createdDate","matSortDirection","desc",1,"w-100",3,"dataSource"],["matColumnDef","action"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","createdDate"],["class","table-column-200","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","table-column-200","mat-cell","",4,"matCellDef"],["matColumnDef","message"],["class","table-column-500","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","table-column-500","mat-cell","",4,"matCellDef"],["matColumnDef","footer"],["mat-footer-cell","","colspan","4",4,"matFooterCellDef"],["class","grid-header-color","mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef","matFooterRowDefSticky"],[4,"matNoDataRow"],[1,"spinner-container"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["matMiniFab","","type","button",1,"error"],["matMiniFab","","type","button",1,"success",3,"click"],[1,"medium-icon","fs-5","align-middle"],["matMiniFab","","type","button",1,"error",3,"click"],["mat-header-cell","","mat-sort-header","",1,"table-column-200"],["mat-cell","",1,"table-column-200"],["mat-header-cell","","mat-sort-header","",1,"table-column-500"],["mat-cell","",1,"table-column-500"],[1,"badge","bg-success"],["mat-footer-cell","","colspan","4"],[3,"length","pageSize","pageSizeOptions"],["mat-header-row","",1,"grid-header-color"],["mat-row",""],["mat-footer-row",""],["colspan","4"],[1,"m-2"],["mode","indeterminate","diameter","60","strokeWidth","5"]],template:function(n,c){n&1&&(r(0,"section",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"span",5),a(5),u(6,"translate"),C(7,"app-page-help-text",6),s()()(),r(8,"mat-card",7)(9,"mat-card-header")(10,"div",8),C(11,"input",9,0),u(13,"translate"),s()(),r(14,"mat-card-content")(15,"div",10)(16,"div",11)(17,"table",12),b(18,13),h(19,Ut,3,3,"th",14)(20,Pt,3,2,"td",15),g(),b(21,16),h(22,$t,3,3,"th",17)(23,Wt,3,4,"td",18),g(),b(24,19),h(25,zt,3,3,"th",20)(26,te,8,7,"td",21),g(),b(27,22),h(28,ee,2,4,"td",23),g(),h(29,ie,1,0,"tr",24)(30,oe,1,0,"tr",25)(31,ne,1,0,"tr",26)(32,ae,6,3,"tr",27),s()()()()()()(),d(33,re,2,0,"div",28),u(34,"async")),n&2&&(i(5),l("",_(6,11,"NOTIFICATIONS")," "),i(2),v("code","NOTIFICATIONS"),i(4),v("placeholder",q(_(13,13,"SEARCH_BY_DOCUMENT_NAME_OR_MESSAGE"))),i(6),v("dataSource",c.dataSource),i(12),v("matHeaderRowDef",c.displayedColumns)("matHeaderRowDefSticky",!0),i(),v("matRowDefColumns",c.displayedColumns),i(),v("matFooterRowDef",k(17,Vt))("matFooterRowDefSticky",!0),i(2),f(_(34,15,c.dataSource.loading$)||c.isLoadingResults?33:-1))},dependencies:[Ct,H,A,kt,ht,gt,Nt,Rt,bt,Tt,xt,Et,wt,It,Dt,Mt,Ot,yt,Lt,ot,vt,ft,ut,_t,et,tt,X,J,mt,lt,it,nt,K],encapsulation:2})};var Je=[{path:"",component:E,canActivate:[pt]}];export{Je as NOTIFICATION_ROUTES};
