<mat-dialog-content>
  <div class="d-flex">
    <div class="me-auto p-2">
      <span class="mb-3 page-title">
        {{ "SEND_EMAIL" | translate }}
        <app-page-help-text [code]="'SEND_EMAIL'"></app-page-help-text>
      </span>
    </div>
    <div class="d-flex justify-content-end mb-2">
      <mat-icon class="close-icon text-danger cursor-pointer" (click)="closeDialog()">cancel</mat-icon>
    </div>
  </div>
  <form [formGroup]="emailForm">
    @if(!smtpConfigured) {
    <div class="alert alert-warning mt-2">
      {{ "PLEASE_CONFIGURE_EMAIL_SMTP_SETTINGS" | translate }}
    </div>
    }
    <div class="row">
      <div class="col-12 col-md-6 pb-1">
        <div class="input-group flex-column flex-md-row">
          <label class="input-group-text font-weight-bold form-label">
            {{ "TO" | translate }}
          </label>
          <input formControlName="toAddress" type="text" class="form-control" placeholder="{{ 'EMAIL' | translate }}"
            [attr.aria-label]="'To'" />
        </div>
        @if(emailForm.get('toAddress')?.touched &&
        emailForm.get('toAddress')?.errors &&
        emailForm.get('toAddress')?.errors?.['required']) {
        <div class="text-danger">
          {{ "TO_ADDRESS_IS_REQUIRED" | translate }}
        </div>
        } @if(emailForm.get('toAddress')?.touched &&
        emailForm.get('toAddress')?.errors &&
        emailForm.get('toAddress')?.errors?.['email']) {
        <div class="text-danger">
          {{ "EMAIL_IS_NOT_PROPER_FORMAT" | translate }}
        </div>
        }
      </div>
      <div class="col-12 col-md-6 pb-1">
        <div class="input-group flex-column flex-md-row">
          <label class="input-group-text font-weight-bold form-label">
            {{ "SUBJECT" | translate }}
          </label>
          <input formControlName="subject" type="text" class="form-control" placeholder="{{ 'SUBJECT' | translate }}"
            [attr.aria-label]="'Subject'" />
        </div>
        @if(emailForm.get('subject')?.touched &&
        emailForm.get('subject')?.errors &&
        emailForm.get('subject')?.errors?.['required']) {
        <div class="text-danger">
          {{ "SUBJECT_IS_REQUIRED" | translate }}
        </div>

        }
      </div>
      <div class="col-md-12">
        <div class="form-group">
          <label class="font-weight-bold form-label">
            {{ "BODY" | translate }}
          </label>
          <div class="NgxEditor__Wrapper">
            <app-text-editor formControlName="body"></app-text-editor>
          </div>
          @if(emailForm.get('body')?.touched &&
          emailForm.get('body')?.errors &&
          emailForm.get('body')?.errors?.['required']) {
          <div class="text-danger">
            {{ "BODY_IS_REQUIRED" | translate }}
          </div>
          }
        </div>
      </div>
      <div class="col-md-12 pb-1">
        <div class="input-group mt-3 flex-column flex-md-row">
          <div class="input-group-prepend w-100 w-md-auto">
            <span class="input-group-text text-truncate w-100">
              {{ "ATTACHMENT_DOCUMENT" | translate }} :: {{ data.name }}
            </span>
          </div>
        </div>
      </div>

      <div class="col-md-12 mt-2">
        <button (click)="sendEmail()" type="submit" class="success" matButton="filled">
          <mat-icon class="medium-icon fs-6 d-flex align-items-center justify-content-center">send</mat-icon>
          {{ "SEND" | translate }}
        </button>
      </div>
    </div>
  </form>
  @if(isLoading) {
  <div class="spinner-container">
    <mat-progress-spinner mode="indeterminate" diameter="60" strokeWidth="5">
    </mat-progress-spinner>
  </div>
  }
</mat-dialog-content>
